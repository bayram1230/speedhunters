var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Word=function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=78)}([function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t[t.O=0]="msoulscat_ES_EWAJS",t[t._=1]="msoulscat_ES_EWAJSGrid",t[t.A=6]="msoulscat_ES_EWAJSChart",t[t.P=202]="msoulscat_MSOSP_FileMenuCommands",t[t.U=220]="msoulscat_MSOSP_AddInCommands",t[t.R=225]="msoulscat_MSOSP_OTelJS",t[t.F=227]="msoulscat_MSOSP_OTelJSInWebWoker",t[t.N=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",t[t.H=301]="msoulscat_Wac_WordViewer",t[t.B=306]="msoulscat_Wac_BrowserGeneral",t[t.J=320]="msoulscat_Wac_TaskPane",t[t.$=339]="msoulscat_Wac_OneNoteGeneral",t[t.K=340]="msoulscat_Wac_Ribbon",t[t.Z=356]="msoulscat_Wac_WacFeedback",t[t.X=379]="msoulscat_Wac_WopiPendingApplication",t[t.Y=383]="msoulscat_Wac_Telemetry",t[t.tt=391]="msoulscat_Wac_WacCatchUpActivities",t[t.et=394]="msoulscat_Wac_Dictation",t[t.it=395]="msoulscat_Wac_OneNoteSync",t[t.st=700]="msoulscat_Wac_VisioApp",t[t.ot=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.nt=800]="msoulscat_Wac_PptAnimation",t[t.rt=833]="msoulscat_Wac_PptLive",t[t.ct=834]="msoulscat_Wac_PptMWeb",t[t.ht=835]="msoulscat_Wac_PptGc2General",t[t.dt=836]="msoulscat_Wac_PptGc2GraphicHost",t[t.ut=837]="msoulscat_Wac_PptGc2Operation",t[t.lt=852]="msoulscat_Wac_PptGc2EditCanvas",t[t.ft=844]="msoulscat_Wac_PptDataSync",t[t.pt=848]="msoulscat_Wac_PptFluidRuntime",t[t.bt=815]="msoulscat_Wac_PptShape",t[t.wt=817]="msoulscat_Wac_PptSession",t[t.Ot=830]="msoulscat_Wac_PptSlideshow",t[t.gt=822]="msoulscat_Wac_PptView",t[t.vt=846]="msoulscat_Wac_PptVideos",t[t.jt=1303]="msoulscat_Uci_Insights",t[t.St=2300]="msoulscat_Wac_VersionHistory",t[t.It=302]="msoulscat_Wac_WordPresence",t[t._t=3e3]="msoulscat_Wac_OAuth",t[t.Ct=3005]="msoulscat_Wac_WordVersionHistory",t[t.Tt=3006]="msoulscat_Wac_LivePersonaCard",t[t.yt=3012]="msoulscat_Wac_CatchUpFlyout",t[t.At=3016]="msoulscat_Wac_WordDesigner",t[t.Et=3021]="msoulscat_Wac_ModernFontPicker",t[t.Pt=3027]="msoulscat_Wac_UnifiedUiHost",t[t.Ut=3033]="msoulscat_Wac_EquationTools",t[t.Rt=1401]="msoulscat_Osf_Latency",t[t.Wt=1402]="msoulscat_Osf_Notification",t[t.Ft=1403]="msoulscat_Osf_Runtime",t[t.Mt=3041]="msoulscat_Wac_AiMaker",t[t.kt=3043]="msoulscat_Wac_AiRewrite",t[t.Nt=3044]="msoulscat_Wac_AiInsert",t[t.xt=3047]="msoulscat_Wac_AiSummarize",t[t.Ht=3048]="msoulscat_Wac_CopilotCompose",t[t.Dt=3049]="msoulscat_Wac_Skittles",t[t.Vt=3050]="msoulscat_Wac_CopilotChat",t[t.Bt=3051]="msoulscat_Wac_Syntex",t[t.Lt=3052]="msoulscat_Wac_WireGraph",t[t.Jt=3053]="msoulscat_Wac_CshCopilot",t[t.$t=3055]="msoulscat_Wac_CopilotProactiveSummary",t[t.Gt=3056]="msoulscat_Wac_CopilotProactiveShared",t[t.zt=3057]="msoulscat_Wac_CopilotCursor",t[t.qt=3059]="msoulscat_Wac_WasmGeneral",t[t.Kt=3060]="msoulscat_Wac_WasmTextLayout",t[t.Zt=3061]="msoulscat_Wac_WasmSmartArt",t[t.Xt=3062]="msoulscat_Wac_WasmClient",t[t.Qt=3063]="msoulscat_Wac_WasmNative",t[t.Yt=3068]="msoulscat_Wac_UniversalPrint",t[t.te=4e3]="msoulscat_AIHub_CreateModuleTelemetry",t[t.ee=4001]="msoulscat_AIHub_CreateModuleAugloop",t[t.ie=4002]="msoulscat_AIHub_CreateModuleDAS",t[t.se=4003]="msoulscat_AIHub_CreateModuleConfig",t[t.oe=4004]="msoulscat_AIHub_CreateModuleContext",t[t.ne=4005]="msoulscat_AIHub_CreateModuleGraph",t[t.re=4006]="msoulscat_AIHub_CreateModuleExperiences",t[t.ce=4007]="msoulscat_AIHub_CreateModuleHttp",t[t.he=4008]="msoulscat_AIHub_CreateModuleRouting",t[t.de=4009]="msoulscat_AIHub_CreateModuleStorage",t[t.ue=4010]="msoulscat_AIHub_CreateModuleStore",t[t.le=4011]="msoulscat_AIHub_CreateModuleUI",t[t.fe=4012]="msoulscat_AIHub_CreateModuleSharePoint",t[t.pe=4013]="msoulscat_AIHub_CreateModuleLicensing",t[t.me=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",t[t.be=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",t[t.we=4102]="msoulscat_AIHub_CreateModuleUI_Forms",t[t.Oe=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",t[t.ge=4104]="msoulscat_AIHub_CreateModuleUI_Text",t[t.ve=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(s||(s={}))},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Important=20]="Important",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"k",(function(){return r})),i.d(e,"h",(function(){return c})),i.d(e,"i",(function(){return a})),i.d(e,"j",(function(){return d})),i.d(e,"l",(function(){return u})),i.d(e,"m",(function(){return l})),i.d(e,"d",(function(){return p})),i.d(e,"e",(function(){return m})),i.d(e,"f",(function(){return b})),i.d(e,"g",(function(){return w})),i.d(e,"a",(function(){return O})),i.d(e,"b",(function(){return g})),i.d(e,"c",(function(){return v}));var s=i(5),o=i(14),n=i(8);const r="word-edit",c="/we/",a="wordeditorframe.aspx",h=c+a,d="wordeditorstartsession.ashx",u="/wv/",l="wordviewerframe.aspx",f=u+l;function p(t,e=!1){return e?t.indexOf(r)>-1||t.toLowerCase().indexOf(a)>0:t.toLowerCase().indexOf(h)>0}function m(t){return t.toLowerCase().indexOf(l)>0}function b(t,e=!1){let i=t;return i=i.replace(new RegExp(r,"i"),"word-view"),i=i.replace(new RegExp(h,"i"),f),e&&(i=Object(s.b)(i,"WordEditorFailedToLoad","1")),i}function w(t){let e=t;return e=e.replace(new RegExp("word-view","i"),r),e=e.replace(new RegExp(f,"i"),h),e}function O(t){var e;if(!t)return{AppMode:"Unknown",AppModeExtended:"Unknown"};const i=t.appUrl,n=t.je.getValue(o.a.Se,!1);let c=!1;c=n?p(t.appUrl,n):t.appBaseUrl.indexOf(r)>-1;const a=t.appContext.isUnifiedRead,h=t.appContext.isMobileView,d=null!==(e=t.bootParams)&&void 0!==e&&e.isNewFile?t.bootParams.isNewFile:Object(s.p)(i,"new"),u=Object(s.p)(t.appUrl,"embed"),l=!!t.wdParams&&"1"===t.wdParams.wdnc;return c?d?{AppMode:"Edit",AppModeExtended:"EDIT_NEW"}:h?{AppMode:"Unified",AppModeExtended:"MOBILE_VIEW"}:a?{AppMode:"Unified",AppModeExtended:"COLLAB_VIEW"}:{AppMode:"Unified",AppModeExtended:"UNIFIED_EDIT"}:u?{AppMode:"View",AppModeExtended:"EMBED_VIEW"}:l?{AppMode:"View",AppModeExtended:"CHROMELESS_VIEW"}:{AppMode:"View",AppModeExtended:"VIEW"}}function g(t){return t?t.indexOf("iPhone")>=0||t.indexOf("iPad")>=0?"iOS":t.indexOf("Mac OS X")>=0?"Mac OS X":t.indexOf("Android")>=0?"Android":t.indexOf("Ubuntu")>=0?"Ubuntu":t.indexOf("CrOS")>=0?"Chrome OS":t.indexOf("Fedora")>=0?"Fedora":t.indexOf("Windows")>=0?"Windows":t.indexOf("Linux")>=0?"Linux":"Unknown":"Unknown"}function v(t,e){var i;if(void 0!==t){if("1"===t)return!0;if("0"===t)return!1}let s;return!("undefined"==typeof window||null===(i=window.navigator)||void 0===i||!i.userAgent)&&(s=window.navigator.userAgent.toLowerCase(),!(!e||!e.toLowerCase().includes("outlookmobileios")||!s.includes("ipad")&&!s.includes("macintosh"))||!(s.indexOf("ipad")>=0)&&(s.indexOf("silk")>=0||(s.includes("android")&&!s.includes("iemobile")?!(s.includes("chrome")&&!s.includes("mobile")):Object(n.f)())))}},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.BrowserEvent="BrowserEvent",t.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",t.PageChanged="PageChanged",t.ZoomChanged="ZoomChanged",t.ContentRefreshBegin="ContentRefreshBegin",t.ContentRefreshEnd="ContentRefreshEnd",t.AppClosed="UI_Close",t.UserEdit="Edit_Notification",t.FileRename="File_Rename",t.FileShare="UI_Sharing",t.ShowFileVersions="UI_FileVersions",t.UIWorkflow="UI_Workflow",t.IsDisabled="IsDisabled",t.AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.Unloaded="Unloaded",t.Disposed="Disposed",t.SwitchMode="App_SwitchMode",t.DocumentReboot="DocReboot",t.WopiInfoFromUrl="WopiInfoFromUrl",t.DavUrlFromIds="DavUrlFromIds",t.ModeSwitched="ModeSwitched",t.CreateNewDocument="App_CreateNewDocument",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.SetOverlayContent="SetOverlayContent",t.MoveToFolder="MoveToFolder",t.SharedFilePicker="SharedFilePicker"}(s||(s={}))},,function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"u",(function(){return n})),i.d(e,"t",(function(){return r})),i.d(e,"n",(function(){return c})),i.d(e,"o",(function(){return a})),i.d(e,"m",(function(){return h})),i.d(e,"v",(function(){return d})),i.d(e,"i",(function(){return u})),i.d(e,"h",(function(){return l})),i.d(e,"f",(function(){return f})),i.d(e,"e",(function(){return p})),i.d(e,"a",(function(){return m})),i.d(e,"r",(function(){return b})),i.d(e,"d",(function(){return w})),i.d(e,"k",(function(){return O})),i.d(e,"b",(function(){return g})),i.d(e,"s",(function(){return v})),i.d(e,"x",(function(){return j})),i.d(e,"j",(function(){return S})),i.d(e,"w",(function(){return I})),i.d(e,"p",(function(){return _})),i.d(e,"l",(function(){return C})),i.d(e,"g",(function(){return T})),i.d(e,"q",(function(){return y}));const s=["eurppc"],o="AppSettingsHandler.ashx",n="RemoteUls.ashx",r="RemoteTelemetry.ashx";function c(t){return 8===t.toLowerCase().indexOf("ffc")}function a(t){return 8===t.toLowerCase().indexOf("ppc")}function h(t){const e=t.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return e&&e[1]?e[1]:"public"}function d(t,e){if(!e||-1===s.indexOf(e.toLowerCase()))return t;const i=t.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?`${i[1]}${e}-${i[3]}`:t}function u(t){const e=t.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!e)throw new Error("Invalid URL");return e[1]}function l(t,e){const i=t.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");const s=i[2];if(void 0===e)return s;if(e<0)throw new Error("subDomainParts should be at least 1");return s.split(".").slice(-(e+1)).join(".")}function f(t){return t+n}function p(t,e){return t+r+(e?"?usid="+e:"")}function m(t,e,i){i&&(t[e.toLowerCase()]=i)}function b(t,e){t[e.toLowerCase()]=""}function w(t,e,i){const s=[];for(const t in i)i[t]&&s.push(t+"="+i[t]);return t+e+(s.length>0?"?"+s.join("&"):"")}function O(t,e){const i=t.toLowerCase(),s=e.toLowerCase();let o=i.indexOf("&"+s+"=");if(-1===o&&(o=i.indexOf("?"+s+"=")),-1===o)return"";const n=o+(e.length+2),r=t.indexOf("&",n);return t.substring(n,-1===r?void 0:r)}function g(t,e,i,s){if(!i)return t;let o=t;const n=o.indexOf("?");let r="&";n===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?r="":-1===n&&(r="?");const c=e.toLowerCase()+"=",a=new RegExp("\\W"+c,"i").exec(o);if("?"!==r&&a){if(s){const t=a.index+1,e=o.indexOf("&",t);o=o.substring(0,t)+c+i+(-1===e?"":o.substring(e))}return o}return o.concat(r,c,i)}function v(t){const e={},i=t.indexOf("?");return-1===i||i===t.length-1||t.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach(t=>{if(t){const i=t.indexOf("=");-1!==i&&i!==t.length-1&&(e[t.substring(0,i).toLowerCase()]=t.substring(i+1))}}),e}function j(t,e){if(!t)return t;let i=t;const s=i.indexOf("?"),o=e.toLowerCase()+"=",n=i.toLowerCase().indexOf(o,s);if(n>=0){const t=i.indexOf("&",n);return i=i.substring(0,n)+(-1===t?"":i.substring(t+1)),"&"===i.slice(-1)&&(i=i.slice(0,-1)),i}return t}function S(t){if(!t)return"";const e=-1===t.indexOf("#")?t.length:t.indexOf("#");let i=t.lastIndexOf("/",e);if(-1!==i&&i+1===t.indexOf("://")+"://".length)return"";i+=1;let s=t.indexOf("?");if(s=s>=e?-1:s,-1!==s&&i>s)return"";const o=-1===s?e:s;return i>=o?"":t.substring(i,o)}function I(t){const e=new RegExp("(c[1-5])h?(-)");return t.replace(e,"$1h$2")}function _(t,e,i){const s=new RegExp("[?&]"+e+"=("+(i||"1")+")\\b","i"),o=t.match(s);return!(!o||i&&o[1]!==i)}function C(t,e){const i=O(t,e);return i?decodeURI(i):i}function T(t){return t?t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0]:""}function y(t,e){return!!t&&t.includes(e)}},,function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.Ie="App_AccessibilityLoopComplete",t._e="Wac_ActionComplete",t.Ce="WacInitialize_Ready",t.Te="Wac_AppFailed",t.ye="Wac_AppBootState",t.Ae="Wac_AppCompleted",t.Ee="BrowserEvent",t.Pe="UI_Close",t.Ue="App_CloseTab",t.Re="UI_Conversation",t.We="UI_CopyAndEdit",t.Fe="App_CreateNewDocument",t.Me="Wac_AppDataSavedStatus",t.ke="UI_Download",t.Ne="UI_Edit",t.xe="Error",t.He="UI_FileEmbed",t.De="UI_FileProperties",t.Ve="File_Rename",t.Be="File_RenameFailed",t.Le="UI_FileVersions",t.Je="StateChanged",t.$e="App_IsFrameTrusted",t.Ge="GetAccessToken",t.ze="App_GetAuthToken",t.qe="App_GetCustomAuthConfig",t.Ke="App_GetHostKeyValue",t.Ze="App_WopiInfoFromUrl",t.Xe="App_DavUrlFromIds",t.Qe="App_LoadingStatus",t.Ye="App_SwitchMode",t.ti="App_MoveToFolder",t.ei="UI_OpenInMobileApp",t.ii="UI_OpenInBrowser",t.si="UI_OpenInClient",t.oi="PageChanged",t.ni="App_PushCommentContext",t.ri="App_PushState",t.ci="App_DocReboot",t.hi="UI_RedeemForCommenting",t.di="App_RefreshSessionInfo",t.li="UI_ReplyWithChanges",t.fi="UI_ReportAbuse",t.pi="App_FilePicker",t.mi="UI_SaveStatus",t.bi="WopiSession_Complete_Ack",t.wi="SetOverlayContent",t.Oi="UI_Sharing",t.gi="UI_ShareForm",t.vi="UI_SignIn",t.ji="App_StoreHostKeyValue",t.Si="App_Unloaded",t.Ii="App_UlsLog",t._i="Wac_UnloadingApp",t.Ci="App_UpdateBootComplete",t.Ti="PageCount",t.yi="UI_CheckUserAccessAndGrantPermissions",t.Ai="User_Activity",t.Ei="Edit_Notification",t.Pi="UI_Workflow",t.Ui="ZoomChanged",t.Ri="CAAEMessage",t.Wi="Excel_HostFrameCacheSave",t.Fi="Excel_HostFrameCacheEvict",t.Mi="Excel_RegenerateFileBundle",t.ki="App_SwitchToWacFrame",t.Ni="App_SaveSSRData",t.xi="App_PurgeDataInHostCache",t.Hi="App_SaveHostRenderingV2Data",t.Di="App_SaveHostUtilsData",t.Vi="AcquireOAuthTokenTeams",t.Bi="App_SwitchNotebook",t.Li="FailedBoot_CheckFileInfo",t.Ji="GetTeamsUsers",t.$i="SendTeamsUserMention",t.Gi="NavigateBackToHost",t.zi="App_GetClientUrlComplete",t.qi="App_GetWebUrlComplete",t.Ki="App_CopyLinkComplete",t.Zi="App_SendConversationId",t.Xi="CloseTeamsConversation",t.Qi="PageLoaded",t.Yi="Visio_BRS",t.ts="Visio_SendLicenseInfo",t.es="Visio_Consumption_CLTComplete",t.ss="Visio_SwitchMode_FromViewFrame",t.os="Visio_ModeSwitch_ToHost_Ack",t.ns="Visio_UpdateEditUrl",t.cs="Visio_PageViewLoaded",t.as="Visio_ActiveAppFrameLoadFailed",t.hs="Visio_DisposeBkgFrame",t.ds="Visio_ReadyToReceiveDocData",t.us="Visio_DocReboot_HostNav",t.ls="Visio_SwitchToVisioFrame",t.fs="WacAppPerfMetric",t.ps="App_ModifyURLState",t.ms="App_WacTokenAck",t.bs="App_InitEnd",t.ws="App_SplashScreenShown",t.Os="App_SetWacFlightValue",t.gs="App_PrintRedirect",t.vs="App_RequestFullScreen",t.js="App_ShowCopilotBottomBar",t.Ss="UI_ExternalDocumentShare"}(s||(s={}))},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return r})),i.d(e,"h",(function(){return c})),i.d(e,"d",(function(){return a})),i.d(e,"g",(function(){return h})),i.d(e,"e",(function(){return d})),i.d(e,"i",(function(){return u})),i.d(e,"f",(function(){return f})),i.d(e,"k",(function(){return p})),i.d(e,"b",(function(){return m})),i.d(e,"j",(function(){return b})),function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.TeamsElectron=6]="TeamsElectron",t[t.AndroidWebView=7]="AndroidWebView",t[t.Unknown=8]="Unknown"}(s||(s={}));const o=window.navigator,n=o?o.userAgent:void 0;function r(){if(n){if(n.indexOf("Firefox")>-1)return s.Firefox;if(n.indexOf("Opera")>-1||n.indexOf("OPR")>-1)return s.Opera;if(n.indexOf("Trident")>-1)return s.IE;if(n.indexOf("Electron")>-1&&n.indexOf("Teams")>-1)return s.TeamsElectron;if(n.indexOf("Android")>-1&&n.indexOf("wv")>-1)return s.AndroidWebView;if(n.indexOf("Edg")>-1)return s.Edge;if(n.indexOf("Chrome")>-1)return s.Chrome;if(n.indexOf("Safari")>-1)return s.Safari}return s.Unknown}function c(){try{return!!n&&n.indexOf("iPad")>=0||!!n&&n.indexOf("Macintosh")>=0&&w()&&!l()||!!n&&n.indexOf("Android")>=0||w()}catch{return!1}}function a(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}function h(){return r()===s.IE&&!(r()===s.IE&&null!=document.documentMode&&void 0!==document.documentMode&&document.documentMode>=11)}function d(){return r()===s.IE}function u(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(t){return!1}}function l(){return!!n&&n.indexOf("iPhone")>=0}function f(){return l()||/android.+mobile/i.test(o.userAgent)}function p(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch{return!1}}function m(){try{return window.matchMedia("(forced-colors: active)").matches||window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}function b(){try{return window.matchMedia("(prefers-contrast: more)").matches}catch{return!1}}function w(){return!!o&&o.maxTouchPoints>0}},function(t,e,i){"use strict";function s(t){if(t){const e=t.lastIndexOf(".");if(-1!==e)return t.substring(e+1).toLowerCase()}return""}function o(t){if(!t)return"";const e=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(Object.getPrototypeOf(t));return JSON.stringify(t,[...e,...i])}i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o}))},,,function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.AppInitError="AppInitError",t.ApiDisabledError="ApiDisabledError",t.CannotLoadFirstPage="CannotLoadFirstPage",t.InvalidWopiInfo="InvalidWopiInfo",t.TimeoutWacReady="TimeoutWacReady",t.WacFailed="WacFailed"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return d})),i.d(e,"d",(function(){return l})),i.d(e,"c",(function(){return f})),i.d(e,"b",(function(){return p}));var s=i(5),o=i(40),n=i(41),r=i(18),c=i(42),a=i(43),h=i(26);const d="Word";function u(t,e){const i=e?"?usid="+e:"";return t+s.t+i}function l(t,e){return u(p(t),e)}function f(t,e,i,l,f,m=!1){t.SessionInformation.IsCore&&(t.SessionInformation.HideViewerToolbar=!0),function(t,e){const i=t.SessionInformation;if(i.WdParams||(i.WdParams={}),i.WdParams.wd)return;e.substring(1).split("&").filter(t=>{if(0===t.indexOf("wd")){const e=t.split("=");e[0].length>2&&(i.WdParams[e[0]]=e[1])}});const s=t.RebootOverrideData;s&&s.previousSessionId&&(i.WdParams.wdprevioussession=s.previousSessionId),h.a.Instance.getBooleanSetting("OneNoteHostSessionOriginFixEnabled")}(t,window.location.search);const b=f||new o.a(d,i),w=p(t.ApplicationUrl);return{container:t.Container,sessionInformation:t.SessionInformation,applicationUrl:t.ApplicationUrl,wopiPrecheckInfo:t.WopiPrecheckInfo,applicationCustomSettings:t.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:t.Diagnostics,ClientDiagnostics:Object(n.c)(),AppInitDiagnostics:{officeSessionId:e,officeBootstrapperVersion:Object(r.a)(),hostName:t.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:t.FnOnInitializeSuccess,fnOnInitializeFailure:t.FnOnInitializeFailure,sessionId:e,applicationBasePath:w,remoteTelemetryUrl:u(w,e),wopiInfo:t.WopiInfo,forceSingleStepBoot:m,isCreateNew:t.WopiPrecheckInfo.IsNewFile||Object(s.p)(t.ApplicationUrl,"new"),featureManager:l||Object(c.a)(t.FnIsFeatureEnabled,i),je:b,newFileTemplateSource:t.NewFileTemplateSource,rebootOverrideData:t.RebootOverrideData,pageStateObserver:new a.a(i,!0),canSupportInteractiveReadOnly:!1}}function p(t){const e=t.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!e)throw new Error("Invalid URL");return e[1]}},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.Is="BootstrapperMaxUlsHeartbeatTime",t._s="BootstrapperNoCompleteWarning1Time",t.Cs="BootstrapperNoCompleteWarning2Time",t.Ts="BootstrapperNoCompleteWarning3Time",t.ys="RemoteUlsETag",t.As="RemoteUlsSuppressions",t.Es="BootstrapperSettingsFetchPeriod",t.Ps="timestamp",t.Us="BootstrapperUlsHeartbeatIntervalMs",t.Rs="BootstrapperUlsHeartBeatIsEnabled",t.Ws="BootstrapperUlsUploadCadenceMs",t.Fs="RequestedCallThrottlingDefaultToViewMinimumValue",t.Ms="BulsEndpointUrl",t.ks="EnableCommonHostDiagnosticsParams",t.Ns="EnableICNForWord",t.xs="EnableModernEmbedViewForPowerPoint",t.Hs="EnableModernEmbedViewInOneUpForPowerPoint",t.Ds="EnableModernEmbedViewForPowerPointGlobalAppUrl",t.Vs="EnableModernReadingViewForPowerPoint",t.Bs="EnableModernViewForPowerPointIPad",t.Ls="EnableEarlyFormSubmitMWeb",t.Js="EnablePassingCustomFontCatalogToViewer",t.$s="EnableDefaultToModernForPowerPoint",t.Gs="ShouldLogJsApiKpisForWord",t.zs="WordSwitchToViewInTeamsJsapiV1Enabled",t.qs="EnableWordSessionRefreshTelemetry",t.Ks="PowerPointUseEssDCHint",t.Zs="PowerPointEnableControl24DCsExcludeFromESS",t.Xs="PowerPointListOfControl24DCsExcludedFromESS",t.Qs="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",t.Ys="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",t.eo="ModernEmbedViewForPowerPointEnabledPercentage",t.io="PowerPointESSCookieLookbackThresholdHour",t.so="PowerPointSetESSCookieLookbackExpEnabled",t.oo="ExcelForceViewOnlyInTeamsJsapiV1",t.no="EnableWordSessionRefreshLoggingCleanup",t.ro="WordRefreshTelemetryExpirationInDays",t.Se="IsSpoSandboxFixEnabled",t.co="WordConsumptionViewToEditRedirectIsEnabled",t.ao="WordMobileToUnifiedReadRedirectIsEnabled",t.ho="WordEditorBizchatSideBySideUnifiedReadIsEnabled",t.do="IPadPreviewerExpEnabled"}(s||(s={}))},function(t,e,i){"use strict";function s(){return window.performance.now()}function o(){return Math.round(window.performance.now()+window.performance.timeOrigin)}i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return o}))},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.uo="Ack",t.lo="WacInitialize_Ready_Ack",t.fo="Wac_BeforeUnloadApp",t.po="Blur_Focus",t.mo="Wac_AppFailed_Ack",t.bo="Wac_AppCompleted_Ack",t.wo="WopiStartSession_Complete",t.Oo="WopiPendingSession_Complete",t.vo="Host_AccessibilityLoopComplete",t.$e="Host_IsFrameTrusted",t.jo="Grab_Focus",t.So="HostCacheDiagnostic",t.Io="Host_KeyValue",t._o="JsApiDiagnostics",t.ti="Host_MoveToFolder",t.Co="PageChanged_Ack",t.To="App_PopState",t.yo="Host_SendChannelId",t.Ao="Host_SendConversationId",t.Eo="GetTeamsUsers_Reply",t.Po="SendTeamsUserMention_Reply",t.Uo="Host_BackButtonPressed",t.Ro="Host_GetClientUrl",t.Wo="Host_GetWebUrl",t.Fo="File_Rename",t.pi="Host_FilePicker",t.Mo="PostAccessToken",t.ko="Host_SetAuthToken",t.No="Host_SetCustomAuthConfig",t.xo="App_PushCommentContext",t.Ho="CanEmbed",t.Do="Host_RefreshSessionInfo",t.Vo="CheckUserAccessAndGrantPermissions_Result",t.Bo="Host_WopiInfoFromUrl",t.Lo="Host_DavUrlFromIds",t.Jo="SetCurrentPage",t.$o="SetZoomLevel",t.Go="WopiPendingSession_Fail",t.zo="SetOverlayContent",t.qo="WopiPendingApplicationComplete_Received",t.Ko="Host_SwitchMode",t.Zo="Host_Unload",t.Xo="PageCount_Ack",t.Qo="ZoomChanged_Ack",t.Yo="Host_ShareUI",t.tn="Host_Telemetry",t.en="Visio_ConsumptionCLTComplete_Ack",t.in="Visio_SwitchMode_FromHF_Ack",t.sn="Visio_SwitchMode_FromHostFrame",t.on="Visio_FallbackToLegacySwitch",t.nn="Visio_DocumentData",t.rn="Host_PostWacToken"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return n})),i.d(e,"d",(function(){return r}));const s=365;function o(t,e){const i=n(t);return"true"===i||"false"!==i&&e}function n(t){if(!t)return"";const e=""+document.cookie,i=new RegExp("(?:^|; )"+t+"=([^;]*)"),s=e.match(i);return!s||s.length<2?"":s[1]}function r(t,e,i,o=c.none,n){const a=t+"="+e;let h="";const d=new Date;d.setTime(d.getTime()+864e5*s);let u=new Date;u.setTime(u.getTime()+864e5*i),u>d&&(u=d),u&&(h=";expires="+u.toUTCString());const l=a+h+";SameSite="+c[o];return document.cookie=n?l+"; Secure":l,!(!document.cookie||-1===document.cookie.indexOf(a))||o===c.none&&r(t,e,i,c.doNotSet,n)}var c;!function(t){t[t.doNotSet=0]="doNotSet",t[t.none=1]="none",t[t.lax=2]="lax",t[t.strict=3]="strict"}(c||(c={}))},function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return n}));const s={BUILD_NUMBER:"###VERSION###",BUILD_NUMBER_MINOR:-1};function o(t){if(t&&(s.BUILD_NUMBER=t,t.includes("."))){const e=t.split(".");s.BUILD_NUMBER_MINOR=parseInt((e[0]||"").concat((e[1]||"").padStart(3,"0")),10)}}function n(){try{return s.BUILD_NUMBER}catch(t){return s.BUILD_NUMBER}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return u})),i.d(e,"a",(function(){return l}));var s=i(0),o=i(1),n=i(15),r=i(7),c=i(16),a=i(9);let h=!1,d=!1;function u(){h=!1}function l(t,e,i,a,u,l,p){if(e.ULS.cn(595714433,s.a.X,o.a.Important,`Starting disposing the application. unloadApp:${t}; disposed:${h}; unloading:${d}`),h||d&&t)return void e.ULS.cn(595714908,s.a.X,o.a.Info,"Application is already disposed or unloading");const m={logger:e,postMessenger:i,innerApplicationFrame:a,onDisposed:u,onFrameRemoved:l,unloadTimeoutInMs:p||1e3,forceAppUnload:!1,disposeStartTime:Object(n.a)(),appUnloadTimedOut:!1};if(t&&a)return d=!0,m.forceAppUnload=!0,(b=m).forceAppUnloadStartTime=Object(n.a)(),b.logger.ULS.cn(595855490,s.a.X,o.a.Info,"Sending postmessage to unload app"),b.logger.ULS.flush(),b.postMessenger.registerMessagePayloadHandler(r.a.Si,t=>function(t,e){t.forceAppUnloadEndTime=Object(n.a)(),t.appUnloadedMessageValues=e,t.logger.ULS.cn(595855491,s.a.X,o.a.Info,"AppUnloaded received from app"),f(t)}(b,t)),b.postMessenger.sendPostMessage(b.innerApplicationFrame,c.a.Zo,{}),void window.setTimeout(()=>function(t){!d&&h||(t.appUnloadTimedOut=!0,t.logger.ULS.cn(595855492,s.a.X,o.a.Info,"ApplicationUnload timed out, forcing dispose"),f(t))}(b),b.unloadTimeoutInMs);var b;f(m)}function f(t){if(!h)try{h=!0,d=!1,function(t){t.innerApplicationFrame&&(t.innerApplicationFrame.src="about:blank",window.setTimeout(()=>{t.innerApplicationFrame&&t.innerApplicationFrame.parentElement&&t.innerApplicationFrame.parentElement.removeChild(t.innerApplicationFrame),t.onFrameRemoved&&t.onFrameRemoved()},0))}(t),function(t){const e={disposeStartTime:t.disposeStartTime,disposeEndTime:Object(n.a)(),forceAppUnload:t.forceAppUnload,appUnloadTimedOut:t.appUnloadTimedOut};if(t.forceAppUnloadStartTime&&(e.appUnloadStartTime=t.forceAppUnloadStartTime),t.forceAppUnloadEndTime&&(e.appUnloadEndTime=t.forceAppUnloadEndTime),t.appUnloadedMessageValues){const i=t.appUnloadedMessageValues,s=Number(i.hostMessageReceived);t.forceAppUnloadStartTime&&!isNaN(s)&&(e.hostToAppPostMessageLatency=s-t.forceAppUnloadStartTime);const o=Number(i.appMessageSent);!isNaN(o)&&t.forceAppUnloadEndTime&&(e.appToHostPostMessageLatency=t.forceAppUnloadEndTime-o);const n=Number(i.appUnloadStart),r=Number(i.appUnloadEnd);if(isNaN(n)||isNaN(r)||(e.appUnloadLatency=r-n),i.serverTimings){const t=i.serverTimings;for(const i in t)e["st-"+i.toString()]=t[i]}}t.logger.ULS.cn(595855436,s.a.X,o.a.Info,"App disposed "+JSON.stringify(e)),t.logger.ULS.flushOnClose()}(t),t.onDisposed&&t.onDisposed()}catch(e){t.logger.ULS.cn(595714434,s.a.X,o.a.Error,"Error disposing: "+Object(a.b)(e))}}},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.an="EnterpriseTemplates",t.hn="ExcelAdaptiveLayoutDownload",t.dn="ExcelLandingPageOfflineTelemetry",t.un="ExcelLandingPageObserverRetry",t.ln="H2StaticContent",t.fn="HashedUrl",t.pn="ODCShareLinkPreload",t.mn="OfficeComExcelJsApiV2",t.bn="OfficeComPptJsApiV2",t.wn="OfficeComUiHost",t.On="OfficeComWordJsApiV2",t.gn="OfficeHwaUiHost",t.vn="OfficeUnifiedUiHostTeams",t.jn="WordViewToUnifiedRead",t.Sn="DocAspxMsalLoad",t.In="WordWebInteractiveReadOnlyMode"}(s||(s={}))},,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i(0),o=i(1),n=i(9),r=i(63);class c{}c.logger=Object(r.a)();class a extends class{constructor(t){this._n={},this.resetCache=()=>{if(!this.Cn)return!1;try{return localStorage.removeItem(this.dataSettingsCacheKey),!0}catch(t){return c.logger.ULS.cn(557114832,s.a.X,o.a.Error,`${this.dataSettingsCacheKey}: Failure trying to Delete data in localStorage: ${Object(n.b)(t)}`),!1}},this.setCache=t=>{if(t&&this.Cn)try{localStorage.setItem(this.dataSettingsCacheKey,JSON.stringify(t))}catch(t){c.logger.ULS.cn(557114833,s.a.X,o.a.Error,`${this.dataSettingsCacheKey}: Error while saving settings in cache: ${Object(n.b)(t)}`)}},this.getIntegerSetting=t=>{const e=this.Tn(t);if(null!=e&&"number"==typeof e){const t=e;if(!isNaN(t))return t}return null},this.getBooleanSetting=t=>{const e=this.Tn(t);return null!=e&&"boolean"==typeof e?e:null},this.getStringSetting=t=>{const e=this.Tn(t);return null!=e&&"string"==typeof e?e:null},this.Tn=t=>{if(!this.Cn)return null;try{if(t in this._n)return this._n[t];const e=localStorage.getItem(this.dataSettingsCacheKey);if(null!==e){const i=JSON.parse(e)[t];return this._n[t]=i,i}}catch(e){c.logger.ULS.cn(557114834,s.a.X,o.a.Error,`${this.dataSettingsCacheKey}: Failure trying to find ${t} setting in localStorage: ${Object(n.b)(e)}`)}return null},this.dataSettingsCacheKey=t,this.Cn=!1;try{localStorage&&(this.Cn=!0)}catch(t){c.logger.ULS.cn(538018719,s.a.X,o.a.Warning,"Local storage not supported: "+Object(n.b)(t))}}}{static get Instance(){return a.yn||(a.yn=new a)}constructor(){super(a.An)}}a.An="OneNote_hostUtilsSettingsCache"},function(t,e,i){"use strict";i.d(e,"a",(function(){return f})),i.d(e,"b",(function(){return p}));var s=i(7),o=i(0),n=i(1),r=i(9),c=i(16),a=i(44),h=i(18),d=i(3),u=i(19),l=i(13);class f{GetApplicationType(){return l.a}GetVersion(){return Object(h.a)()}GetSessionId(){return this.En}RegisterEventHandler(t,e){switch(t){case d.a.Unloaded:case d.a.Disposed:case d.a.DocumentReboot:case d.a.WopiInfoFromUrl:case d.a.DavUrlFromIds:case d.a.GetAuthToken:case d.a.GetCustomAuthConfig:case d.a.MoveToFolder:case d.a.SharedFilePicker:case d.a.SetOverlayContent:case d.a.FileShare:if(this.Pn[t])throw new Error("Duplicate registration");this.Pn[t]=e;break;default:this.Un.registerMessagePayloadHandler(t,e)}}RemoveEventHandler(t,e){switch(t){case d.a.Unloaded:case d.a.Disposed:case d.a.DocumentReboot:case d.a.FileShare:case d.a.WopiInfoFromUrl:case d.a.DavUrlFromIds:case d.a.GetAuthToken:case d.a.GetCustomAuthConfig:case d.a.MoveToFolder:case d.a.SharedFilePicker:case d.a.SetOverlayContent:if(this.Pn[t]!==e)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Pn[t];break;default:this.Un.removeMessageHandler(t)}}RegisterErrorHandler(t){}RemoveErrorHandler(t){}PostCommand(t,e){this.Un.postMessageForCommand(this.Rn,t,e)}Dispose(t,e){Object(u.a)(t||!1,this.Wn,this.Un,this.Rn,()=>{delete this.Rn,this.Fn(),this.Un.dispose(),this.Mn(d.a.Unloaded,{})},()=>{try{this.Mn(d.a.Disposed,{}),this.Pn={}}catch(t){this.Wn.ULS.cn(589108815,o.a.X,n.a.Error,"onFrameRemoved error: "+Object(r.b)(t))}},e)}constructor(t,e,i,h,l){this.Pn={},this.kn=()=>{this.Un.registerMessagePayloadHandler(s.a.ci,this.Nn),this.Un.registerMessagePayloadHandler(s.a.Ze,this.xn),this.Un.registerMessagePayloadHandler(s.a.Xe,this.Hn),this.Un.registerMessagePayloadHandler(s.a.ze,this.Dn),this.Un.registerMessagePayloadHandler(s.a.Oi,this.Vn),this.Un.registerMessagePayloadHandler(s.a.qe,this.Bn),this.Un.registerMessagePayloadHandler(s.a.ti,this.Ln),this.Un.registerMessagePayloadHandler(s.a.pi,this.Jn)},this.Mn=(t,e)=>{const i=this.Pn[t];if(i)try{i(e||{})}catch(t){this.Wn.ULS.cn(593773706,o.a.X,n.a.Error,"Handler error: "+Object(r.b)(t))}},this.Nn=t=>{t.previousSessionId=this.En,this.Mn(d.a.DocumentReboot,t)},this.xn=t=>{this.Mn(d.a.WopiInfoFromUrl,t)},this.Hn=t=>{this.Mn(d.a.DavUrlFromIds,t)},this.Dn=t=>{Promise?this.$n.isResourceTrustedForMessage(t).then(e=>{e?this.Mn(d.a.GetAuthToken,t):this.Un.sendPostMessage(this.Rn,c.a.ko,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType})},()=>{this.Un.sendPostMessage(this.Rn,c.a.ko,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType})}):this.Un.sendPostMessage(this.Rn,c.a.ko,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:t.RequestId,IdentityType:t.IdentityType})},this.Vn=t=>{this.Mn(d.a.FileShare,t)},this.Bn=t=>{this.Mn(d.a.GetCustomAuthConfig,t)},this.Ln=t=>{this.Mn(d.a.MoveToFolder,t)},this.Jn=t=>{this.Mn(d.a.SharedFilePicker,t)},this.En=t,this.Wn=e,this.Rn=l.innerApplicationFrame,this.Un=i,this.Fn=h,this.$n=new a.a(e),this.kn(),Object(u.b)()}}function p(t,e,i,s,o){return new f(t,e,i,s,o)}},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.Unknown="UNKNOWN",t.Initialized="INITIALIZED",t.Prebooted="PREBOOTED",t.Booting="BOOTING",t.Booted="BOOTED",t.Failed="FAILED",t.Disposing="DISPOSING",t.Disposed="DISPOSED"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i(5);function o(t=!1,e){return{shouldPreconnect:t=>n&&(!e||e(t)),preconnect:e=>function(t){const e=document.createElement("link");e.rel="preconnect",e.href=t,e.crossOrigin="anonymous",document.head.appendChild(e)}(t?Object(s.w)(e):e)}}const n=!0},function(t,e,i){"use strict";i.d(e,"a",(function(){return q}));var s=i(0),o=i(1),n=i(5),r=i(18),c=i(54),a=i(55),h=i(15),d=i(63),u=i(7),l=i(20),f=i(9),p=i(41),m=i(16),b=i(62),w=i(19),O=i(12),g=i(13);function v(t,e){e&&e.Diagnostics&&Object.keys(e.Diagnostics).forEach(i=>t[i]=e.Diagnostics[i])}function j(t,e,i){e.ULS.cn(596459999,s.a.X,i,"SessionTraces: "+JSON.stringify(t))}function S(t,e){e.stop();const i=e.getVisibilityChangeEvents();null!=i&&i.length>0&&(t.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,t.SessionTraces.tabSwitchDiagnostics=JSON.stringify(i)),e.dispose()}function I(t,e,i){try{const c=function(t,e){const i={...e};delete i.UserId,delete i.OwnerId,delete i.SiteId,delete i.WebId,delete i.Upn,delete i.TenantId,delete i.UiHostTabId,delete i.OriginalWdParam,delete i.WdParams;const s=i,o=e.WdParams?JSON.parse(JSON.stringify(e.WdParams).toLowerCase()):{};s.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach(t=>{o[t]&&(s.WdParams[t]=o[t])});const r=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;return s.WdParams.wdprevioussession&&!r.test(s.WdParams.wdprevioussession)&&delete s.WdParams.wdprevioussession,s.WdParams.wdpreviouscorrelation&&!r.test(s.WdParams.wdpreviouscorrelation)&&delete s.WdParams.wdpreviouscorrelation,s.UiEmbedMode=Object(n.p)(t,"uiembed"),s.UiHostName=Object(n.k)(t,"uih")||"N/A",s.HostDomain=location?location.hostname:"",s}(e.applicationUrl,e.sessionInformation);c.Build=Object(r.a)(),c.Region=Object(n.m)(e.applicationUrl);const a={...e.rebootOverrideData};delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl,c.RebootOverride=a;const h=e.diagnostics.HostInitDiagnostics;h&&(t.ULS.cn(596444238,s.a.X,o.a.Info,"HostInitDiagnostics: "+JSON.stringify(e.diagnostics.HostInitDiagnostics)),c.SessionOrigin=h.entryPoint),i&&t.ULS.cn(595937313,s.a.X,o.a.Info,JSON.stringify(i));const d=e.wopiInfo;d&&d.AccessToken&&d.AccessTokenExpiry||t.ULS.cn(595894553,s.a.X,o.a.Warning,"There are some missing parameters"),d&&(d.AccessToken&&(c.AccessTokenLength=d.AccessToken.length),c.AccessTokenExpiry=d.AccessTokenExpiry,d.WacToken&&(c.WacTokenLength=d.WacToken.length)),"Microsoft Teams"===e.sessionInformation.HostName&&t.ULS.cn(507122579,s.a.X,o.a.Important,"Word setting Force View only for Teams WXP Files session."),c.JsApiVersion="v1",t.ULS.cn(596444237,s.a.X,o.a.Important,JSON.stringify({session:c,client:e.diagnostics.ClientDiagnostics}))}catch(e){t.ULS.cn(558155802,s.a.X,o.a.Error,"Failed to log initialization info: "+Object(f.b)(e))}}var _,C=i(56),T=i(42),y=i(8),A=i(14),E=i(2);function P(t,e,i,r){var c,a;let h=!1;const d=null===(c=t.container)||void 0===c?void 0:c.baseURI,u=Object(n.q)(d,"embed.aspx"),l=!(!t.isCreateNew||t.wopiInfo),p=!(!t.sessionInformation.WdParams||"1"!==t.sessionInformation.WdParams.wdembedfs),m="docx"===Object(f.a)(t.wopiPrecheckInfo.FileName),b=!(!t.sessionInformation.WdParams||"1"!==t.sessionInformation.WdParams.wdreadingview),w=t.je.getValue(A.a.ao,!1),O=null===(a=t.sessionInformation.WdParams)||void 0===a?void 0:a.wdmobile,g=t.je.getValue(A.a.do,!1)?Object(n.k)(t.applicationUrl,"uih"):void 0,v=Object(E.c)(O,g);if(h=(!e||w&&v)&&!i&&!u&&(l||m)&&!p&&!b,!h){const t={isUiEmbedModeApplicationUrl:e,isEmbedActionApplicationUrl:i,baseUrlIsForEmbedEndpoint:u,isCreateNewWithoutWopiInfo:l,isEmbeddedFullScreen:p,isFileDocx:m,isReadingViewMode:b};r.ULS.cn(505996418,s.a.X,o.a.Important,"canSupportInteractiveReadOnly is false. DebugInfo: "+JSON.stringify(t))}return h}function U(t,e,i){var n;const r=t.featureManager.isFeatureEnabled(l.a.In),c=t.je.getValue(A.a.co,!1),a=null!==(n=r||c)&&void 0!==n&&n&&t.canSupportInteractiveReadOnly&&e;if(e&&!a){const e={canSupportInteractiveReadOnly:!!t.canSupportInteractiveReadOnly,interactiveReadOnlyFlightValue:r,interactiveReadOnlySettingValue:c};i.ULS.cn(505996417,s.a.X,o.a.Important,"interactive read only  redirection will not happen. DebugInfo: "+JSON.stringify(e))}return a&&i.ULS.cn(505529752,s.a.X,o.a.Important,"Will redirect viewer request to unified read"),a}function R(t,e,i){var r;const c=t.je.getValue(A.a.co,!1),a=null===(r=t.sessionInformation.WdParams)||void 0===r?void 0:r.wdmobile,h=t.je.getValue(A.a.do,!1)?Object(n.k)(t.applicationUrl,"uih"):void 0,d=Object(E.c)(a,h),u=c&&t.canSupportInteractiveReadOnly&&e&&d;if(e&&!u){const e={canSupportInteractiveReadOnly:!!t.canSupportInteractiveReadOnly,isMobileRedirectionSettingEnabled:c,isMobileModeRequested:d,wdMobile:a,uiHost:h};i.ULS.cn(504988676,s.a.X,o.a.Important,"intractive read only  redirection will not happen. DebugInfo: "+JSON.stringify(e))}return u&&i.ULS.cn(504988675,s.a.X,o.a.Important,"Will redirect mobile viewer request to unified read"),u}function W(t,e,i=!1){let s=t.applicationUrl,o={};if("Microsoft Teams"===t.sessionInformation.HostName&&(o.fvo="1",o.readOnly="1",t.wopiPrecheckInfo.ReadOnly&&(o.mode="Read")),o.jsApi="1",o.jsapiver="v1",i&&(o.NewSession="1"),o.corrid=t.sessionId,o.usid=t.sessionId,o.sftc="1",t.applicationCustomSettings&&t.applicationCustomSettings.IsCore&&(o.core="1"),t.sessionInformation.HideViewerToolbar&&(o.hvt="1"),t.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),t.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(t.sessionInformation.HighContrastMode)),t.sessionInformation.SupportsAtMentions&&(o.sams="1"),t.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),t.sessionInformation.SupportsDocReboot){const e=t.sessionInformation.SupportsDocReboot;o.sdr=!0===e?"1":e.toString()}return t.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),t.sessionInformation.SupportsAuthToken&&(o.sat="1"),window.docAspxMsalEnabled&&"onedrivecom"!==Object(n.s)(t.applicationUrl).uih&&(t.sessionInformation.AuthTokenStrategy="PairwiseBroker"),t.sessionInformation.AuthTokenStrategy&&(o.ats=t.sessionInformation.AuthTokenStrategy),t.sessionInformation.SupportsCustomAuthConfig&&(o.cac="1"),t.sessionInformation.TopOrigin&&(o.to=encodeURIComponent(t.sessionInformation.TopOrigin)),t.sessionInformation.IsDeeplyNestedAuthSupportedInTeams&&(o.dnaa="1"),t.sessionInformation.SupportsMoveToFolder&&(o.mtf="1"),t.sessionInformation.SupportsCommonFilePicker&&(o.sfp="1"),t.sessionInformation.OpenLinksInNewWindow&&(o.onw="1"),t.sessionInformation.UseDarkTheme&&(o.udt="1"),(t.sessionInformation.HideHeader||"DocGen"===t.sessionInformation.ContentAssemblyMode||"Templatization"===t.sessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===t.sessionInformation.ContentAssemblyMode||"ContentAssemblyView"===t.sessionInformation.ContentAssemblyMode)&&(o.hhdr="1"),t.sessionInformation.HideAppLauncherInHeader&&(o.halh="1"),t.sessionInformation.HideChatInHeader&&(o.hch="1"),t.sessionInformation.HideMeInHeader&&(o.hmh="1"),t.sessionInformation.HideSearchInHeader&&(o.hsh="1"),t.sessionInformation.HideWorkflowInHeader&&(o.hwfh="1"),t.sessionInformation.HideSettingsInHeader&&(o.hsth="1"),t.sessionInformation.ShowAppIconInHeader&&(o.sih="1"),t.sessionInformation.UseNeutralColorInHeader&&(o.unh="1"),t.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),t.sessionInformation.HideTitleInViewer&&(o.htv="1"),t.sessionInformation.HideWACOneDriveFileLocationPicker&&(o.hodflp="1"),t.sessionInformation.NoBrowserModalDialogs&&(o.nbmd="1"),t.applicationCustomSettings&&t.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),(t.wopiPrecheckInfo.ReadOnly||e.bootFlowType===_.wordViewToUnifiedReadRedirect||e.bootFlowType===_.wordMobileUnifiedReadRedirect)&&(o.readOnly="1",t.wopiPrecheckInfo.ReadOnly&&(o.mode="Read")),"DocGen"!==t.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==t.sessionInformation.ContentAssemblyMode||(o.readOnly="1"),e.bootFlowType!==_.wordViewToUnifiedReadRedirect&&e.bootFlowType!==_.wordMobileUnifiedReadRedirect||(o.iro="1"),t.canSupportInteractiveReadOnly&&(o.csiro="1"),e.bootFlowType===_.wordMobileUnifiedReadRedirect&&(o.mobile="1",o.hhdr="1"),t.sessionInformation.UIEmbed&&(o.uiEmbed="1"),t.sessionInformation.IsSynthetic&&(o.syn="1"),t.sessionInformation.SupportsDirectDownload&&(o.sdd="1"),t.sessionInformation.SupportsDirectPrint&&(o.sdp="1"),t.sessionInformation.DisableOfficeAddins&&(o.doa="1"),t.sessionInformation.UiHostIntegrationType&&(o.uihit=encodeURIComponent(t.sessionInformation.UiHostIntegrationType)),t.sessionInformation.MetaUiHostVersion&&(o.muv=encodeURIComponent(t.sessionInformation.MetaUiHostVersion)),t.applicationCustomSettings&&t.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),e.isSingleStepBoot?(e.bootFlowType===_.unifiedSingleFlush&&(t.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=e.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(t.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(Object(n.i)(window.location.href)),t.isCreateNew&&(o.new="1",t.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),t.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(t.wopiPrecheckInfo.PreseededSessionKey)),t.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(t.wopiPrecheckInfo.PreseededWacSessionId)),t.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=t.wopiPrecheckInfo.RequestedCallThrottling),t.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=t.wopiPrecheckInfo.ClientThrottlingProtection),t.applicationCustomSettings&&t.applicationCustomSettings.additionalApplicationParameters&&(o={...t.applicationCustomSettings.additionalApplicationParameters,...o}),t.rebootOverrideData&&t.rebootOverrideData.queryOverrides&&(o={...o,...t.rebootOverrideData.queryOverrides}),t.sessionInformation.AfdFlighting&&(o.afdflight=Math.floor(100*Math.random()+1).toString()),function(t,e,i,s,o){let r=Object(n.s)(t);("teams"===r.uih&&"UnifiedUiHostTeams"!==e.UiHostIntegrationType&&"TeamsModern"!==e.UiHostIntegrationType||"owa"===r.uih)&&(r.hhdr="1");const c=t.indexOf("?"),a=-1===c?t.concat("?"):t.substring(0,c+1);e.UiLocale&&(r.ui=encodeURIComponent(e.UiLocale)),e.DataLocale&&(r.rs=encodeURIComponent(e.DataLocale)),e.HostSessionId&&(r.hid=encodeURIComponent(e.HostSessionId)),e.DisableChat&&(r.dchat="1"),e.SessionContext&&(r.sc=encodeURIComponent(e.SessionContext)),i&&i.WopiSrc&&(r.wopisrc=encodeURIComponent(i.WopiSrc)),e.CookieCompliant&&(r.mscc="1"),s&&(s.entryPoint&&(r.wdorigin=encodeURI(s.entryPoint)),s.userClickTime&&(r.wdhostclicktime=s.userClickTime.toString())),r={...r,...e.WdParams,...o};const h={};for(const t in r)h[t.toLowerCase()]=r[t];const d=[];for(const t in h)h[t]&&d.push(t.concat("=",h[t]));return a.concat(d.join("&"))}(s,t.sessionInformation,t.wopiInfo,t.diagnostics.HostInitDiagnostics,o)}function F(t){return t.AccessTokenExpiry?t.AccessTokenExpiry.getTime().toString():"0"}!function(t){t.bootWithoutWopiInfo="",t.unifiedSingleFlush="Unified_SingleFlush",t.unifiedIrmEnabled="Unified_IrmEnabled",t.unifiedViewActionUrl="Unified_ViewActionUrl",t.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",t.forceSingleStepBoot="Force_SingleStepBoot",t.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",t.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",t.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect",t.wordMobileUnifiedReadRedirect="WordMobile_UnifiedReadRedirect"}(_||(_={}));var M=i(39),k=i(17);const N={[M.a.blurFocus]:m.a.po,[M.a.continueAccessibilityLoop]:m.a.vo,[M.a.grabFocus]:m.a.jo,[M.a.moveToFolder]:m.a.ti,[M.a.popState]:m.a.To,[M.a.rename]:m.a.Fo,[M.a.sendAccessToken]:m.a.Mo,[M.a.sendAuthToken]:m.a.ko,[M.a.sendCustomAuthConfig]:m.a.No,[M.a.sendEmbeddedViewUrl]:m.a.Ho,[M.a.sendSessionInfo]:m.a.Do,[M.a.sendUserAccessAndPermissions]:m.a.Vo,[M.a.sendWopiInfo]:m.a.Bo,[M.a.sendDavUrl]:m.a.Lo,[M.a.completeSharedFilePicker]:m.a.pi,[M.a.switchMode]:m.a.Ko,[M.a.signalShared]:m.a.Yo};class x{registerMessagePayloadHandler(t,e){if(this.Pn[t])throw new Error("Duplicate registration!");this.Pn[t]=e}removeMessageHandler(t){delete this.Pn[t]}sendPostMessage(t,e,i){if(!t||!t.contentWindow)return void this.Wn.ULS.cn(595948308,s.a.X,o.a.Info,"Missing target for SendPostMessage");this.Wn.ULS.cn(596464334,s.a.X,o.a.Info,"Sending message: "+e);const n={MessageId:e,SendTime:Object(h.a)(),Values:i};this.Gn(t.contentWindow,JSON.stringify(n),this.zn)}activate(t,e){this.Rn=t,this.qn=!!e,this.Kn||(window.addEventListener("message",this.Zn,!1),this.Kn=!0)}postMessageForCommand(t,e,i){const n=N[e];n?(this.Wn.ULS.cn(595702598,s.a.X,o.a.Info,`Sending message ${n} for command ${e}`),this.sendPostMessage(t,n,i)):this.Wn.ULS.cn(595702599,s.a.X,o.a.Warning,"No mapping for command "+e)}dispose(){this.Pn={},this.Kn&&(window.removeEventListener("message",this.Zn,!1),this.Kn=!1)}constructor(t,e){var i;if(this.Kn=!1,this.Pn={},this.zn="",this.Xn="",this.qn=!1,this.Qn=!1,this.Yn=!1,this.tr=!1,this.er=[],this.ir=!0,this.sr=(t,e,i)=>{if(!t)return void this.Wn.ULS.cn(595736136,s.a.X,o.a.Info,"Missing target to send Ack back");const n={MessageId:m.a.uo,CorrelationId:i,SendTime:Object(h.a)()};this.Wn.ULS.cn(595732176,s.a.X,o.a.Info,"Sending Ack back"),t.postMessage(JSON.stringify(n),e)},this.Zn=t=>{let e,i=!1,r=!0,c="",a=!1;if(this.Rn&&this.Rn.contentWindow&&(i=!0,r=t.source===this.Rn.contentWindow),t.origin&&(c=Object(n.h)(t.origin,2).toLowerCase(),a=c===this.Xn,!a&&this.or&&(c=Object(n.h)(t.origin).toLowerCase(),a=this.or.includes(c))),!this.Qn&&(!this.Yn||a&&r)||this.Wn.ULS.cn(595730526,s.a.X,o.a.Info,`Window is available: ${i}, window is valid: ${r}, origin is valid: ${a}, expected origin: ${this.Xn}, actual origin: ${c}`),!a||this.qn&&!r)return;try{e=JSON.parse(t.data)}catch(t){return void this.Wn.ULS.cn(596464282,s.a.X,o.a.Info,`Failed to parse event data: ${Object(f.b)(t)}.`)}const h=e.MessageId;if(!h)return void((this.Qn||this.Yn)&&this.Wn.ULS.cn(595730520,s.a.X,o.a.Info,"Could not find message id"));var d;if(this.Wn.ULS.cn(595714715,s.a.X,o.a.Info,`Received messageId: ${h}, correlation: ${e.CorrelationId}`),h!==u.a.Ae&&h!==u.a.Qe||this.nr(t.origin),this.tr&&h===u.a.fs)return window._pageTimings=null!==(d=window._pageTimings)&&void 0!==d?d:{},void(window._pageTimings[e.Values.name]=e.Values.time);e.Values&&e.Values.ackExpected&&this.sr(t.source,t.origin,e.CorrelationId);const l=this.Pn[h];if(!l)return this.Wn.ULS.cn(596464289,s.a.X,o.a.Info,"No handler found for message id: "+h),void(this.ir&&h===u.a.ze&&(this.er.push(e),this.Wn.ULS.cn(543207888,s.a.X,o.a.Info,"Kept for later process: "+h)));this.Wn.ULS.cn(596464288,s.a.X,o.a.Info,"Processing message: "+h),h===u.a.Oi&&(e.Values={...e.Values||{},sendTimeAsClickTime:e.SendTime});try{l(e.Values||{})}catch(t){this.Wn.ULS.cn(593773704,s.a.X,o.a.Error,"Handler error: "+Object(f.b)(t))}this.ir&&h===u.a.Ae&&this.rr()},this.rr=()=>{this.ir=!1,this.er.forEach(t=>{const e=t.MessageId,i=this.Pn[e];if(i){this.Wn.ULS.cn(543207890,s.a.X,o.a.Info,"Processing message after boot complete: "+e);try{i(t.Values||{})}catch(t){this.Wn.ULS.cn(543207891,s.a.X,o.a.Error,"Handler error: "+Object(f.b)(t))}}else this.Wn.ULS.cn(543207889,s.a.X,o.a.Info,"No handler found after boot complete: "+e)}),this.er=[]},this.Gn=(t,e,i)=>{t.postMessage(e,i)},this.nr=t=>{const e=t.toLowerCase();this.zn&&this.zn!==e&&this.Wn.ULS.cn(596128131,s.a.X,o.a.Warning,`Updating origin: [${Object(n.g)(this.zn)}]->[${Object(n.g)(e)}]`),this.zn=e,this.Xn=Object(n.h)(e,2),this.Qn=Object(n.n)(e),this.Yn=Object(n.o)(e)},!t)throw new Error("Missing origin for PostMessageHandler");this.Qn=Object(n.n)(t),this.Yn=Object(n.o)(t),this.Wn=e,this.nr(t),this.tr=!(null===(i=window.location)||void 0===i||null===(i=i.search)||void 0===i||!i.match(/wdpa=1/gi))||"1"===Object(k.b)("EnableMetricLogging")}}var H=i(57),D=i(58),V=i(59),B=i(60),L=i(61);class J{Boot(){this.Wn.ULS.cn(596444241,s.a.X,o.a.Info,"Initializing WAC frame");const t=W(this.cr,this.ar,!0),e=function(t,e){const i={};if(t.wopiInfo&&(i[C.a.hr]=t.wopiInfo.AccessToken,i[C.a.dr]=F(t.wopiInfo),t.wopiInfo.WacToken&&(i[C.a.ur]=t.wopiInfo.WacToken)),t.wopiPrecheckInfo.BundleInfo&&t.wopiPrecheckInfo.BundleInfo.Url&&t.wopiPrecheckInfo.BundleInfo.Url.length>0)if(i[C.a.lr]=t.wopiPrecheckInfo.BundleInfo.Url,null!=t.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==t.wopiPrecheckInfo.BundleInfo.BundleStaleness){const n=t.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();e.ULS.cn(593503580,s.a.X,o.a.Info,"Content bundle staleness - "+n),i[C.a.pr]=n}else e.ULS.cn(593503581,s.a.X,o.a.Info,"Content bundle staleness does not exist");if(t.wopiPrecheckInfo.FileGetUrl&&(i[C.a.mr]=t.wopiPrecheckInfo.FileGetUrl),t.wopiPrecheckInfo.CustomFontCatalogUrl&&(i[C.a.br]=t.wopiPrecheckInfo.CustomFontCatalogUrl),t.wopiPrecheckInfo.FileName){const e=Object(f.a)(t.wopiPrecheckInfo.FileName);e&&(i[C.a.wr]=e),i[C.a.Or]=t.wopiPrecheckInfo.FileName}t.newFileTemplateSource&&t.newFileTemplateSource.FileSize?i[C.a.gr]=t.newFileTemplateSource.FileSize.toString():t.wopiPrecheckInfo.FileSize&&(i[C.a.gr]=t.wopiPrecheckInfo.FileSize.toString()),t.sessionInformation.UserId&&(i[C.a.vr]=t.sessionInformation.UserId),t.sessionInformation.OwnerId&&(i[C.a.jr]=t.sessionInformation.OwnerId),t.sessionInformation.SessionContext&&(i[C.a.Sr]=t.sessionInformation.SessionContext),void 0!==t.sessionInformation.SupportsZipIt&&(i[C.a.Ir]=t.sessionInformation.SupportsZipIt.toString()),t.diagnostics.HostInitDiagnostics&&(i[C.a._r]=JSON.stringify({HostInitializeDiagnostics:t.diagnostics.HostInitDiagnostics,ClientDiagnostics:t.diagnostics.ClientDiagnostics})),i[C.a.Cr]=Object(T.b)(t.featureManager,t.sessionInformation.WdParams),t.applicationCustomSettings&&t.applicationCustomSettings.HostUIControls&&(i[C.a.Tr]=JSON.stringify(t.applicationCustomSettings.HostUIControls)),i[C.a.yr]=String(window.devicePixelRatio>1.24),i[C.a.Ar]=String(Object(y.g)()),i[C.a.Er]=t.sessionInformation.HostName;const n=t.newFileTemplateSource;n&&n.FileGetUrl&&(i[C.a.Pr]=n.FileGetUrl),n&&n.DocUniqueId?i[C.a.Ur]=n.DocUniqueId:t.wopiPrecheckInfo.DocUniqueId&&(i[C.a.Ur]=t.wopiPrecheckInfo.DocUniqueId),n&&n.ETag?i[C.a.Rr]=n.ETag:t.wopiPrecheckInfo.ETag&&(i[C.a.Rr]=t.wopiPrecheckInfo.ETag),"Templatization"!==t.sessionInformation.ContentAssemblyMode&&"DocGen"!==t.sessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==t.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==t.sessionInformation.ContentAssemblyMode||(i[C.a.Wr]="1"),t.sessionInformation.ContentAssemblyMode&&(i[C.a.Fr]=t.sessionInformation.ContentAssemblyMode);const c=t.sessionInformation.Meeting;c&&(c.id&&(i[C.a.Mr]=c.id),c.title&&(i[C.a.kr]=c.title),c.type&&(i[C.a.Nr]=c.type),c.scheduledStartTime&&(i[C.a.xr]=c.scheduledStartTime),c.scheduledEndTime&&(i[C.a.xr]=c.scheduledEndTime),c.joinUrl&&(i[C.a.Hr]=encodeURIComponent(c.joinUrl)),c.organizerId&&(i[C.a.Dr]=c.organizerId),c.isPresenter&&(i[C.a.Vr]=c.isPresenter.toString()),c.isMeetingTeamsRoom&&(i[C.a.Br]=c.isMeetingTeamsRoom.toString()));const a=t.sessionInformation.OwlVersion;a&&(i[C.a.Lr]=a);const h=t.sessionInformation.OwlRollout;h&&(i[C.a.Jr]=h);const d=t.sessionInformation.SupportsInPlaceCreateNew;d&&(i[C.a.$r]=d.toString()),t.sessionInformation.DisableEmbedViewCodeSnippet&&(i[C.a.Gr]="1"),t.sessionInformation.DisableCoEditInTeams&&(i[C.a.zr]="1"),i[C.a.qr]=Object(r.a)();const u=t.sessionInformation.TraceParent;if(u){i[C.a.Kr]=u;const e=t.sessionInformation.TraceState;e&&(i[C.a.Zr]=e)}return i}(this.cr,this.Wn);if(this.Un.registerMessagePayloadHandler(u.a.ye,this.Xr),this.Un.registerMessagePayloadHandler(u.a.Ue,this.Qr),this.cr.sessionInformation.SupportsFrameTrustCheck||this.Un.registerMessagePayloadHandler(u.a.$e,this.Yr),this.Un.registerMessagePayloadHandler(u.a.wi,this.tc),this.Un.registerMessagePayloadHandler(u.a.Ke,this.ec),this.Un.registerMessagePayloadHandler(u.a.ji,this.ic),this.Un.registerMessagePayloadHandler(u.a.Os,this.oc),this.ar.ignoreWacFramePostMessages||this.nc(Object(n.n)(t)),this.rc(t,e),this.ar.ignoreWacFramePostMessages){const t=this.cc();this.hc(t)}return this.Wn.ULS.cn(595661019,s.a.X,o.a.Info,"Created Wac Frame"),this.Rn}constructor(t,e,i,r,c,d){if(this.dc=!1,this.rc=(t,e)=>{this.uc.officeFrameCreateTime=Object(h.a)(),this.lc.frameCreateStartTime=this.uc.officeFrameCreateTime;const i=this.cr.applicationCustomSettings&&this.cr.applicationCustomSettings.appFrameName;this.Rn=function(t,e,i,s,o,r,c){return function(t,e,i,s){Object(C.b)(t,s);const o=e.ownerDocument,n=o.createElement("form");n.id="office_form",n.name="office_form",n.action=i,n.target=t.name,n.method="POST";for(const t in s){const e=o.createElement("input");e.type="hidden",e.name=t,e.value=s[t],n.appendChild(e)}return e.appendChild(n),n.submit(),t}(function(t,e,i){const s=t.ownerDocument.createElement("iframe");s.name=i||"WebApplicationFrame",s.id="WebApplicationFrame",s.src="",s.title="Office Online Frame",s.width="100%",s.height="100%",s.marginWidth="0",s.marginHeight="0",s.style.left="0",s.style.top="0",s.style.right="0",s.style.bottom="0",s.style.display="block",s.style.position="absolute",s.style.backgroundColor="transparent",s.style.border="none",s.frameBorder="0",s.setAttribute("allowfullscreen","true"),s.setAttribute("allowTransparency","true");const o=Object(n.i)(e);return s.setAttribute("allow",`microphone ${o}; autoplay ${o}; camera ${o}; clipboard-read ${o}; clipboard-write ${o}; keyboard-map ${o}; display-capture ${o}`),t.appendChild(s),s}(t,e,c),t,e,i)}(this.cr.container,t,e,this.cr.featureManager,this.Wn,this.cr.sessionId,i),this.Un.activate(this.Rn)},this.nc=t=>{this.Un.registerMessagePayloadHandler(u.a.Ae,this.fc),this.Un.registerMessagePayloadHandler(u.a.Te,this.pc),this.mc=window.setTimeout(this.bc,15e3),this.wc=new H.a(t,this.cr.je,this.Wn,()=>{Object(a.c)(this.cr.remoteTelemetryUrl,g.a,"bootTimeout")})},this.oc=t=>{const e=t.flightKey,i=t.flightValue;this.Wn.ULS.cn(507343133,s.a.Pt,o.a.Info,`storeWacFlightKeyValue ${e}: ${i}`);try{Object(D.b)(t)}catch(t){this.Wn.ULS.cn(507340380,s.a.Pt,o.a.Error,"Handler error: "+Object(f.b)(t))}},this.Xr=t=>{const e=t&&t.state?t.state:"unknown";this.Wn.ULS.cn(595714271,s.a.X,o.a.Info,`WAC Boot App state:[${e}]`)},this.Yr=t=>{const e=Object(C.f)(this.Wn);this.Wn.ULS.cn(595653903,s.a.X,o.a.Info,"Top frame is trusted: "+e),this.Oc(m.a.$e,{isTopFrameTrusted:e})},this.tc=t=>{const e=Object(V.b)(t&&t.overlayContent);this.Wn.ULS.cn(587487432,s.a.X,o.a.Info,"Overlay content: "+e),this.Oc(m.a.zo,void 0)},this.fc=t=>{if(this.Wn.ULS.cn(595986314,s.a.X,o.a.Info,"Received wac complete message"),this.Wn.ULS.flush(),window.clearTimeout(this.mc),this.wc&&this.wc.stop(),this.dc)return void this.Wn.ULS.cn(596444234,s.a.X,o.a.Info,"Received multiple wac complete or failure messages");this.dc=!0,this.Oc(m.a.bo,{}),v(this.uc,t);const e=this.cc();this.hc(e),this.cr.je.getValue(A.a.ks,!1)&&(this.cr.diagnostics.HostInitDiagnostics||(this.cr.diagnostics.HostInitDiagnostics={}),Object(p.a)(this.cr.diagnostics.HostInitDiagnostics)),this.gc(this.cr.diagnostics)},this.Qr=()=>{this.Wn.ULS.cn(579342464,s.a.X,o.a.Info,"Received close tab message");try{window.close()}catch{this.Wn.ULS.cn(579213188,s.a.X,o.a.Warning,"Failed to close the browser tab")}},this.cc=()=>({innerApplicationFrame:this.Rn}),this.pc=t=>{if(this.Wn.ULS.cn(595986315,s.a.X,o.a.Error,"Received wac failed message"),this.Wn.ULS.flush(),window.clearTimeout(this.mc),this.wc&&this.wc.stop(),this.dc)return void this.Wn.ULS.cn(596444235,s.a.X,o.a.Info,"Received multiple wac complete or failure messages");this.dc=!0,this.Oc(m.a.mo,{});const e={errorType:O.a.WacFailed,errorObject:{}};t&&(e.errorObject=t.Error,this.lc.error=e),this.vc(e)},this.ec=t=>{const e=t.hostKey;this.Wn.ULS.cn(574433173,s.a.X,o.a.Info,"GetHostKeyValue "+e);const i=Object(B.b)(t);null!=i&&this.Oc(m.a.Io,{hostKey:e,hostValue:i})},this.ic=t=>{const e=t.hostKey,i=t.hostValue;this.Wn.ULS.cn(574433174,s.a.X,o.a.Info,`storeHostKeyValue ${e}: ${i}`),Object(L.b)(t)},this.bc=()=>{this.dc||this.Wn.ULS.cn(596444236,s.a.X,o.a.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.lc))},this.gc=t=>{this.Oc(m.a._o,{HostInitializeDiagnostics:t.HostInitDiagnostics,ClientDiagnostics:t.ClientDiagnostics})},this.Oc=(t,e)=>{this.Rn&&this.Rn.contentWindow?this.Un.sendPostMessage(this.Rn,t,e):this.Wn.ULS.cn(595955718,s.a.X,o.a.Info,"Attempted to send postmessage: "+t)},void 0===e)throw new TypeError("bootFlowInfo");if(e.isSingleStepBoot&&void 0===t.wopiInfo)throw new TypeError("wopiInfo");this.cr=t,this.ar=e,this.Wn=i,this.Un=r,this.hc=c,this.vc=d,this.uc=t.diagnostics.AppInitDiagnostics,this.lc=t.diagnostics.SessionTraces,this.lc.wopiInitializeTime=Object(h.a)()}}class ${Complete(t,e){if(this.jc)this.Wn.ULS.cn(596444184,s.a.X,o.a.Warning,"Complete called after Complete/Fail already called");else{this.Wn.ULS.cn(596444185,s.a.X,o.a.Info,"Complete called."),this.cr.diagnostics.HostInitDiagnostics&&(this.cr.diagnostics.HostInitDiagnostics.hostCompleteCallTime=Object(h.a)()),this.jc=!0,this.Sc=t,this.lc.wopiPendingCompleteTime=Object(h.a)();try{this.ar.isSingleStepBoot?this.Ic():this._c(),this.Cc&&this.Oc(m.a.qo,{}),this.Tc(e)}catch(t){this.Wn.ULS.cn(596444186,s.a.X,o.a.Error,"Unexpected script error: "+Object(f.b)(t)),Object(a.c)(this.cr.remoteTelemetryUrl,g.a,"bootException")}finally{this.Wn.ULS.flush()}}}Fail(t){this.jc?this.Wn.ULS.cn(596444187,s.a.X,o.a.Warning,"Fail called after Complete/Fail already called"):(this.Wn.ULS.cn(596444188,s.a.X,o.a.Warning,"Fail called. Reason: "+(t?JSON.stringify(t):"N/A")),this.jc=!0,this.ar.isSingleStepBoot?this.yc():this.Ac(t),this.Wn.ULS.flush())}Dispose(t,e,i){Object(w.a)(t||!1,this.Wn,this.Un,this.Rn,()=>{delete this.Rn,e&&e(),this.Ec(),this.Un.dispose()},void 0,i)}PostWacToken(t,e,i){!function(t,e,i,n,r,c){const a=Object(h.a)();n.ULS.cn(507774684,s.a.X,o.a.Important,"postWacToken flow initiated");const d=()=>{c&&c.flush&&c.flush()};r?r.then(r=>{const l=()=>i.sendPostMessage(r,m.a.rn,{wacToken:t,postWacTokenStart:e});l();const f=window.setInterval(l,100);i.registerMessagePayloadHandler(u.a.ms,t=>{n.ULS.cn(507597019,s.a.X,o.a.Info,`postWacToken flow completed in ${Object(h.a)()-a} ms`),window.clearInterval(f),window.clearTimeout(p),c&&(c.PostWacTokenResult="success",c.PostWacTokenEndTime=Object(h.a)(),t&&void 0!==t.TokenAlreadySet&&(c.TokenAlreadySet=t.TokenAlreadySet),d())});const p=window.setTimeout(()=>{n.ULS.cn(507597018,s.a.X,o.a.Warning,"postWacToken flow timed out after 60000 ms"),window.clearInterval(f),c&&(c.PostWacTokenResult="timeout",c.PostWacTokenEndTime=Object(h.a)(),d())},6e4)}).catch(t=>{n.ULS.cn(507873094,s.a.X,o.a.Warning,"This should never reject, error: "+Object(f.b)(t)),c&&(c.PostWacTokenResult="Unexpected JSAPI V1 error",c.PostWacTokenEndTime=Object(h.a)(),d())}):(n.ULS.cn(507846862,s.a.X,o.a.Warning,"`Promise` does not exist natively for this browser."),c&&(c.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",c.PostWacTokenEndTime=Object(h.a)(),d()))}(t,e,this.Un,this.Wn,this.Pc,i)}Boot(){this.ar.isSingleStepBoot||this.Uc(),this.Wn.ULS.flush()}constructor(t,e,i,c,a,d,l){this.Cc=!1,this.Rc=!1,this.jc=!1,this.Wc=null,this.Fc=!0,this.Mc=!1,this.kc=!1,this.Uc=()=>{this.Wn.ULS.cn(596444231,s.a.X,o.a.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(this.Nc,5e3),this.Un.registerMessagePayloadHandler(u.a.Ce,this.xc),this.Un.registerMessagePayloadHandler(u.a.bi,this.Hc);const t=new J(this.cr,this.ar,this.Wn,this.Un,this.hc,this.vc);this.Rn=t.Boot(),this.Dc&&this.Dc(this.Rn)},this._c=()=>{const t={ParallelizeStartSession:this.Fc,WacFrameIsLoaded:this.Cc,WacAcceptsStartSessionComplete:this.Mc};this.Wn.ULS.cn(596444232,s.a.X,o.a.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(t)),!this.Fc||this.Cc&&!this.Mc?this.Cc&&this.Vc():this.Bc()},this.Ic=()=>{this.Wn.ULS.cn(596444233,s.a.X,o.a.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.cr.wopiInfo=this.Sc;const t=new J(this.cr,this.ar,this.Wn,this.Un,this.hc,this.vc);this.Rn=t.Boot(),this.Dc(this.Rn)},this.Ac=t=>{this.Cc?(this.Wn.ULS.cn(595968481,s.a.X,o.a.Warning,"Fail called and wacframe is able to accept postmessages"),this.Lc(t)):(this.Wn.ULS.cn(595968482,s.a.X,o.a.Warning,"Fail was called on the session prior to WacReady."),this.Wc=t)},this.Lc=t=>{this.Wn.ULS.cn(596444189,s.a.X,o.a.Warning,"Fail called, sending the failure postmessage to IFrame"),this.Oc(m.a.Go,t)},this.yc=()=>{this.Wn.ULS.cn(596444190,s.a.X,o.a.Warning,"Fail called during single step boot, calling host failure callback..."),this.vc({errorType:O.a.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.Nc=()=>{this.Cc||(this.Wn.ULS.cn(596444191,s.a.X,o.a.Warning,"Timeout Wac Ready"),this.vc({errorType:O.a.TimeoutWacReady,errorObject:void 0}))},this.Jc=()=>{this.jc||(this.lc.timeoutCompleteOrFail=Object(h.a)(),this.Wn.ULS.cn(596444192,s.a.X,o.a.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.lc)))},this.$c=(t,e,i)=>{this.kc||(this.Wn.ULS.cn(596444193,s.a.X,o.a.Info,"SessionCompletion timed out with no ack."),this.Gc(t,e,i+1))},this.xc=t=>{if(this.lc.readyMessageReceiveTime=Object(h.a)(),this.Oc(m.a.lo,{}),this.Cc)return void this.Wn.ULS.cn(596444194,s.a.X,o.a.Info,"Received multiple ready messages - frame is already loaded.");this.Cc=!0,this.Mc=t&&t.CanAcceptStartSessionComplete;const e={AcceptStartSessionComplete:this.Mc,ParallelizeStartSession:this.Fc,StartSessionResponseAvailable:!!this.zc,WopiInfoAvailable:!!this.Sc};this.Wn.ULS.cn(596444195,s.a.X,o.a.Info,"HandleWacReadyMessage - "+JSON.stringify(e)),this.jc&&(this.Wc?this.Lc(this.Wc):this.Oc(m.a.qo,{})),this.Fc&&this.Mc?this.zc&&this.qc():this.Sc&&this.Vc(),v(this.uc,t)},this.Hc=t=>{this.kc=!0,this.lc.sessionCompleteAckReceivedTime=Object(h.a)()},this.Oc=(t,e)=>{this.Un.sendPostMessage(this.Rn,t,e)},this.Kc=(t,e)=>{this.Gc(t,e,1)},this.Gc=(t,e,i)=>{if(i>3)return void this.Wn.ULS.cn(596444224,s.a.X,o.a.Error,"Attempted to call complete, but received no ack from the frame. Time: "+Object(h.a)());this.Wn.ULS.cn(596444225,s.a.X,o.a.Info,`Sending completion message to frame. Attempt number: ${i}, Time: ${Object(h.a)()}`);const n=Object(h.a)();1===i&&(this.zc&&this.zc.Diagnostics&&(this.zc.Diagnostics.completeMessageCreateTime=n),this.lc.completeMessageCreateTime=n),e.Diagnostics.completeMessageSendTime=n,this.lc.completeMessageSendTime=n,this.Oc(t,e),window.setTimeout(()=>this.$c(t,e,i),1e3)},this.Bc=()=>{this.Wn.ULS.cn(596444226,s.a.X,o.a.Info,"Making parallelized startSession request.");const t=this.Zc(this.Sc),e="access_token="+encodeURIComponent(this.Sc.AccessToken)+"&access_token_ttl="+encodeURIComponent(F(this.Sc));this.lc.startSessionStartTime=Object(h.a)(),Object(b.a)(t,e,{"Content-Type":"application/x-www-form-urlencoded"},this.Xc)},this.Xc=t=>{if(this.lc.startSessionCompleteTime=Object(h.a)(),this.lc.startSessionResponseStatus=t.status,this.zc={StartSessionResponse:{RequestStatus:t.status,ResponseText:t.responseText},Diagnostics:{wopiPendingInitializeTime:this.lc.wopiPendingInitializeTime,wopiPendingCompleteTime:this.lc.wopiPendingCompleteTime,startSessionStartTime:this.lc.startSessionStartTime,startSessionCompleteTime:this.lc.startSessionCompleteTime,readyMessageReceiveTime:this.lc.readyMessageReceiveTime}},this.Wn.ULS.cn(596444227,s.a.X,o.a.Info,`StartSession request completed with status code: ${this.zc.StartSessionResponse.RequestStatus}, Time: ${Object(h.a)()}`),this.Cc&&this.Mc)return void this.qc();const e={WacFrameIsLoaded:this.Cc,InitializeCompleted:this.Rc};this.Wn.ULS.cn(596444228,s.a.X,o.a.Info,"StartSessionCompleted not called - "+JSON.stringify(e))},this.Vc=()=>{if(this.Rc)return;this.Rc=!0,this.Wn.ULS.cn(596444229,s.a.X,o.a.Info,"Sending wopi info to the frame.");const t={WopiDetails:{WopiSrc:this.Sc.WopiSrc,AccessToken:this.Sc.AccessToken,AccessTokenTtl:F(this.Sc)},Diagnostics:{wopiPendingInitializeTime:this.lc.wopiPendingInitializeTime,wopiPendingCompleteTime:this.lc.wopiPendingCompleteTime,readyMessageReceiveTime:this.lc.readyMessageReceiveTime}};this.Sc.WacToken&&(t.WopiDetails.WacToken=this.Sc.WacToken),this.Kc(m.a.Oo,t)},this.qc=()=>{200===this.zc.StartSessionResponse.RequestStatus?this.Rc||(this.Rc=!0,this.Kc(m.a.wo,this.zc)):this.Vc()},this.Zc=t=>{let e=this.cr.applicationBasePath+E.j;const i=W(this.cr,this.ar,!1);return e+="?"+i.substring(i.indexOf("?")+1),e=Object(n.b)(e,"WOPISrc",encodeURIComponent(t.WopiSrc)),e=Object(n.b)(e,"build",encodeURIComponent(Object(r.a)())),e=Object(n.b)(e,"WacUserType",encodeURIComponent("WOPI")),this.cr.wopiPrecheckInfo.FileGetUrl&&(e=Object(n.b)(e,"fileGetUrlPresent","1")),e},this.Tc=t=>{if(this.cr.isCreateNew){if(!t||!t.NewFilePath)return void this.Wn.ULS.cn(596444230,s.a.X,o.a.Info,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",t.NewFilePath),t.UpdatedPageTitle&&(document.title=t.UpdatedPageTitle)}},this.cr=t,this.ar=e,this.uc=t.diagnostics.AppInitDiagnostics,this.Wn=i,this.Un=c,this.hc=d,this.vc=l,Promise&&(this.Pc=new Promise(t=>this.Dc=t)),this.lc=t.diagnostics.SessionTraces,this.lc.wopiPendingInitializeTime=Object(h.a)(),this.Ec=a,Object(w.b)(),window.setTimeout(this.Jc,5e3)}}class G{Complete(t){this.cr.diagnostics.HostInitDiagnostics&&(this.cr.diagnostics.HostInitDiagnostics.hostCompleteCallTime=Object(h.a)()),this.Qc.Complete(t)}Fail(t){this.Qc.Fail(t)}Dispose(t,e,i){Object(w.a)(t||!1,this.Wn,this.Un,this.Rn,()=>{delete this.Rn,e&&e(),this.Ec(),this.Un.dispose()},void 0,i)}PostWacToken(t,e,i){this.Qc.PostWacToken(t,e,i)}Boot(){if(this.Yc)return void this.Wn.ULS.cn(595932544,s.a.H,o.a.Info,"Mobile Endpoint detected, skipping first page viewer optimization");if(this.cr.sessionInformation&&this.cr.sessionInformation.WdParams&&"1"===this.cr.sessionInformation.WdParams.wdignorefpo)return void this.Wn.ULS.cn(507561551,s.a.H,o.a.Info,"wdignorefpo request detected, skipping first page viewer optimization");this.Wn.ULS.cn(595989253,s.a.H,o.a.Info,"Boot WordViewer"),this.Un.registerMessagePayloadHandler(u.a.Ti,this.ta),this.Un.registerMessagePayloadHandler(u.a.oi,this.ea),this.Un.registerMessagePayloadHandler(u.a.Ui,this.ia);const t=this.cr.rebootOverrideData;t&&t.reason&&"translate"===t.reason.toLowerCase()?this.Wn.ULS.cn(591209105,s.a.H,o.a.Info,"Skip first page optimization"):this.cr.wopiPrecheckInfo.BundleInfo?this.sa(this.cr.wopiPrecheckInfo.BundleInfo,this.cr.container,()=>{this.oa=Object(h.a)(),this.Wn.ULS.cn(595998873,s.a.H,o.a.Info,"FirstPageFromHostLoadTime: "+this.oa),this.uc.documentLoadedTime=this.uc.documentLoadedTime||this.oa,this.Rn&&this.Rn.contentWindow&&this.na(this.Rn,this.oa)},t=>{this.ra(),this.Wn.ULS.cn(595994571,s.a.H,o.a.Warning,"Cannot load first page from cache"),this.uc.errorObject=t}):this.Wn.ULS.cn(596121033,s.a.H,o.a.Warning,"Missing Bundle Info"),window.setTimeout(this.ca,6e4)}constructor(t,e,i,n,r,c,a){this.ha=!1,this.da=!1,this.Yc=!1,this.na=(t,e)=>{this.Un.sendPostMessage(t,m.a.So,{HostCacheLoadTime:e})},this.sa=(t,e,i,n)=>{if(this.Wn.ULS.cn(595989254,s.a.H,o.a.Info,"Kick off OptimizationView"),this.cr.applicationCustomSettings&&this.cr.applicationCustomSettings.ForceAccessibilityMode)return;if(!t.Url)return void this.Wn.ULS.cn(595722645,s.a.H,o.a.Info,"Missing Url in provided Bundle Info, from host: "+this.cr.sessionInformation.HostName);const r=e.ownerDocument;if(!r)return;this.ua=r.createElement("div"),this.ua.id="FirstPageContainer",this.ua.style.left="0",this.ua.style.textAlign="center",this.ua.style.width="1px",this.ua.style.bottom="0",this.ua.style.zIndex="900",this.ua.style.height="1px",this.ua.style.position="absolute",this.ua.style.padding="0 29px",this.ua.style.right="0",this.ua.style.overflow="auto",this.ua.style.marginLeft="auto",this.ua.style.marginRight="auto",this.ua.style.maxWidth="100%",this.la?this.ua.style.top="0":this.ua.style.top="90px",e.appendChild(this.ua);const c=r.createElement("img");c.id="FirstPageImage",c.style.marginTop="11px",c.style.marginBottom="11px",c.style.maxWidth="100%",c.style.border="solid 1px #d2d5d8",c.draggable=!1,c.onload=()=>{this.Wn.ULS.cn(595989255,s.a.H,o.a.Info,"OptimizationView Loaded"),this.ua.style.width="",this.ua.style.height="",i()},c.onerror=t=>{n({errorType:O.a.CannotLoadFirstPage,errorObject:"string"==typeof t?t:t.returnValue})},c.src=t.Url.replace("{0}","p1.img"),this.ua.appendChild(c)},this.fa=()=>{if(!this.da&&this.ha&&(!this.la||this.pa&&this.ma&&this.ba)){this.Un.removeMessageHandler(u.a.Ti),this.Un.removeMessageHandler(u.a.oi),this.Un.removeMessageHandler(u.a.Ui);const t={isCore:this.la,pageCount:this.ma,currentPage:this.pa,zoomLevel:this.ba,innerApplicationFrame:this.Rn};this.hc(t),this.Wn.ULS.cn(595989256,s.a.H,o.a.Info,"Word Viewer Initialize Complete"),this.da=!0,this.Wn.ULS.flush()}},this.wa=t=>{this.Wn.ULS.cn(595986312,s.a.H,o.a.Info,"SuccessCallbackProxy called"),this.Rn=t.innerApplicationFrame,this.oa&&this.na(this.Rn,this.oa),this.ra();const e=this.uc.documentLoadedTime;e&&this.oa&&this.oa<e?(this.uc.documentLoadedTime=this.oa,this.uc.documentLoadedFromWopiPrecheckInfo=!0,this.Wn.ULS.cn(595994572,s.a.H,o.a.Info,"First page load from cache was faster")):this.uc.documentLoadedFromWopiPrecheckInfo=!1,this.Oa(),this.ha=!0,this.Wn.ULS.cn(595986313,s.a.H,o.a.Info,"WordViewerInitializer received wac complete message"),this.fa(),this.Wn.ULS.flush()},this.ga=t=>{this.Wn.ULS.cn(595972122,s.a.H,o.a.Error,"FailureCallbackProxy called"),this.da=!0,this.vc(t)},this.ra=()=>{this.ua&&this.ua.parentElement&&this.ua.parentElement.removeChild(this.ua)},this.ca=()=>{if(!this.da){this.lc.timeoutAppInitialize=Object(h.a)();const t="Didn't receive app initialize post messages. {'appComplete': "+this.ha+", 'currentPage': "+(void 0!==this.pa)+", 'zoomLevel': "+(void 0!==this.ba)+", 'pageCount': "+(void 0!==this.ma)+"}";this.Wn.ULS.cn(596120771,s.a.H,o.a.Warning,t)}},this.ta=t=>{if(!t||"number"!=typeof t.pageCount)throw new TypeError("values: PageCount not found");this.ma=t.pageCount,this.Oc(m.a.Xo,{}),this.fa()},this.ea=t=>{if(!t||"number"!=typeof t.newPage)throw new TypeError("values: CurrentPage not found");this.pa=t.newPage,this.Oc(m.a.Co,{}),this.fa()},this.ia=t=>{if(!t||"number"!=typeof t.newLevel)throw new TypeError("values: ZoomLevel not found");this.ba=t.newLevel,this.Oc(m.a.Qo,{}),this.fa()},this.Oa=()=>{this.pa&&this.Oc(m.a.Co,{}),this.ma&&this.Oc(m.a.Xo,{}),this.ba&&this.Oc(m.a.Qo,{})},this.Oc=(t,e)=>{this.Rn&&this.Rn.contentWindow?this.Un.sendPostMessage(this.Rn,t,e):this.Wn.ULS.cn(595955717,s.a.H,o.a.Info,"Attempted to send WordViewer postmessage: "+t)},this.cr=t,this.uc=t.diagnostics.AppInitDiagnostics,this.Wn=i,this.Un=n,this.lc=t.diagnostics.SessionTraces,this.Ec=r;const d=window.navigator.userAgent;d.indexOf("Mobi")>=0&&d.indexOf("iPad")<0&&(this.Yc=!0),this.hc=c,this.vc=a,this.va=this.Yc?c:this.wa,this.ja=this.Yc?a:this.ga,this.la=!(!this.cr.applicationCustomSettings||!this.cr.applicationCustomSettings.IsCore),this.cr.sessionInformation&&this.cr.sessionInformation.WdParams&&(this.cr.applicationCustomSettings&&this.cr.applicationCustomSettings.ForceAccessibilityMode?this.cr.sessionInformation.WdParams.wdAccPdf="1":this.la&&(this.cr.sessionInformation.WdParams.wdAccPdf="0")),this.Qc=new $(this.cr,e,i,n,r,this.va,this.ja)}}class z{registerEventHandler(t){this.Pn.push(t)}removeEventHandler(t){if(t){const e=this.Pn.indexOf(t);this.Pn.splice(e,1)}}stop(){document.removeEventListener("visibilitychange",this.Sa)}getVisibilityChangeEvents(){return this.Ia}dispose(){this.stop(),this.Pn=[],this.Ia=[]}constructor(){if(this.Ia=[],this.Pn=[],this.Sa=()=>{const t={visibility:document.visibilityState,time:Object(h.a)(),initialState:!1};this.Ia.push(t);for(const e of this.Pn)e&&e(t)},"hidden"===document.visibilityState){const t={visibility:document.visibilityState,time:Object(h.a)(),initialState:!0};this.Ia.push(t)}document.addEventListener("visibilitychange",this.Sa)}}class q{GetVersion(){return Object(r.a)()}GetMinContentVersion(){throw new Error("Not implemented")}Prefetch(t){if(null!=t&&void 0!==t){const e=document.createElement("link");e.rel="prefetch";let i=t.BootstrapperUrl;".js"!==i.toString().slice(-3)&&(i+=".js"),e.href=i;const s=document.getElementsByTagName("head")[0];null!=s&&void 0!==s&&s.appendChild(e)}}InitializeWopiPending(t,e,i,r,m,b){let w,v,C,T,W=!1;try{i?v=i:[v,C]=Object(c.a)(),Object(a.c)(Object(g.d)(t.ApplicationUrl,v),g.a,"init");const O=Object(h.a)();let F;!function(t){if(void 0===t)throw new TypeError("initParams");const e=t.Container;if(void 0===e||void 0===e.appendChild)throw new TypeError("Container");const i=t.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");const s=t.ApplicationUrl;if(void 0===s||"string"!=typeof s)throw new TypeError("ApplicationUrl");const o=t.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===t.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===t.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(t),t.ApplicationUrl=Object(n.v)(t.ApplicationUrl,Object(n.k)(t.ApplicationUrl,"region")),t.ApplicationUrl=Object(n.x)(t.ApplicationUrl,"region"),function(t){const e=t.RebootOverrideData;if(e){let i=e.mode;i&&(i=i.toLowerCase(),"view"===i&&Object(E.d)(t.ApplicationUrl)?t.ApplicationUrl=Object(E.f)(t.ApplicationUrl):"edit"===i&&Object(E.e)(t.ApplicationUrl)&&(t.ApplicationUrl=Object(E.g)(t.ApplicationUrl)))}}(t),w=e||Object(d.a)({remoteUlsEndpoint:Object(g.b)(t.ApplicationUrl)+n.u,sessionId:v}),T=Object(g.c)(t,v,w,m,b,this._a.forceSingleStepBoot),b||(T.je.addSettingsChangeListener(w.settingsChangeHandler),T.je.initializePeriodicFetch(T.applicationBasePath,v)),T.diagnostics.HostInitDiagnostics&&(T.diagnostics.HostInitDiagnostics.hostInitializeCallTime=O),I(w,T,C),W=!0;const M=t.BootstrapperUrl;M&&(F=this.Ca(M,w));const k=()=>{T.je.dispose(),T.pageStateObserver.dispose(),window.clearInterval(F)},N=Object(n.i)(t.ApplicationUrl),H=r||new x(N,w),D=new z,V=function(t,e){let i={isSingleStepBoot:t.forceSingleStepBoot,bootFlowType:t.forceSingleStepBoot?_.forceSingleStepBoot:_.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(t.forceSingleStepBoot){const s=t.applicationUrl,o=Object(E.e)(s),r=Object(n.p)(s,"uiembed"),c=Object(n.p)(s,"embed");t.canSupportInteractiveReadOnly=P(t,r,c,e),R(t,o,e)?i={isSingleStepBoot:!0,bootFlowType:_.wordMobileUnifiedReadRedirect,ignoreWacFramePostMessages:!1}:U(t,o,e)&&(i={isSingleStepBoot:!0,bootFlowType:_.wordViewToUnifiedReadRedirect,ignoreWacFramePostMessages:!1})}else i=function(t,e){const i=t.applicationUrl,r=Object(E.d)(i),c=Object(E.e)(i),a=Object(n.p)(i,"uiembed"),h=Object(n.p)(i,"embed");return e.ULS.cn(595640900,s.a.X,o.a.Info,`gotUiEmbedUrl:${a}, gotEditUrl:${r}, gotViewUrl:${c}`),!r&&t.wopiPrecheckInfo.IrmEnabled?{isSingleStepBoot:!0,bootFlowType:a?_.wordUiEmbedIrmEnabledEarlyRedirect:_.unifiedIrmEnabled,ignoreWacFramePostMessages:!1}:(t.canSupportInteractiveReadOnly=P(t,a,h,e),R(t,c,e)?{isSingleStepBoot:!0,bootFlowType:_.wordMobileUnifiedReadRedirect,ignoreWacFramePostMessages:!1}:U(t,c,e)?{isSingleStepBoot:!0,bootFlowType:_.wordViewToUnifiedReadRedirect,ignoreWacFramePostMessages:!1}:r?(e.ULS.cn(575980770,s.a.X,o.a.Info,"readOnly:"+t.wopiPrecheckInfo.ReadOnly),t.wopiPrecheckInfo.ReadOnly&&a?{isSingleStepBoot:!0,bootFlowType:_.wordUiEmbedReadOnlyEarlyRedirect,ignoreWacFramePostMessages:!1}:!function(t){return t.je.getValue(A.a.Ns,!1)?null==t.wopiInfo||null==t.wopiInfo.WopiSrc||""===t.wopiInfo.WopiSrc:null==t.wopiInfo}(t)||Object(y.e)()?{isSingleStepBoot:!0,bootFlowType:_.unifiedSingleFlush,ignoreWacFramePostMessages:!1}:{isSingleStepBoot:!1,bootFlowType:_.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1}):{isSingleStepBoot:!0,bootFlowType:c?_.unifiedViewActionUrl:_.unifiedNotEditOrViewActionUrl,ignoreWacFramePostMessages:!c})}(t,e);if(i.isSingleStepBoot){const n={singleStepBootIsRequired:!0,singleStepBootReason:i.bootFlowType,irmEnabled:t.wopiPrecheckInfo.IrmEnabled,readOnly:t.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:i.ignoreWacFramePostMessages};e.ULS.cn(596444182,s.a.X,n.irmEnabled?o.a.Warning:o.a.Info,JSON.stringify(n))}else e.ULS.cn(596444183,s.a.X,o.a.Info,"Received input valid for two step flow");return i}(T,w),B=function(t,e,i,n,r,c,h){return d=>{const u=t.diagnostics;S(u,n),j(u.SessionTraces,i,o.a.Info);const l=Z(u);i.ULS.cn(596448985,s.a.X,o.a.Important,JSON.stringify(l)),Object(a.c)(t.remoteTelemetryUrl,g.a,"bootSuccess");const m=h(t.sessionId,i,e,r,d);try{c(m,l)}catch(t){i.ULS.cn(595719171,s.a.X,o.a.Error,"Exception thrown from host's success callback: "+Object(f.b)(t))}Object(p.f)("word",i),K(i)}}(T,H,w,D,k,t.FnOnInitializeSuccess,this.Ta),L=function(t,e,i,n){return r=>{const c=t.diagnostics;S(c,i),j(c.SessionTraces,e,o.a.Warning);const h=Z(c);e.ULS.cn(596448986,s.a.X,o.a.Error,JSON.stringify({error:r,appInitDiagnostics:h})),Object(a.c)(t.remoteTelemetryUrl,g.a,"bootFailure");try{n(r,h)}catch(t){e.ULS.cn(595719172,s.a.X,o.a.Error,"Exception thrown from host's failure callback: "+Object(f.b)(t))}Object(p.f)("word",e),K(e)}}(T,w,D,t.FnOnInitializeFailure);t.FnOnAppModeSwitched&&H.registerMessagePayloadHandler(u.a.Ye,t.FnOnAppModeSwitched);{const e="Microsoft Teams"===t.SessionInformation.HostName,i=[_.unifiedViewActionUrl,_.wordUiEmbedReadOnlyEarlyRedirect,_.wordUiEmbedIrmEnabledEarlyRedirect];if(e||this._a.useViewerInitializer||i.includes(V.bootFlowType)){!this._a.useViewerInitializer&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"}),(V.bootFlowType===_.wordUiEmbedReadOnlyEarlyRedirect||e)&&(T.applicationUrl=Object(E.f)(T.applicationUrl,!0)),V.bootFlowType!==_.wordViewToUnifiedReadRedirect&&V.bootFlowType!==_.wordMobileUnifiedReadRedirect||(w.ULS.cn(506585945,s.a.X,o.a.Info,"Redirecting Viewer request to unified read : "+V.bootFlowType),T.applicationUrl=Object(E.g)(T.applicationUrl)),T.sessionInformation.HideViewerToolbar&&(T.applicationCustomSettings?T.applicationCustomSettings.IsCore=!0:T.applicationCustomSettings={IsCore:!0},delete T.sessionInformation.HideViewerToolbar);const i=new G(T,V,w,H,k,B,L);return i.Boot(),i}V.bootFlowType!==_.wordViewToUnifiedReadRedirect&&V.bootFlowType!==_.wordMobileUnifiedReadRedirect||(w.ULS.cn(578324612,s.a.X,o.a.Info,"Redirecting Viewer request to unified read : "+V.bootFlowType),T.applicationUrl=Object(E.g)(T.applicationUrl))}t.WopiPrecheckInfo.ReadOnly&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"});const J=Object(n.k)(T.applicationUrl,"uih");if(M&&this._a.preconnector&&this._a.preconnector.shouldPreconnect(J)&&this._a.preconnector.preconnect(M),M&&this._a.preloader&&this._a.preloader.shouldPreload(T.applicationUrl))try{let t=M;T.featureManager.isFeatureEnabled(l.a.ln)&&(w.ULS.cn(595645891,s.a.X,o.a.Info,"HTTP2 preload enabled"),t=Object(n.w)(M));let e=T.sessionInformation.UiLocale;e||(e=decodeURIComponent(Object(n.k)(T.applicationUrl,"ui"))),this._a.preloader.preload(t,e,w,T.featureManager)}catch(t){w.ULS.cn(595943884,s.a.X,o.a.Error,"Error preloading")}const q=new $(T,V,w,H,k,B,L);return q.Boot(),q}catch(e){return w&&(w.ULS.cn(596459925,s.a.X,o.a.Error,`${O.a.AppInitError}: ${Object(f.b)(e)}`),W||I(w,T||Object(g.c)(t,v,w,m,b,this._a.forceSingleStepBoot),C),w.ULS.flushOnClose()),void(t&&(t.ApplicationUrl&&Object(a.c)(Object(g.d)(t.ApplicationUrl,v),g.a,"bootException"),t.FnOnInitializeFailure&&t.FnOnInitializeFailure({errorType:O.a.AppInitError,errorObject:e})))}}constructor(t,e){this.Ca=(t,e)=>window.setInterval(()=>{this.Prefetch({BootstrapperUrl:t}),e.ULS.cn(595895774,s.a.X,o.a.Info,"Prefetching "+Object(n.j)(t))},36e5),this.Ta=t,this._a=e}}function K(t){t.ULS.cn(590914655,s.a.X,o.a.Info,"Time spent logging: "+t.getTimeSpentLogging())}function Z(t){return{...t.AppInitDiagnostics,...t.HostInitDiagnostics,SessionTraces:t.SessionTraces}}},,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var s=i(7),o=i(16),n=i(0),r=i(1),c=i(27),a=i(3),h=i(12);class d extends c.a{SetCurrentPage(t){this.ya?this.Aa({errorType:h.a.ApiDisabledError,errorObject:{isCoreMode:this.la}}):(this.Ea=t,this.Un.sendPostMessage(this.Rn,o.a.Jo,{newPage:this.Ea}),window.setTimeout(()=>{this.Ea!==this.Pa&&this.Wn.ULS.cn(596444179,n.a.H,r.a.Info,'Did not receive the page change update. {"RequestedPage": '+this.Ea+', "CurrentPage": '+this.Pa+"}")},5e3))}GetPageCount(){return this.ya&&this.Aa({errorType:h.a.ApiDisabledError,errorObject:{isCoreMode:this.la}}),this.ma}GetCurrentPage(){return this.ya&&this.Aa({errorType:h.a.ApiDisabledError,errorObject:{isCoreMode:this.la}}),this.Pa}SetZoomLevel(t){this.ya?this.Aa({errorType:h.a.ApiDisabledError,errorObject:{isCoreMode:this.la}}):(this.Ua=Number(t.toFixed(2)),this.Un.sendPostMessage(this.Rn,o.a.$o,{newLevel:this.Ua}),window.setTimeout(()=>{this.Ua!==this.ba&&this.Wn.ULS.cn(596444180,n.a.H,r.a.Info,'Did not receive the zoom change update. {"RequestedZoom": '+this.Ua+', "CurrentZoom": '+this.ba+"}")},5e3))}GetZoomLevel(){return this.ya&&this.Aa({errorType:h.a.ApiDisabledError,errorObject:{isCoreMode:this.la}}),this.ba}GetIsDisabled(){return this.ya}GetApplicationType(){return"Word Viewer"}RegisterEventHandler(t,e){switch(t){case a.a.ZoomChanged:case a.a.PageChanged:case a.a.IsDisabled:if(this.Pn[t])throw new Error("Duplicate registration");this.Pn[t]=e;break;default:this.Un.registerMessagePayloadHandler(t,e)}}RemoveEventHandler(t,e){switch(t){case a.a.ZoomChanged:case a.a.PageChanged:case a.a.IsDisabled:if(this.Pn[t]!==e)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Pn[t];break;default:this.Un.removeMessageHandler(t)}}RegisterErrorHandler(t){this.Ra=t}RemoveErrorHandler(t){if(this.Ra!==t)throw new Error("The handler requested to be removed does not exist");delete this.Ra}constructor(t,e,i,o,n){super(t,e,i,o,n),this.Aa=t=>{const e={errorType:t.errorType,errorObject:t.errorObject};if(!e.errorType||!e.errorObject)throw new TypeError("Error object is missing errorType or errorObject");this.Ra&&this.Ra(e)},this.Wa=t=>{this.ba=t.newLevel,this.Mn(a.a.ZoomChanged,t)},this.Fa=t=>{this.Pa=t.newPage,this.Mn(a.a.PageChanged,t)},this.Ma=t=>{this.ya=t.isDisabled,this.Mn(a.a.IsDisabled,t)},this.Rn=n.innerApplicationFrame,this.Un=i,this.Wn=e,this.Pn={},this.la=n.isCore,this.Pa=n.currentPage,this.ba=n.zoomLevel,this.ma=n.pageCount,this.ya=!this.la,this.Un.registerMessagePayloadHandler(s.a.Ui,this.Wa),this.Un.registerMessagePayloadHandler(s.a.oi,this.Fa),this.Un.registerMessagePayloadHandler(s.a.Je,this.Ma),this.Un.registerMessagePayloadHandler(s.a.xe,this.Aa)}}function u(t,e,i,s,o){return new d(t,e,i,s,o)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return wt}));var s=i(81),o=i(7),n=i(51),r=i(0),c=i(1);const a=(t,e,i,s,a)=>t!==o.a.ci?Promise.reject("Wrong flow"):new Promise(t=>{i.pendingReboot=!0;let s=void 0;if(e.queryOverrides)try{s=JSON.parse(e.queryOverrides)}catch(t){i.logger.ULS.cn(592217694,r.a.X,c.a.Error,"Failed to parse queryOverrides: "+s)}i.raiseEvent(n.a.Reboot,{...e,previousSessionId:i.sessionId,queryOverrides:s}),t({completion:"success"})});var h=i(39),d=i(16);function u(t){return!(!(t&&t.source&&t.accessToken)||!t.expiry&&0!==t.expiry)}var l=i(84),f=i(28),p=i(55),m=i(20),b=i(42),w=i(56),O=i(5),g=i(8),v=i(18),j=i(9);function S(t){var e;const i={};Object(O.a)(i,"jsapi","1"),Object(O.a)(i,"jsapiver","v2"),Object(O.a)(i,"corrid",t.sessionId),Object(O.a)(i,"usid",t.sessionId),Object(O.a)(i,"newsession","1"),Object(O.a)(i,"sftc","1"),t.hostSessionId&&Object(O.a)(i,"hid",encodeURIComponent(t.hostSessionId));const s=t.host;s.uiHostName&&Object(O.a)(i,"uih",s.uiHostName),s.uiHostIntegrationType&&Object(O.a)(i,"uihit",encodeURIComponent(s.uiHostIntegrationType)),s.metaUiHostVersion&&Object(O.a)(i,"muv",encodeURIComponent(s.metaUiHostVersion)),s.topOrigin&&Object(O.a)(i,"to",encodeURIComponent(s.topOrigin)),s.isDeeplyNestedAuthSupportedInTeams&&Object(O.a)(i,"dnaa","1");const o=s.capabilities;o&&(o.accessibilityLoop&&Object(O.a)(i,"accloop","1"),o.rebootDoc&&Object(O.a)(i,"sdr",o.rebootDoc.toString()),o.createNewDoc&&Object(O.a)(i,"scnd","1"),o.authToken&&Object(O.a)(i,"sat","1"),window.docAspxMsalEnabled&&"onedrivecom"!==s.uiHostName&&(o.authTokenStrategy="PairwiseBroker"),o.authTokenStrategy&&Object(O.a)(i,"ats",o.authTokenStrategy),o.customAuthConfig&&Object(O.a)(i,"cac","1"),o.refreshAccessToken&&Object(O.a)(i,"rat","1"),o.atMentions&&Object(O.a)(i,"sams","1"),o.moveToFolder&&Object(O.a)(i,"mtf","1"),o.noBrowserModalDialogs&&Object(O.a)(i,"nbmd","1"),o.commonFilePicker&&Object(O.a)(i,"sfp","1"),o.directDownload&&Object(O.a)(i,"sdd","1"),o.directPrint&&Object(O.a)(i,"sdp","1"),o.disableOfficeAddins&&Object(O.a)(i,"doa","1"));const n=t.ui;n.language&&Object(O.a)(i,"ui",encodeURIComponent(n.language)),n.uiEmbed&&Object(O.a)(i,"uiembed","1"),(n.hideHeader||"DocGen"===n.contentAssemblyMode||"Templatization"===n.contentAssemblyMode||"ContentAssemblyEdit"===n.contentAssemblyMode||"ContentAssemblyView"===n.contentAssemblyMode)&&Object(O.a)(i,"hhdr","1"),n.highContrast&&Object(O.a)(i,"hcm",encodeURIComponent(n.highContrast)),n.hideFileLocationPicker&&Object(O.a)(i,"hodflp","1"),n.hideAppLauncherInHeader&&Object(O.a)(i,"halh","1"),n.hideChatInHeader&&Object(O.a)(i,"hch","1"),n.hideMeInHeader&&Object(O.a)(i,"hmh","1"),n.hideSearchInHeader&&Object(O.a)(i,"hsh","1"),n.hideWorkflowInHeader&&Object(O.a)(i,"hwfh","1"),n.hideSettingsInHeader&&Object(O.a)(i,"hsth","1"),n.showAppIconInHeader&&Object(O.a)(i,"sih","1"),n.useNeutralColorInHeader&&Object(O.a)(i,"unh","1"),n.openLinksInNewWindow&&Object(O.a)(i,"onw","1"),n.useDarkTheme&&Object(O.a)(i,"udt","1"),"DocGen"!==n.contentAssemblyMode&&"ContentAssemblyView"!==n.contentAssemblyMode||Object(O.a)(i,"readOnly","1");const r=t.wopi;r&&r.source&&Object(O.a)(i,"wopisrc",encodeURIComponent(r.source));const c=t.bootParams;c&&(c.dataLanguage&&Object(O.a)(i,"rs",encodeURIComponent(c.dataLanguage)),c.readOnly&&(Object(O.a)(i,"readonly","1"),Object(O.a)(i,"mode","Read")),c.disableChat&&Object(O.a)(i,"dchat","1"),c.cookieCompliant&&Object(O.a)(i,"mscc","1"),c.isNewFile&&(Object(O.a)(i,"new","1"),c.isFromHostTemplate&&Object(O.a)(i,"wdtpl","fromhost"))),t.user.isLicensed&&Object(O.a)(i,"islicenseduser","1"),t.user.isSynthetic&&Object(O.a)(i,"syn","1"),t.actNavId&&Object(O.a)(i,"actnavid",t.actNavId),t.sessionContext&&Object(O.a)(i,"sc",encodeURIComponent(t.sessionContext));const a=t.wdParams;if(a)for(const t in a)Object(O.a)(i,t,a[t]);const h=t.preseededSession;h&&(h.key&&Object(O.a)(i,"preseededsessionkey",encodeURIComponent(h.key)),h.id&&Object(O.a)(i,"preseededwacsessionid",encodeURIComponent(h.id)));const d=t.throttling;d&&(d.protection&&Object(O.a)(i,"ctp",d.protection),d.request&&Object(O.a)(i,"rct",d.request));const u=t.hostInitDiagnostics;u&&(u.entryPoint&&Object(O.a)(i,"wdorigin",encodeURI(u.entryPoint)),u.userClickTime&&Object(O.a)(i,"wdhostclicktime",u.userClickTime.toString()));const l=t.rebootOverride;return l&&l.previousSessionId&&Object(O.a)(i,"wdprevioussession",l.previousSessionId),Object(O.r)(i,"region"),null!==(e=t.bootParams)&&void 0!==e&&e.afdFlighting&&Object(O.a)(i,"afdflight",Math.floor(100*Math.random()+1).toString()),i}function I(t,e,i){let s={...Object(O.s)(t.appUrl),...S(t),...i};const o=t.rebootOverride;return o&&o.queryOverrides&&(s={...s,...o.queryOverrides}),Object(O.d)(t.appBasePath,e,s)}var _=i(15),C=i(41),T=i(54),y=i(43),A=i(44),E=i(17),P=i(57),U=i(14);const R=(t,e,i,s,n)=>t!==h.a.boot?Promise.reject("Wrong flow"):new Promise(t=>{const a=Object(_.a)();i.state=f.a.Booting,i.pendingReboot=!1,function(t,e,i=!1){if(!t)throw new TypeError("SessionBootParams");const s=t.appUrl,o=t.appBaseUrl;if(!s&&!o)throw new TypeError("Either appUrl or appBaseUrl should exist");if(s&&"string"!=typeof s)throw new TypeError("AppUrl");if(o&&"string"!=typeof o)throw new TypeError("AppBaseUrl");const n=t.file;if(!n||!i&&!n.name)throw new TypeError("FileInfo");const r=t.container;if(!r||!(r instanceof l.a)&&!r.appendChild)throw new TypeError("Container");if(!e&&!u(t.wopi))throw new TypeError("WopiInfo")}(e,i.skipWopiValidation,i.skipFileNameCheck),i.intent=e.intent,i.file=e.file,i.customFontCatalogUrl=e.customFontCatalogUrl,i.wopi=e.wopi,i.contentBundle=e.contentBundle,i.newFileTemplate=e.newFileTemplate,i.ownerId=e.ownerId,i.sessionContext=e.sessionContext,i.actNavId=e.actNavId,i.preseededSession=e.preseededSession,i.throttling=e.throttling,i.meeting=e.meeting,i.tenantId=e.tenantId,i.wdParams=function(t){var e;return function(t,e){const i={};return e&&Object.keys(e).forEach(t=>{i[t.toLowerCase()]=e[t]}),t.split("&").forEach(t=>{if(/^wd\w+=.+/i.test(t)){const e=t.split("=");i[e[0].toLowerCase()]=e[1]}}),i}((null===(e=window.location.search)||void 0===e?void 0:e.substring(1))||"",t)}(e.wdParams),i.pinnedTarget=e.pinnedTarget,i.rebootOverride=e.rebootOverride,i.bootParams=e.bootParams||{},i.hostInitDiagnostics={...e.diagnostics,hostInitializeCallTime:a};let h=!1;const S=i.preseededSession;i.appInfo.usePreseededSessionId&&S&&S.id&&(i.sessionId=S.id,h=!0);let R=!1;const W=e.hostGeneratedSessionId;if(!h&&W&&(i.sessionId=W,R=!0),i.je.getValue(U.a.ks,!1)&&Object(C.a)(i.hostInitDiagnostics),e.appUrl){const t=e.appUrl;i.appUrl=t;const s=i.bootParams;if(Object(O.p)(t,"new")&&(s.isNewFile=!0),!s.dataLanguage){const e=Object(O.l)(t,"rs");e&&(s.dataLanguage=e)}const o=i.ui;if(Object(O.p)(t,"uiembed")&&(o.uiEmbed=!0),!o.language){const e=Object(O.l)(t,"ui");e&&(o.language=e)}if(!i.hostInitDiagnostics.entryPoint){const e=Object(O.l)(t,"wdorigin");e&&(i.hostInitDiagnostics.entryPoint=e)}if(!i.host.uiHostName){const e=Object(O.l)(t,"uih");e&&(i.host.uiHostName=e)}}else i.appUrl="";let F;if(i.appBaseUrl=e.appBaseUrl?e.appBaseUrl.toLowerCase():Object(O.i)(e.appUrl).toLowerCase(),i.appBaseUrl=Object(O.v)(i.appBaseUrl,Object(O.k)(i.appUrl,"region")),i.je.updateEnvironment(i.appBaseUrl),s.initializeAppContext(i,t,e),i.appBasePath=s.buildAppBasePath(i),e.rebootOverride&&(h||R||([i.sessionId,F]=Object(T.a)()),i.pageStateObserver=new y.a(i.logger,!0),i.authTokenTrustValidator=new A.a(i.logger)),i.logger.ULS.cn(38580693,r.a.X,c.a.Info,`User session id: ${i.sessionId}, is preseeded: ${h}, is host generated: ${R}`),i.remoteTelemetryUrl=s.buildRemoteTelemetryUrl(i),Object(p.c)(i.remoteTelemetryUrl,i.appInfo.name,"init"),!i.isLoggerFromOwl){let t=i.je.getValue(U.a.Ms,"").toString();t||(t=Object(O.f)(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:t,sessionId:i.sessionId})}if(i.je.initializePeriodicFetch(i.appBasePath,i.sessionId),F&&i.logger.ULS.cn(590966790,r.a.X,c.a.Info,JSON.stringify(F)),Object(C.e)(i),s.onContextReady&&s.onContextReady(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:Object(v.a)(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",()=>{i.appInitDiagnostics.documentLoadedWithTabSwitch=!0},{once:!0}),!i.container){const t=e.container;i.container=t instanceof l.a?t:i.application.createContainer(t)}i.container.setMessageHandler(i.onMessage);const M=!!s.ignoreCompletionMessage&&s.ignoreCompletionMessage(i),k=(t,e)=>{i.successTime=Object(_.a)(),M||(i.container.postMessage(d.a.bo,void 0),Object(C.b)(i.appInitDiagnostics,e.Diagnostics)),i.je.addSettingsChangeListener(i.logger.settingsChangeHandler),s.onSuccess&&s.onSuccess(i,e),i.logger.ULS.cn(596448985,r.a.X,c.a.Important,JSON.stringify(i.diagnostics)),Object(p.c)(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(d.a._o,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=f.a.Booted,x({completion:"success"}),Object(C.f)(i.appInfo.name,i.logger)},N=(t,e)=>{var o;i.failureTime=Object(_.a)(),s.onFailure&&s.onFailure(i,e.Error),i.logger.ULS.cn(596448986,r.a.X,c.a.Error,JSON.stringify({error:e.Error,diagnostics:i.diagnostics})),Object(p.c)(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=f.a.Failed,x({completion:"failure",error:e.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(o=i.appInitDiagnostics)||void 0===o?void 0:o.documentLoadedWithTabSwitch}),Object(C.f)(i.appInfo.name,i.logger)},x=e=>{M||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(o.a.Ae,k),i.removeActionHandler(o.a.Te,N)),t(e)};n&&n.subscribe(()=>{var t;x({completion:n.reason||"cancelled",documentLoadedWithTabSwitch:null===(t=i.appInitDiagnostics)||void 0===t?void 0:t.documentLoadedWithTabSwitch})}),M||(i.addActionHandler(o.a.Ae,k),i.addActionHandler(o.a.Te,N)),function(t){return"wdjs"in t||"wd1js"in t}(i.wdParams)&&("true"!==window.sessionStorage.getItem("sideLoadingIsEnabled")?Object(E.d)("sideLoadingIsEnabled","false",0):Object(E.a)("sideLoadingIsEnabled",!1)||Object(E.d)("sideLoadingIsEnabled","true",1));const H=s.buildBootRequestParams(i),D=I(i,H.appPageName,H.queryParamsOverrides),V=function(t,e){const i=function(t){const e={};Object(O.a)(e,"highdpi",String(window.devicePixelRatio>1.24)),Object(O.a)(e,"softblockedbrowser",String(Object(g.g)())),Object(O.a)(e,"hostname",t.hostName),Object(O.a)(e,"feature_status",Object(b.b)(t.featureManager,t.wdParams)),Object(O.a)(e,"jsapibuild",Object(v.a)());const i=t.wopi;i&&(Object(O.a)(e,"access_token",i.accessToken),Object(O.a)(e,"access_token_ttl",i.expiry.toString()),i.wacToken&&Object(O.a)(e,"wac_token",i.wacToken));const s=t.customFontCatalogUrl;s&&Object(O.a)(e,"customfontcatalogurl",s);const o=t.contentBundle;if(o){if(o.url){Object(O.a)(e,"bundlesrc",o.url);const i=o.staleness,s=null!=i;s&&Object(O.a)(e,w.a.pr,i.toString()),t.logger.ULS.cn(577783775,r.a.X,c.a.Info,"Content bundle staleness: "+(s?i:"N/A"))}o.bundleUrlNoAuth&&Object(O.a)(e,"bundleurlnoauth",o.bundleUrlNoAuth),o.bundleCode&&Object(O.a)(e,"bundlecode",o.bundleCode)}const n=t.file,a=n.name;if(a){Object(O.a)(e,"filename",a);const t=Object(j.a)(a);t&&Object(O.a)(e,"fileextension",t)}n.getUrl&&Object(O.a)(e,"filegeturl",n.getUrl),n.downloadCode&&Object(O.a)(e,"filedownloadcode",n.downloadCode),n.urlNoAuth&&Object(O.a)(e,"fileurlnoauth",n.urlNoAuth),n.size&&Object(O.a)(e,"filesize",n.size.toString()),n.eTag&&Object(O.a)(e,"etag",n.eTag),n.cTag&&Object(O.a)(e,"revid",n.cTag),n.uniqueId&&Object(O.a)(e,"docid",n.uniqueId),void 0!==n.immutableReason&&Object(O.a)(e,"immutableReason",n.immutableReason.toString()),void 0!==n.supportsZipIt&&Object(O.a)(e,"supports_zipit",n.supportsZipIt.toString());const h=t.newFileTemplate;h&&(h.getUrl&&Object(O.a)(e,"templateurl",h.getUrl),h.size&&Object(O.a)(e,"filesize",h.size.toString()),h.eTag&&Object(O.a)(e,"etag",h.eTag),h.uniqueId&&Object(O.a)(e,"docid",h.uniqueId)),t.user.id&&Object(O.a)(e,"user_id",t.user.id),t.ownerId&&Object(O.a)(e,"owner_id",t.ownerId),t.sessionContext&&Object(O.a)(e,"sc",t.sessionContext);const d=t.ui;d.controls&&Object(O.a)(e,"huictrls",JSON.stringify(d.controls)),"Templatization"!==d.contentAssemblyMode&&"DocGen"!==d.contentAssemblyMode&&"ContentAssemblyEdit"!==d.contentAssemblyMode&&"ContentAssemblyView"!==d.contentAssemblyMode||Object(O.a)(e,"caae","1"),d.contentAssemblyMode&&Object(O.a)(e,"caaemode",d.contentAssemblyMode);const u=t.meeting;u&&(u.id&&Object(O.a)(e,"meetingId",u.id),u.title&&Object(O.a)(e,"meetingTitle",u.title),u.type&&Object(O.a)(e,"meetingType",u.type),u.scheduledStartTime&&Object(O.a)(e,"scheduledStartTime",u.scheduledStartTime),u.scheduledEndTime&&Object(O.a)(e,"scheduledEndTime",u.scheduledEndTime),u.isPresenter&&Object(O.a)(e,"isPresenter",u.isPresenter.toString()),u.organizerId&&Object(O.a)(e,"meetingOrganizerId",u.organizerId),u.joinUrl&&Object(O.a)(e,"meetingJoinUrl",encodeURIComponent(u.joinUrl)),u.isMeetingTeamsRoom&&Object(O.a)(e,"isMeetingTeamsRoom",u.isMeetingTeamsRoom.toString()));const l=t.host;l.owlVersion&&Object(O.a)(e,"owlver",l.owlVersion),l.owlRollout&&Object(O.a)(e,"owlro",l.owlRollout);const f=l.capabilities;return f&&(f.supportsInPlaceCreateNew&&Object(O.a)(e,"sipcn",f.supportsInPlaceCreateNew.toString()),f.disableEmbedViewCodeSnippet&&Object(O.a)(e,"devcs","1"),f.disableCoEditInTeams&&Object(O.a)(e,"dceit","1")),e}(t);return Object.keys(e).forEach(t=>{e[t]?i[t]=e[t]:delete i[t]}),i}(i,H.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(D,i.host.origin,i))try{s.beforePreload&&s.beforePreload(i);let t=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(m.a.ln)&&(i.logger.ULS.cn(590966791,r.a.X,c.a.Info,"HTTP2 preload enabled"),t=Object(O.w)(t)),i.preloader.preload(t,i.ui.language,i.logger,i.featureManager)}catch(t){i.logger.ULS.cn(590966792,r.a.X,c.a.Error,"Error preloading")}s.beforeContainerBoot&&s.beforeContainerBoot(i,D),i.container.boot(D,V,i.logger,s.buildContainerBootParams(i),()=>{i.appInitDiagnostics.officeFrameCreateTime=Object(_.a)(),i.appBootState="FrameCreated"},()=>{i.appInitDiagnostics.officeFrameLoadTime=Object(_.a)(),i.logger.ULS.cn(506012820,r.a.X,c.a.Important,"Frame loaded"),"FrameCreated"===i.appBootState&&(i.appBootState="FrameLoaded",i.bootHeartBeat&&i.bootHeartBeat.setTimeoutStage(i.appBootState))},()=>{i.appInitDiagnostics.officeFrameErrorTime=Object(_.a)(),i.logger.ULS.cn(506012819,r.a.X,c.a.Error,"Frame error"),i.bootHeartBeat&&i.bootHeartBeat.setFrameError()}),M?k(o.a.Ae,{Diagnostics:{bootSuccessWithoutCompletionMessage:!0}}):(i.bootHeartBeat=new P.a(Object(O.n)(i.appBaseUrl),i.je,i.logger,()=>{i.timeoutTime=Object(_.a)(),s.onTimeout&&s.onTimeout(i),Object(p.c)(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),x({completion:"timeout",error:{documentLoadedWithTabSwitch:i.appInitDiagnostics.documentLoadedWithTabSwitch},timeoutStage:i.appBootState}),n&&n.cancel()},n&&s.overrideBootTimeout?Math.min(n.timeoutInMs,s.overrideBootTimeout(i)):n?n.timeoutInMs:s.overrideBootTimeout?s.overrideBootTimeout(i):void 0),s.beforeBootCompletionMessage&&s.beforeBootCompletionMessage(i))}).catch(t=>{throw i.failureTime=Object(_.a)(),s.onException&&s.onException(i,t),i.remoteTelemetryUrl&&Object(p.c)(i.remoteTelemetryUrl,i.application.name,"bootException"),i.bootHeartBeat&&i.bootHeartBeat.stop(),{error:t.toString(),errorStack:t.stack}}),W=(t,e,i)=>new Promise(e=>{i.logger.ULS.cn(590111070,r.a.X,c.a.Error,"Unsupported flow: "+t),e({completion:"failure"})});var F=i(62);const M=(t,e,i,s,n)=>t!==h.a.createNew?Promise.reject("Wrong flow"):new Promise(a=>{const l={wopiPendingInitializeTime:Object(_.a)()},p=!!(s&&s.parallelizeStartSessionRequest&&s.buildStartSessionRequestParams)&&s.parallelizeStartSessionRequest(i);let m=!1,b=!1,w=!1,O=!1,v=void 0,j=void 0,S=!1,T=!1;if(Object(g.e)()||s&&s.fallBackToSingleStepBootFlow&&s.fallBackToSingleStepBootFlow(i,e))return void function(){i.logger.ULS.cn(578074079,r.a.X,c.a.Info,"Waiting for WOPI info to start boot");const t=(t,o)=>{if(m)i.logger.ULS.cn(578074080,r.a.X,c.a.Warning,"completeCreateNew already called");else{if(m=!0,l.wopiPendingCompleteTime=Object(_.a)(),"failure"===o.state)return D(o.reason),i.state=f.a.Failed,void s({completion:"failure"});k(o.newFile),i.run(h.a.boot,{...e,wopi:o.wopi},n).then(t=>{s(t)})}};i.addActionHandler(h.a.completeCreateNew,t);const s=e=>{i.removeActionHandler(h.a.completeCreateNew,t),a(e)};n&&n.subscribe(()=>{s({completion:"cancelled"})})}();const y=(t,e)=>{m?i.logger.ULS.cn(587236372,r.a.X,c.a.Warning,"completeCreateNew already called"):(m=!0,l.wopiPendingCompleteTime=Object(_.a)(),"failure"!==e.state?(v=e.wopi,u(v)?(i.wopi=v,i.logger.ULS.cn(587286030,r.a.X,c.a.Info,"WOPI info received. Access token: "+JSON.stringify({length:v.accessToken.length,expiry:v.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:p,wacFrameLoaded:b,wacCanAcceptStartSessionResponse:w})),!p||b&&!w?b&&W():E(),b&&i.container&&i.container.postMessage(d.a.qo,void 0),k(e.newFile)):A("InvalidWopiInfo")):A(e.reason))},A=t=>{D(t),b&&i.container&&i.container.postMessage(d.a.Go,void 0)},E=()=>{i.logger.ULS.cn(587233056,r.a.X,c.a.Info,"Making parallelized StartSession request");const e=s.buildStartSessionRequestParams(i,t,v),o=I(i,e.appPageName,e.queryParamsOverrides),n="access_token="+encodeURIComponent(v.accessToken)+"&access_token_ttl="+encodeURIComponent(v.expiry.toString());l.startSessionStartTime=Object(_.a)(),Object(F.a)(o,n,{"Content-Type":"application/x-www-form-urlencoded"},P)},P=t=>{const e=Object(_.a)();l.startSessionCompleteTime=e,i.logger.ULS.cn(587233057,r.a.X,c.a.Info,`StartSession request completed. Status code: ${t.status}, time: ${e}`),j={RequestStatus:t.status,ResponseText:t.responseText},b&&w?R():i.logger.ULS.cn(587233058,r.a.X,c.a.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:b,wacCanAcceptStartSessionResponse:w,wopiInfoSent:S,startSessionResponseSent:T}))},U=(t,e)=>{l.readyMessageReceiveTime=Object(_.a)(),i.container&&i.container.postMessage(d.a.lo,void 0),b||(b=!0,w=e.CanAcceptStartSessionComplete,i.logger.ULS.cn(587321567,r.a.X,c.a.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:p,wacCanAcceptStartSessionResponse:w,startSessionResponseAvailable:!!j,wopiInfoAvailable:!!v})),m&&i.container&&i.container.postMessage(v?d.a.qo:d.a.Go,void 0),p&&w?R():W(),Object(C.b)(i.appInitDiagnostics,e.Diagnostics))},R=()=>{T||S||!j||(200===j.RequestStatus?(T=!0,l.completeMessageCreateTime=Object(_.a)(),M(d.a.wo,{StartSessionResponse:j,Diagnostics:l},3)):W())},W=()=>{T||S||!v||(S=!0,l.completeMessageCreateTime=Object(_.a)(),s&&s.sendCreateNewWopiInfo?s.sendCreateNewWopiInfo(i):M(d.a.Oo,{WopiDetails:{WopiSrc:v.source,AccessToken:v.accessToken,AccessTokenTtl:v.expiry.toString()},Diagnostics:l},3))},M=(t,e,s)=>{const o=Object(_.a)();s<=0?i.logger.ULS.cn(587233165,r.a.X,c.a.Error,"Attempted to complete but no ack. Time: "+o):(i.logger.ULS.cn(587233166,r.a.X,c.a.Info,`Sending complete message. Retries left: ${s-1}, Time: ${o}`),l.completeMessageSendTime=o,i.container&&i.container.postMessage(t,e),window.setTimeout(N,1e3,t,e,s-1))},N=(t,e,s)=>{O||(i.logger.ULS.cn(587233167,r.a.X,c.a.Info,"Timeout session complete ack. Retries left: "+s),M(t,e,s))},x=(t,e)=>{O=!0},H=t=>{i.removeActionHandler(h.a.completeCreateNew,y),i.removeActionHandler(o.a.Ce,U),i.removeActionHandler(o.a.bi,x),a(t)};function D(t){i.logger.ULS.cn(596444188,r.a.X,c.a.Warning,"Fail with reason: "+(t?JSON.stringify(t):"N/A"))}i.addActionHandler(h.a.completeCreateNew,y),i.addActionHandler(o.a.Ce,U),i.addActionHandler(o.a.bi,x),n&&n.subscribe(()=>{H({completion:"cancelled"})}),i.skipWopiValidation=!0,i.skipFileNameCheck=!0,i.wopi=void 0,i.run(h.a.boot,e,n).then(t=>{i.skipWopiValidation=!1,i.wopi=v,H(t)})});function k(t){t&&(t.path&&history.replaceState({},"",t.path),t.title&&(document.title=t.title))}var N=i(52);const x=(t,e,i,s,n)=>t!==h.a.dispose?Promise.reject("Wrong flow"):new Promise(t=>{i.logger.ULS.cn(595714433,r.a.X,c.a.Important,"start disposing the application");const a=i.host.requireExplicitUnload,h={disposeStartTime:Object(_.a)(),forceAppUnload:a};i.state=f.a.Disposing;const u=()=>{i.state=f.a.Disposed,t({completion:"success"})},l=t=>{s&&s.disposeAppSpecificResources&&s.disposeAppSpecificResources(i,e),i.dispose(),h.disposeEndTime=Object(_.a)(),function(t,e,i){if(i){const t=Number(i.hostMessageReceived);e.appUnloadStartTime&&!isNaN(t)&&(e.hostToAppPostMessageLatency=t-e.appUnloadStartTime);const s=Number(i.appMessageSent);!isNaN(s)&&e.appUnloadEndTime&&(e.appToHostPostMessageLatency=e.appUnloadEndTime-s);const o=Number(i.appUnloadStart),n=Number(i.appUnloadEnd);if(isNaN(o)||isNaN(n)||(e.appUnloadLatency=n-o),i.serverTimings){const t=i.serverTimings;for(const i in t)e["st-"+i.toString()]=t[i]}}t.logger.ULS.cn(592524822,r.a.X,c.a.Info,"App disposed: "+JSON.stringify(e)),t.logger.ULS.flushOnClose()}(i,h,t),i.container?i.container.dispose(i.pendingReboot,a).then(u):u()};if(a){h.appUnloadStartTime=Object(_.a)();const t=(t,e)=>{h.appUnloadEndTime=Object(_.a)(),l(e)};i.addActionHandler(o.a.Si,t),(n||new N.a(5e3)).subscribe(()=>{i.state===f.a.Disposing&&(h.appUnloadTimedOut=!0,l())}),i.container&&i.container.postMessage(d.a.Zo,void 0)}else l()}),H=(t,e,i,s,a)=>t!==o.a.$e?Promise.reject("Wrong flow"):new Promise(t=>{if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(n.a.FrameTrust,e);else{const t=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.cn(592445957,r.a.X,c.a.Info,"Top frame is trusted: "+t),i.container&&i.container.postMessage(d.a.$e,{isTopFrameTrusted:t})}t({completion:"success"})}),D=(t,e,i,s,r)=>t!==o.a.ze?Promise.reject("Wrong flow"):new Promise(t=>{i.authTokenTrustValidator.isResourceTrustedForMessage(e).then(s=>{s?i.raiseEvent(n.a.GetAuthToken,e):(i.container.postMessage(d.a.ko,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType}),t({completion:"success"}))},s=>{i.container.postMessage(d.a.ko,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType}),t({completion:"failure",error:s})})});var V=i(60);const B=(t,e,i,s,n)=>t!==o.a.ye?Promise.reject("Wrong flow"):new Promise(t=>{const o=e&&e.state?e.state:"Unknown";i.logger.ULS.cn(592839750,r.a.X,c.a.Info,`Boot state: [${o}]`),o!==i.appBootState&&(i.appBootState=o,i.bootHeartBeat&&i.bootHeartBeat.setTimeoutStage(o)),s&&s.beforeComplete&&s.beforeComplete(o),t({completion:"success"})}),L=(t,e,i,s,n)=>{if(t!==h.a.postWacToken)return Promise.reject("Wrong flow");const a=Object(_.b)();return i.logger.ULS.cn(507774685,r.a.X,c.a.Important,"postWacToken flow initiated"),new Promise(t=>{const s=(t,e)=>{i.logger.ULS.cn(507597017,r.a.X,c.a.Info,`postWacToken flow completed in ${Object(_.b)()-a} ms`),window.clearInterval(u),window.clearTimeout(l);const s={completion:"success"};e&&void 0!==e.TokenAlreadySet&&(s.data={TokenAlreadySet:e.TokenAlreadySet}),n(s)},n=e=>{i.removeActionHandler(o.a.ms,s),t(e)},h=()=>{var t;return null===(t=i.container)||void 0===t?void 0:t.postMessage(d.a.rn,e)};i.addActionHandler(o.a.ms,s),h();const u=window.setInterval(h,100),l=window.setTimeout(()=>{window.clearInterval(u),i.logger.ULS.cn(507844190,r.a.X,c.a.Warning,"postWacToken flow timed out after 60000 milliseconds"),n({completion:"timeout"})},6e4)})},J=(t,e,i,s,n)=>t!==h.a.rename?Promise.reject("Wrong flow"):new Promise(t=>{const s=(t,i)=>{const s={completion:i.NewName===e.NewName?"success":"failure"};c(s)},r=(t,e)=>{c({completion:"failure"})},c=e=>{i.removeActionHandler(o.a.Ve,s),i.removeActionHandler(o.a.Be,r),t(e)};i.addActionHandler(o.a.Ve,s),i.addActionHandler(o.a.Be,r),(n||new N.a(5e3)).subscribe(()=>{c({completion:"cancelled"})}),i.container&&i.container.postMessage(d.a.Fo,e)});var $=i(59),G=i(58),z=i(61);const q=(t,e,i,s,n)=>t!==h.a.switchMode?Promise.reject("Wrong flow"):new Promise(t=>{const s=(t,e)=>{r({completion:"success"})},r=e=>{i.removeActionHandler(o.a.Ye,s),t(e)};i.addActionHandler(o.a.Ye,s),(n||new N.a(5e3)).subscribe(()=>{r({completion:"cancelled"})}),i.container&&i.container.postMessage(d.a.Ko,e)});function K(t){const e=t.appContext;e.canSupportInteractiveReadOnly=!1,e.isUnifiedRead=!1}var Z=i(2);function X(t){const e=t.je.getValue(U.a.Se,!1);let i=!1;i=e?Object(Z.d)(t.appUrl,e):t.appBaseUrl.indexOf(Z.k)>-1;const s=t.rebootOverride;if(s){let o=s.mode;o&&(o=o.toLowerCase(),"view"===o&&i?(t.appBaseUrl=Object(Z.f)(t.appBaseUrl),e&&(t.appUrl=Object(Z.f)(t.appUrl))):"edit"!==o||i||(t.appBaseUrl=Object(Z.g)(t.appBaseUrl),e&&(t.appUrl=Object(Z.g)(t.appUrl))))}else{var o,a,h;const s=!!t.je.getValue(U.a.ho,!1),d=!(!t.ui||!t.ui.uiEmbed),u=!(!t.hostName||"OfficeDotCom"!==t.hostName),l=d&&!(!t.bootParams||!t.bootParams.readOnly),f=Object(O.p)(t.appUrl,"embed"),p=!(!t.wdParams||"1"!==t.wdParams.wdembedfs),b=!(!t.bootParams||!t.bootParams.isNewFile||t.wopi),w=!(!t.file||"docx"!==Object(j.a)(t.file.name)),g=!(!t.wdParams||"1"!==t.wdParams.wdreadingview),v=t.je.getValue(U.a.do,!1)?(null===(o=t.host)||void 0===o?void 0:o.uiHostName)||Object(O.k)(t.appUrl,"uih"):void 0,S=Object(Z.c)(null===(a=t.wdParams)||void 0===a?void 0:a.wdmobile,v),I=t.je.getValue(U.a.ao,!1),_=s&&d&&u,C=!f&&(b||w)&&(_||!d||I&&S)&&!p&&!g;t.appContext.canSupportInteractiveReadOnly=!!C;const T=t.je.getValue(U.a.co,!1),y=t.featureManager.isFeatureEnabled(m.a.In);if((null!==(h=y||T)&&void 0!==h&&h||I&&S)&&C&&!i)t.appBaseUrl=Object(Z.g)(t.appBaseUrl),e&&(t.appUrl=Object(Z.g)(t.appUrl)),t.appContext.isUnifiedRead=!0,t.appContext.isMobileView=S&&I,t.logger.ULS.cn(559285716,r.a.X,c.a.Important,"Redirecting Viewer request to unified read");else{if(!i){const e={canSupportInteractiveReadOnly:{canSupportInteractiveReadOnlyValue:C,isEmbedActionApplicationUrl:f,isUiEmbed:d,isUiEmbedReadOnly:l,isEmbeddedFullScreen:p,isCreateNewWithoutWopiInfo:b,isFileDocx:w,isReadingViewMode:g},interactiveReadOnlyFlightValue:y,interactiveReadOnlySettingValue:T,isMobileModeRequested:S,isMobileModeSettingEnabled:I,uiHost:v};t.logger.ULS.cn(505996416,r.a.X,c.a.Important,"Interactive Read Only redirection will not happen. DebugInfo: "+JSON.stringify(e))}i&&!l||t.raiseEvent(n.a.ModeSwitched,{NewMode:"view"}),i&&l&&(t.appBaseUrl=Object(Z.f)(t.appBaseUrl),e&&(t.appUrl=Object(Z.f)(t.appUrl)))}}return i=e?Object(Z.d)(t.appUrl):t.appBaseUrl.indexOf(Z.k)>-1,t.appBaseUrl+(i?Z.h:Z.l)}function Q(t){return Object(O.e)(t.appBasePath,t.sessionId)}function Y(t){if(t.je.getValue(U.a.qs,!1))try{var e;if(t.hostInitDiagnostics&&t.hostInitDiagnostics.hostPageNavigationType&&window&&window.localStorage)if(null!==(e=t.file)&&void 0!==e&&e.uniqueId){const e="sessionRefresh_"+t.file.uniqueId;switch(t.hostInitDiagnostics.hostPageNavigationType){case"RELOAD":const i=window.localStorage.getItem(e);null!=i&&(t.logger.ULS.cn(507352900,r.a.X,c.a.Warning,"sessionRefreshDiagnostics: "+i),window.localStorage.removeItem(e));const s={previousSessionId:t.sessionId,navigationType:t.hostInitDiagnostics.hostPageNavigationType};window.localStorage.setItem(e,JSON.stringify(s));break;default:window.localStorage.removeItem(e);const o={previousSessionId:t.sessionId,navigationType:t.hostInitDiagnostics.hostPageNavigationType};window.localStorage.setItem(e,JSON.stringify(o))}}else t.logger.ULS.cn(507274849,r.a.X,c.a.Warning,"No fileId provided");else t.logger.ULS.cn(507274848,r.a.X,c.a.Warning,"hostPageNavigationType not available")}catch(e){t.logger.ULS.cn(507340190,r.a.X,c.a.Warning,"Error Thrown during logSessionRefreshDiagnostics with error "+e)}}function tt(t,e,i){const s=t.je.getValue(U.a.Se,!1);let o=!1;o=s?Object(Z.d)(t.appUrl,s):t.appBaseUrl.indexOf(Z.k)>-1;const n=o?e===h.a.createNew?Z.j:Z.i:Z.m,r={},c=t.viewMode;c&&(c.hideToolbar&&Object(O.a)(r,o?"hvt":"core","1"),c.hideBreadCrumb&&Object(O.a)(r,"hbcv","1"),c.hideTitle&&Object(O.a)(r,"htv","1"),c.disableFocusOnBoot&&Object(O.a)(r,"disablefocusonboot","1"),c.forceAccessibilityMode&&!c.hideToolbar&&Object(O.a)(r,"wdaccpdf","1"));const a=t.ui;a&&(a.inAppDocPreview&&Object(O.a)(r,"inappdocpreview","1"),a.hideRibbon&&Object(O.a)(r,"hrbn","1"),a.hideInAppBizChat&&Object(O.a)(r,"hiabc","1"));const d=t.wopi,u=t.bootParams;return o&&(d?(t.appContext.canSupportInteractiveReadOnly&&(Object(O.a)(r,"csiro","1"),t.appContext.isMobileView&&(Object(O.a)(r,"mobile","1"),Object(O.a)(r,"hhdr","1"))),u&&u.isNewFile||(t.appContext.isUnifiedRead?(Object(O.a)(r,"iro","1"),Object(O.a)(r,"readonly","1"),null!=u&&u.readOnly&&Object(O.a)(r,"mode","Read")):Object(O.a)(r,"instantedit","1"),Object(O.a)(r,"wopicomplete","1"))):(Object(O.a)(r,"instantedit","1"),Object(O.a)(r,"filesrc",encodeURIComponent(t.hostName)),Object(O.a)(r,"pmorigin",encodeURIComponent(Object(O.i)(window.location.href)))),e===h.a.createNew&&(Object(O.r)(r,"newsession"),Object(O.a)(r,"build",encodeURIComponent(Object(v.a)())),Object(O.a)(r,"wacusertype","WOPI"),t.file.getUrl&&Object(O.a)(r,"filegeturlpresent","1"),i&&Object(O.a)(r,"wopisrc",encodeURIComponent(i.source)))),d&&Object(O.a)(r,"wdredirectionreason",function(t,e,i,s){return t?"Unified_SingleFlush":e?"Unified_IrmEnabled":i&&s?"Unified_UiEmbedReadOnly":"Unified_ViewActionUrl"}(o,!(!u||!u.irmEnabled),!(!a||!a.uiEmbed),!(!u||!u.readOnly))),{appPageName:n,queryParamsOverrides:r,postDataOverrides:{}}}function et(t,e,i,s,o){if(!t.je.getValue(U.a.Gs,!1))return;const n=function(t,e,i,s,o){var n,r;const c=function(t){var e,i,s,o,n,r,c,a,h,d;const u=Object(Z.a)(t);let l=Object(C.d)(t.hostName)||null!==(e=t.wopi)&&void 0!==e&&e.source&&Object(C.d)(null===(i=t.wopi)||void 0===i?void 0:i.source)?"SharePoint Online":null!==(s=t.wopi)&&void 0!==s&&s.source&&function(t){return/\.microsoftpersonalcontent(ppe)?\./i.test(t)}(null===(o=t.wopi)||void 0===o?void 0:o.source)?"SharePoint Online Consumer":t.host.storageHostName;"OneDrive"===l&&(l="OneDriveWOPI");let f=Object(Z.b)(navigator.userAgent);return{a:t.appInfo.name||"Unknown",b:t.ui.language||"Unknown",c:u.AppMode||"Unknown",d:u.AppModeExtended||"Unknown",e:"",f:t.clientDiagnostics.browser||"Unknown",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:l||"Unknown",o:!1,p:t.user.isLicensed||!1,q:!1,r:t.user.isSynthetic||!1,s:t.ownerId||t.user.id||"Unknown",t:t.tenantId||"Unknown",u:(null!==(n=null===(r=t.wdParams)||void 0===r||null===(r=r.wdjs)||void 0===r?void 0:r.length)&&void 0!==n?n:0)>0?"-5":"",v:"",w:t.sessionId||"Unknown",x:(null===(c=t.hostInitDiagnostics)||void 0===c?void 0:c.entryPoint)||"Unknown",y:t.tenantId||"Unknown",z:t.host.uiHostName||"Unknown",aa:(null===(a=t.appInitDiagnostics)||void 0===a?void 0:a.officeServerVersion)||"Unknown",ab:null!==(h=t.file)&&void 0!==h&&h.name?Object(j.a)(null===(d=t.file)||void 0===d?void 0:d.name):"Unknown",ac:t.host.uiHostIntegrationType||"Unknown",ad:f,ae:!1,af:t.clientDiagnostics.netDownlink,ag:t.clientDiagnostics.netDownlinkMax,ah:t.clientDiagnostics.netEffectiveType||"Unknown",ai:t.clientDiagnostics.netRtt,aj:t.clientDiagnostics.netSaveData,ak:t.clientDiagnostics.netType||"Unknown",al:""}}(t),a=function(t,e,i,s,o,n,r,c){const a={AreaName:"Boot",FeatureName:"JSAPI",SkipAria:"True"};return n&&!isNaN(Number(n))&&(a.BsqmErrorCode=n),{n:"Boot",e:s,t:ot.FailureBased,a:!0,f:"wordwebsxfc",k:n?{n:n}:void 0,p:{...a,...r},d:c?Math.round(c):void 0}}(0,0,0,e,0,i,s,o),h={},d=t.appBaseUrl?null===(n=Object(O.m)(t.appBaseUrl))||void 0===n?void 0:n.toUpperCase():void 0;d&&(h.ComplianceRegion=d);const u=function(t){if(!t)return;const e=it.exec(t);return e&&e.length>1?e[1]:void 0}(null===(r=t.wopi)||void 0===r?void 0:r.source);return u&&(h.HostDatacenterHint=u),{d:c,k:[a],a:h}}(t,e,i,s,o);Object(p.b)(t.remoteTelemetryUrl,p.a.H_V2,n)}const it=new RegExp("^[a-z+.-]+://([^/:]*(:[0-9]{1,5})?)","i");var st,ot;function nt(t){let e=0;try{const t=Object.keys(window.localStorage).filter(t=>t.startsWith("sessionRefresh_"));if(t.length>0)for(let i=0;i<t.length;i++){const s=t[i];window.localStorage.removeItem(s),e++}}catch(e){t.logger.ULS.cn(506819588,r.a.X,c.a.Warning,"Error Thrown during deleteAllSessionRefreshEntries with error "+e)}return e}let rt,ct;function at(t){var e,i;const s=null!==(e=t.hostInitDiagnostics)&&void 0!==e&&e.hostInitializeCallTime?t.successTime-(null===(i=t.hostInitDiagnostics)||void 0===i?void 0:i.hostInitializeCallTime):0;et(t,st.Success,void 0,void 0,s);const o=t.je.getValue(U.a.qs,!1),n=t.je.getValue(U.a.no,!1);if(o&&function(t,e){try{var i;if(function(t){const e=864e5*t.je.getValue(U.a.ro,30);let i=0;try{const s=window.localStorage.getItem("refreshTelemExpiry");null!=s?Date.now()-parseInt(s,10)>=e&&(i=nt(t),window.localStorage.setItem("refreshTelemExpiry",Date.now().toString())):window.localStorage.setItem("refreshTelemExpiry",Date.now().toString())}catch(e){t.logger.ULS.cn(506819589,r.a.X,c.a.Warning,"Error Thrown during checkSessionRefreshExpiry with error "+e)}}(t),window.localStorage&&null!==(i=t.file)&&void 0!==i&&i.uniqueId){var s;const i="sessionRefresh_"+(null===(s=t.file)||void 0===s?void 0:s.uniqueId),o=window.localStorage.getItem(i);if(o){const t=JSON.parse(o);t.success=e,window.localStorage.setItem(i,JSON.stringify(t))}}}catch(e){t.logger.ULS.cn(506855459,r.a.X,c.a.Warning,"Error Thrown during markSessionAsSuccesful with error "+e)}}(t,s),n&&(nt(t),function(t){try{window.localStorage.removeItem("refreshTelemExpiry")}catch(e){t.logger.ULS.cn(506819587,r.a.X,c.a.Warning,"Error Thrown during deleteRefreshTelemExpiryEntry with error "+e)}}(t)),ht(),!ct)return;t.container&&t.container.postMessage(d.a.So,{HostCacheLoadTime:ct});const a=t.appInitDiagnostics;a.documentLoadedTime?ct<a.documentLoadedTime?(a.documentLoadedTime=ct,a.documentLoadedFromWopiPrecheckInfo=!0,t.logger.ULS.cn(577843782,r.a.X,c.a.Info,"First page loaded from cache was faster")):a.documentLoadedFromWopiPrecheckInfo=!1:a.documentLoadedTime=ct}function ht(){rt&&rt.parentElement&&rt.parentElement.removeChild(rt)}function dt(t,e){!function(t,e){const i={storageHost:t.host.storageHostName||"",uiHost:t.host.uiHostName||Object(O.k)(e,"uih"),wdOrigin:t.hostInitDiagnostics.entryPoint||Object(O.k)(e,"wdorigin")};t.logger.ULS.cn(561629318,r.a.X,c.a.Info,JSON.stringify(i))}(t,e),function(t){const e=t.je.getValue(U.a.Se,!1);let i=!1;if(i=e?Object(Z.d)(t.appUrl,e):t.appBaseUrl.indexOf(Z.k)>-1,i)return;t.logger.ULS.cn(577843778,r.a.X,c.a.Info,"Boot Word viewer");const s=window.navigator.userAgent;if(s.indexOf("Mobi")>=0&&s.indexOf("iPad")<0)return;const o=t.rebootOverride;if(o&&o.reason&&"translate"===o.reason.toLowerCase())return;const n=t.viewMode;if(n&&n.forceAccessibilityMode)return;const a=t.contentBundle;if(!a||!a.url)return;const h=t.container;if(!h)return;const d=h.element,u=d.ownerDocument;if(!u)return;t.logger.ULS.cn(577843779,r.a.X,c.a.Info,"Kick off first page optimization"),rt=u.createElement("div"),rt.id="FirstPageContainer",rt.style.top=n&&n.hideToolbar?"0":"90px",rt.style.left="0",rt.style.textAlign="center",rt.style.width="1px",rt.style.bottom="0",rt.style.zIndex="900",rt.style.height="1px",rt.style.position="absolute",rt.style.padding="0 29px",rt.style.right="0",rt.style.overflow="auto",rt.style.marginLeft="auto",rt.style.marginRight="auto",rt.style.maxWidth="100%",d.appendChild(rt);const l=u.createElement("img");l.id="FirstPageImage",l.style.marginTop="11px",l.style.marginBottom="11px",l.style.maxWidth="100%",l.style.border="solid 1px #d2d5d8",l.draggable=!1,l.onload=()=>{t.logger.ULS.cn(577843780,r.a.X,c.a.Info,"First page optimization loaded"),rt.style.width="",rt.style.height="",ct=Object(_.a)()},l.onerror=e=>{ht(),t.logger.ULS.cn(577843781,r.a.X,c.a.Warning,"Cannot load first page from cache"),t.appInitDiagnostics.errorObject={errorType:"CannotLoadFirstPage",errorObject:"string"==typeof e?e:e.returnValue}},l.src=a.url.replace("{0}","p1.img"),rt.appendChild(l)}(t),et(t,st.Usage)}function ut(t){let e=t.appBaseUrl;const i=t.je.getValue(U.a.Se,!1);let s=!1;s=i?Object(Z.d)(t.appUrl,i):t.appBaseUrl.indexOf(Z.k)>-1;const o=Object(g.c)()===g.a.Firefox&&"OneDrive"===t.hostName&&t.host.origin&&"https://onedrive.live.com"===t.host.origin.toLowerCase();return s&&o&&(e+=" "+(t.host.origin&&t.host.origin.toLowerCase())),{permissionsPolicy:`microphone ${e}; autoplay ${t.appBaseUrl}; camera ${t.appBaseUrl}; clipboard-read ${t.appBaseUrl}; clipboard-write ${t.appBaseUrl}; keyboard-map ${t.appBaseUrl}; display-capture ${t.appBaseUrl}`}}function lt(t){return!(!t||void 0===t.indexOf||!(t.indexOf("Failed to load resource")>-1||t.indexOf("Resource failed to load")>-1))}function ft(t,e){var i,s;const o={WacFailed:"True"};e.errorObject&&(o.ErrorObject=Object(j.b)(e.errorObject));const n=null!==(i=t.hostInitDiagnostics)&&void 0!==i&&i.hostInitializeCallTime?t.failureTime-(null===(s=t.hostInitDiagnostics)||void 0===s?void 0:s.hostInitializeCallTime):0;let a=function(t){const e=t;let i="JsApiUnknownError";return void 0!==t.errorObject&&null!==t.errorObject&&void 0!==t.errorObject.errorCode?i=t.errorObject.errorCode:e.errorCode?i=e.errorCode:void 0!==t.errorObject&&null!==t.errorObject&&void 0!==t.errorObject.errorType?i=t.errorObject.errorType:t.errorType?i=lt(t.errorObject)?"JsApiResourceLoadError":t.errorType:lt(e)&&(i="JsApiResourceLoadError"),i}(e);et(t,st.Failure,a,o,n),t.je.getValue(U.a.qs,!1)&&function(t,e){try{var i;if(window.localStorage&&null!==(i=t.file)&&void 0!==i&&i.uniqueId){var s;const i="sessionRefresh_"+(null===(s=t.file)||void 0===s?void 0:s.uniqueId),o=window.localStorage.getItem(i);if(o){const t=JSON.parse(o);t.failureInfo=e,window.localStorage.setItem(i,JSON.stringify(t))}}}catch(e){t.logger.ULS.cn(507340189,r.a.X,c.a.Warning,"Error Thrown during logSessionRefreshFailure with error "+e)}}(t,a)}function pt(t){var e;const i=null!==(e=t.hostInitDiagnostics)&&void 0!==e&&e.hostInitializeCallTime?t.timeoutTime-t.hostInitDiagnostics.hostInitializeCallTime:0;et(t,st.Failure,"JsApiTimeout",{TimeoutTime:i},i),t.je.getValue(U.a.qs,!1)&&function(t,e){try{var i;if(window.localStorage&&null!==(i=t.file)&&void 0!==i&&i.uniqueId){var s;const i="sessionRefresh_"+(null===(s=t.file)||void 0===s?void 0:s.uniqueId),o=window.localStorage.getItem(i);if(o){const t=JSON.parse(o);t.timeout=e,window.localStorage.setItem(i,JSON.stringify(t))}}}catch(e){t.logger.ULS.cn(507274847,r.a.X,c.a.Warning,"Error Thrown during logSessionTimeout with error "+e)}}(t,i)}function mt(t,e){var i,s;const o=e instanceof Error?e.name:"JsApiException",n={ErrorObject:Object(j.b)(e)};e instanceof Error&&(n.ErrorMessage=e.message);const r=null!==(i=t.hostInitDiagnostics)&&void 0!==i&&i.hostInitializeCallTime?t.failureTime-(null===(s=t.hostInitDiagnostics)||void 0===s?void 0:s.hostInitializeCallTime):0;et(t,st.Failure,o,n,r)}function bt(){return!0}!function(t){t[t.Failure=0]="Failure",t[t.ImpliedUsageFailure=1]="ImpliedUsageFailure",t[t.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",t[t.Success=3]="Success",t[t.Usage=4]="Usage"}(st||(st={})),function(t){t[t.FailureBased=0]="FailureBased",t[t.SuccessBased=1]="SuccessBased"}(ot||(ot={}));const wt=()=>[{[s.a.appReboot]:a,[s.a.boot]:R,[s.a.closeTab]:W,[s.a.createNew]:M,[s.a.dispose]:x,[s.a.frameTrust]:H,[s.a.getAuthToken]:D,[s.a.getHostKeyValue]:V.a,[s.a.handleBootState]:B,[s.a.postWacToken]:L,[s.a.rename]:J,[s.a.setOverlayContent]:$.a,[s.a.setWacFlightValue]:G.a,[s.a.storeHostKeyValue]:z.a,[s.a.switchMode]:q,[s.a.updateBootComplete]:W},{[s.a.boot]:{initializeAppContext:K,buildAppBasePath:X,buildRemoteTelemetryUrl:Q,onContextReady:Y,buildBootRequestParams:tt,beforeContainerBoot:dt,buildContainerBootParams:ut,onSuccess:at,onFailure:ft,onTimeout:pt,onException:mt},[s.a.createNew]:{parallelizeStartSessionRequest:bt,buildStartSessionRequestParams:tt}}]},function(t,e,i){"use strict";function s(t,e,i){if(!e)return;const s=window.navigator;if(s&&s.sendBeacon)try{return void s.sendBeacon(e,t)}catch{}!function(t,e,i){const s=new XMLHttpRequest;s.readyState!==XMLHttpRequest.UNSENT&&s.readyState!==XMLHttpRequest.DONE||(s.open("POST",e,i),s.send(t))}(t,e,i)}i.d(e,"a",(function(){return s}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));class s{add(t){t&&this.ka.push(t)}remove(t){if(!t)return;const e=this.ka.indexOf(t);e>-1&&this.ka.splice(e,1)}removeAll(){this.ka=[]}dispatch(t,e){this.ka.forEach(i=>{try{i(t)}catch(t){e&&e(t)}})}constructor(){this.ka=[]}}},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.blurFocus="blurFocus",t.boot="boot",t.completeCreateNew="completeCreateNew",t.continueAccessibilityLoop="continueAccessibilityLoop",t.createNew="createNew",t.dispose="dispose",t.grabFocus="grabFocus",t.moveToFolder="moveToFolder",t.popState="popState",t.sendChannelId="sendChannelId",t.sendConvId="sendConvId",t.teamsUsersReply="teamsUsersReply",t.teamsUserMentionReply="teamsUserMentionReply",t.backButtonPressed="backButtonPressed",t.getClientUrl="getClientUrl",t.getWebUrl="getWebUrl",t.rename="rename",t.completeSharedFilePicker="completeSharedFilePicker",t.sendAccessToken="sendAccessToken",t.sendAuthToken="sendAuthToken",t.sendCustomAuthConfig="sendCustomAuthConfig",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendFrameTrustResult="sendFrameTrustResult",t.sendHWRTelemetry="sendHWRTelemetry",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.sendDavUrl="sendDavUrl",t.switchMode="switchMode",t.signalShared="signalShared",t.postWacToken="postWacToken"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var s=i(0),o=i(1),n=i(14),r=i(9),c=i(38),a=i(5),h=i(18);class d{updateEnvironment(t){this.Na=(Object(a.n)(t)?"FF":"Prod")+this.xa+"Settings",this.Ha()}initializePeriodicFetch(t,e){this.Na=(Object(a.n)(t)?"FF":"Prod")+this.xa+"Settings",this.Ha(),this.Da=t+a.c+"?app="+this.xa+"&usid="+e+"&build="+Object(h.a)(),this.Va||(this.Va=window.setTimeout(this.Ba,3e4))}getValue(t,e){if(this.La||this.Ha(),!this.La||!this.La.hasOwnProperty(t))return e;const i=this.La[t],s=typeof e;if(typeof i===s)return i;if("string"==typeof i){if("number"===s)return parseInt(i,10);if("boolean"===s)return"true"===i}return e}addSettingsChangeListener(t){this.Ja.add(t)}removeSettingsChangeListener(t){this.Ja.remove(t)}dispose(){this.Va&&window.clearTimeout(this.Va),this.$a&&self.cancelIdleCallback(this.$a),this.Va=void 0,this.$a=void 0,this.La=void 0,this.Ja.removeAll()}constructor(t,e){this.Ga=0,this.Ha=()=>{try{if(!window||!window.localStorage)return;const t=window.localStorage.getItem(this.Na);if(!t)return;const e=JSON.parse(t);this.za(e)}catch(t){this.Wn.ULS.cn(592836768,s.a.X,o.a.Warning,"Failed to get settings from localStorage: "+Object(r.b)(t))}},this.za=t=>!!this.qa(t)&&(this.La=t,this.Ja.dispatch({je:this},t=>{this.Wn.ULS.cn(592836769,s.a.X,o.a.Error,"Settings listener error: "+Object(r.b)(t))}),!0),this.qa=t=>{if(t&&"object"==typeof t){if(t.hasOwnProperty(n.a.Ps)&&!isNaN(t.timestamp))return!0;this.Wn.ULS.cn(592836770,s.a.X,o.a.Error,"Received invalid settings")}return!1},this.Ba=()=>{if(!this.Da)return;const t=new XMLHttpRequest;window.location.href.indexOf("wdnetcorerouting=true")>-1?t.setRequestHeader("X-NetCoreRouting","true"):window.location.href.indexOf("wdnetcorerouting=false")>-1&&t.setRequestHeader("X-NetCoreRouting","false"),t.open("GET",this.Da),t.responseType="json",t.timeout=5e3,t.send(),t.onload=()=>{if(200===t.status&&t.response?(this.Ka(t.response),this.Ga=0):(this.Wn.ULS.cn(592836771,s.a.X,o.a.Error,`Fetch settings error. Status: ${t.status}, curErrors: ${this.Ga}`),this.Ga+=1),this.Ga>7)return;let e=this.getValue(n.a.Es,3e5);this.Ga>3&&(e+=(this.Ga-3+1)*(e/2)),this.Va=window.setTimeout(this.Ba,e)}},this.Ka=t=>{"requestIdleCallback"in window?(this.$a&&self.cancelIdleCallback(this.$a),this.$a=window.requestIdleCallback(()=>this.Za(t),{timeout:1e4})):window.setTimeout(()=>this.Za(t),0)},this.Za=t=>{if(!this.za(t)||!window||!window.localStorage)return;const e=JSON.stringify(t);try{window.localStorage.setItem(this.Na,e)}catch(t){this.Wn.ULS.cn(592836800,s.a.X,o.a.Warning,"Failed to set localStorage: "+Object(r.b)(t))}},this.xa=t,this.Na="Prod"+t+"Settings",this.Wn=e,this.Ja=new c.a,this.Ha()}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return d})),i.d(e,"f",(function(){return u})),i.d(e,"c",(function(){return f})),i.d(e,"e",(function(){return p})),i.d(e,"d",(function(){return m})),i.d(e,"a",(function(){return b}));var s,o=i(0),n=i(1),r=i(8),c=i(18),a=(i(15),i(9)),h=i(5);function d(t,e){e&&Object.keys(e).forEach(i=>{t[i]=e[i]})}function u(t,e){try{if(void 0===window.performance)return void e.ULS.cn(595948609,o.a.X,n.a.Info,"Performance not supported");const i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void e.ULS.cn(595948610,o.a.X,n.a.Info,"No resources under performance");const s=new RegExp(t+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i");for(let t=i.length-1;t>=0;t-=1){const r=i[t],c=r.name.match(s);if(c){let t=JSON.stringify(r);return t=t.replace(new RegExp(r.name,"g"),c[0]),void e.ULS.cn(595948616,o.a.X,n.a.Info,t)}}e.ULS.cn(595948484,o.a.X,n.a.Info,"Could not find JSAPI resource timing entry")}catch(t){e.ULS.cn(595948617,o.a.X,n.a.Info,"Could not trace the resource timing: "+Object(a.b)(t))}}function l(t){var e,i;const s={...t.host,sessionId:t.hostSessionId,domain:location?location.host:void 0};delete s.siteId,delete s.webId,delete s.uiHostTabId;const o={};if(t.wdParams){const e=JSON.parse(JSON.stringify(t.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach(t=>{e[t]&&(o[t]=e[t])});const i=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!i.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!i.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}const n={...t.rebootOverride};delete n.ackExpected,delete n["ui-language"],delete n.wdUserSession,delete n.rebootMode,delete n.documentUrl;const r=t.wopi;return{accessToken:r?{length:r.accessToken.length,expiry:r.expiry}:"N/A",wacToken:r&&r.wacToken?{length:r.wacToken.length}:void 0,bootParams:t.bootParams,build:Object(c.a)(),host:s,intent:t.intent,jsApiVersion:"v2",rebootOverride:n,region:Object(h.m)(t.appBaseUrl),sessionOrigin:t.hostInitDiagnostics?t.hostInitDiagnostics.entryPoint:void 0,sessionContext:t.sessionContext,throttling:t.throttling,ui:t.ui,viewMode:t.viewMode,meeting:t.meeting?{id:null===(e=t.meeting)||void 0===e?void 0:e.id,isPresenter:null===(i=t.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function f(){const t={perfNowSupported:!0,browser:r.a[Object(r.c)()],touchMode:Object(r.h)(),highContrast:Object(r.d)(),windows10x:Object(r.i)()};try{const e=window.navigator,i=e.connection||e.mozConnection||e.webkitConnection;i&&(t.netOnline=e.onLine,t.netDownlink=i.downlink,t.netDownlinkMax=i.downlinkMax,t.netEffectiveType=i.effectiveType,t.netRtt=i.rtt,t.netSaveData=i.saveData,t.netType=i.type),t.deviceMemory=e.deviceMemory,t.logicalProcessors=e.hardwareConcurrency}catch{}return t}function p(t){try{const e=t.hostInitDiagnostics;t.logger.ULS.cn(558155803,o.a.X,n.a.Info,"HostInitDiagnostics: "+(e?JSON.stringify(e):"N/A")),t.logger.ULS.cn(596444237,o.a.X,n.a.Important,JSON.stringify({session:l(t),client:t.clientDiagnostics}))}catch(e){t.logger.ULS.cn(558155804,o.a.X,n.a.Error,"Failed to log init info: "+Object(a.b)(e))}}function m(t){return/sharepoint/i.test(t)}function b(t){const e=window.performance.timing;e&&(t.hostPageNavigationStartTime||(t.hostPageNavigationStartTime=e.navigationStart),t.hostPageFetchStartTime||(t.hostPageFetchStartTime=e.fetchStart),t.hostPageRequestStartTime||(t.hostPageRequestStartTime=e.requestStart),t.hostPageResponseStartTime||(t.hostPageResponseStartTime=e.responseStart),t.hostPageResponseEndTime||(t.hostPageResponseEndTime=e.responseEnd),t.hostPageDomCompleteTime||(t.hostPageDomCompleteTime=e.domComplete));const i=window.performance.navigation;if(i&&(void 0===t.hostPageRedirectCount&&(t.hostPageRedirectCount=i.redirectCount),!t.hostPageNavigationType)){let e="UNKNOWN";switch(i.type){case 0:e="NAVIGATE";break;case 1:e="RELOAD";break;case 2:e="BACK_FORWARD";break;case 255:e="RESERVED"}t.hostPageNavigationType=e}}!function(t){t[t.Unknown=0]="Unknown",t[t.Normal=1]="Normal",t[t.Minor=2]="Minor",t[t.Medium=3]="Medium",t[t.Major=4]="Major",t[t.Critical=5]="Critical"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return a}));var s=i(0),o=i(1),n=i(9),r=i(20);function c(t,e){return{isFeatureEnabled:i=>function(t,e,i){if(e)try{return e(t)}catch(t){i&&i.ULS.cn(594883024,s.a.X,o.a.Error,"IsFeatureEnabled callback error: "+Object(n.b)(t))}}(i,t,e)}}function a(t,e){const i={};if(Object.keys(r.a).forEach(e=>{const s=t.isFeatureEnabled(r.a[e]);void 0!==s&&(i[r.a[e]]=s?"1":"0")}),e&&e.wdFlights){const t=e.wdFlights.toLowerCase();for(const e of t.split(","))"et-treatment"!==e&&"et-control"!==e||(i[r.a.an]="et-treatment"===e?"1":"0")}return JSON.stringify(i)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var s=i(0),o=i(1);class n{dispose(){window.removeEventListener("beforeunload",this.Xa,{capture:!0}),window.removeEventListener("pagehide",this.Qa,{capture:!0}),window.removeEventListener("visibilitychange",this.Ya,{capture:!0}),window.removeEventListener("unload",this.th,{capture:!0})}constructor(t,e){this.Xa=()=>r(t,"OnBeforeUnload",e),this.Qa=()=>r(t,"OnPageHide",e),this.Ya=()=>r(t,"VisibilityChange_"+document.visibilityState,e),this.th=()=>r(t,"OnUnload",e),window.addEventListener("beforeunload",this.Xa,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Qa,{capture:!0}),window.addEventListener("visibilitychange",this.Ya,{capture:!0}),window.addEventListener("unload",this.th,{capture:!0,once:!0})}}function r(t,e,i){t.ULS.cn(595957843,s.a.X,o.a.Important,`Page lifecycle: ${e} fired`+(i?", flushing logger":"")),i&&t.ULS.flush()}},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var s=i(0),o=i(1);const n=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000","https://immersivereader.cloud.microsoft","https://forms.office.com"];class r{async isResourceTrustedForMessage(t){if(!t||!t.Resource)return!1;const e=t.Resource,i=t.AddinTrustId,r=function(t){if(!t)return!1;const e=t.toLowerCase();for(const t of n)if(t===e||t+"/"===e)return!0;return!1}(e);if(r||!i)return r;if(this.eh[i])return c(e,this.eh[i]);let a;const h=new Promise(t=>{a=(s,o)=>{i===s&&t(c(e,o))},this.ih.push(a)});let d=-1;const u=new Promise(t=>{d=window.setTimeout(()=>{this.Wn.ULS.cn(560754786,s.a.X,o.a.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: "+i),t(!1)},2e3)}),l=await Promise.race([h,u]);return this.ih=this.ih.filter(t=>t!==a),window.clearTimeout(d),l}dispose(){this.eh={},this.ih=[],window.removeEventListener("message",this.sh)}constructor(t){this.eh={},this.ih=[],this.sh=t=>{if(t&&t.origin)try{const e=t.data;if("string"==typeof e&&e.includes("AddinTrustedOrigin")){const i=JSON.parse(e),n=i.AddinTrustId;n&&"AddinTrustedOrigin"===i.MessageId&&(this.Wn.ULS.cn(560754784,s.a.X,o.a.Info,"didReceiveMessage addinTrustId "+n),this.eh[n]=t.origin,this.ih.forEach(e=>{e(n,t.origin)}))}}catch(t){this.Wn.ULS.cn(560754785,s.a.X,o.a.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.Wn=t,window.addEventListener("message",this.sh)}}function c(t,e){try{if(!t||!e)return!1;const i=33,s=126,o=/[?&#%\\]/;for(let e=0;e<t.length;e+=1){const n=t.charCodeAt(e);if(n<i||n>s)return!1;const r=t.charAt(e);if(o.test(r))return!1}const n="api:",r="https:";let c=t;c.substring(0,n.length).toLowerCase()===n&&(c=`${r}${c.substring(n.length)}`);const a=new URL(c);return a.protocol===r&&e.toLowerCase()===a.origin.toLowerCase()}catch{return!1}}},,,,,,function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(s||(s={}))},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.AccessibilityLoopCompleted="AccessibilityLoopCompleted",t.ActionCompleted="ActionCompleted",t.BrowserEvent="BrowserEvent",t.CAAEMessage="CAAEMessage",t.Close="Close",t.InitEnd="InitEnd",t.Conversation="Conversation",t.CopyAndEdit="CopyAndEdit",t.CreateNewDocument="CreateNewDocument",t.Download="Download",t.Edit="Edit",t.Error="Error",t.FileEmbed="FileEmbed",t.FileProperties="FileProperties",t.FileRenamed="FileRenamed",t.FileVersions="FileVersions",t.FrameStateChanged="FrameStateChanged",t.FrameTrust="FrameTrust",t.GetAccessToken="GetAccessToken",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.GetWopiInfoFromUrl="GetWopiInfoFromUrl",t.GetDavUrlFromIds="GetDavUrlFromIds",t.ModeSwitched="ModeSwitched",t.MoveToFolder="MoveToFolder",t.OpenInMobileApp="OpenInMobileApp",t.OpenInBrowser="OpenInBrowser",t.OpenInClient="OpenInClient",t.PageChanged="PageChanged",t.PushState="PushState",t.Reboot="Reboot",t.RedeemForCommenting="RedeemForCommenting",t.RefreshSessionInfo="RefreshSessionInfo",t.ReplyWithChanges="ReplyWithChanges",t.ReportAbuse="ReportAbuse",t.SharedFilePicker="SharedFilePicker",t.SaveStatus="SaveStatus",t.Share="Share",t.ShareForm="ShareForm",t.SignIn="SignIn",t.SplashScreenShown="SplashScreenShown",t.UserAccessAndPermissions="UserAccessAndPermissions",t.UserActivity="UserActivity",t.UserEditActivity="UserEditActivity",t.Workflow="Workflow",t.ZoomChanged="ZoomChanged",t.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",t.LoadingStatus="LoadingStatus",t.SwitchNotebook="SwitchNotebook",t.FailedBootCheckFileInfo="FailedBootCheckFileInfo",t.GetTeamsUsers="GetTeamsUsers",t.SendTeamsUserMention="SendTeamsUserMention",t.NavigateBackToHost="NavigateBackToHost",t.GetClientUrlComplete="GetClientUrlComplete",t.GetWebUrlComplete="GetWebUrlComplete",t.CopyLinkComplete="CopyLinkComplete",t.SendConversationId="SendConversationId",t.CloseTeamsConversation="CloseTeamsConversation",t.PageLoaded="PageLoaded",t.FrameChanged="FrameChanged",t.PrintRedirect="PrintRedirect",t.RequestFullScreen="RequestFullScreen",t.ShowCopilotBottomBar="ShowCopilotBottomBar",t.ExternalDocumentShare="ExternalDocumentShare"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o}));class s{get isCancelled(){return this.oh}get timeoutInMs(){return this.nh}get reason(){return this.rh}cancel(){this.hh(!1)}subscribe(t){this.oh?t():this.dh.push(t)}constructor(t){this.oh=!1,this.rh="",this.dh=[],this.hh=t=>{this.oh||(this.oh=!0,this.rh=t?"timeout":"cancelled",this.dh.map(t=>t()),this.dh=[])},this.nh=t,window.setTimeout(()=>this.hh(!0),t)}}function o(t){return new s(t)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return T}));var s=i(28),o=i(0),n=i(1),r=i(55),c=i(63),a=i(42),h=i(40),d=i(81),u=i(39),l=i(7),f=i(16),p=i(51);const m={[u.a.boot]:{uh:d.a.boot},[u.a.createNew]:{uh:d.a.createNew},[u.a.dispose]:{uh:d.a.dispose},[u.a.postWacToken]:{uh:d.a.postWacToken},[u.a.rename]:{uh:d.a.rename},[u.a.switchMode]:{uh:d.a.switchMode},[l.a.ye]:{uh:d.a.handleBootState},[l.a.Ue]:{uh:d.a.closeTab},[l.a.$e]:{uh:d.a.frameTrust},[l.a.ze]:{uh:d.a.getAuthToken},[l.a.Ke]:{uh:d.a.getHostKeyValue},[l.a.ci]:{uh:d.a.appReboot},[l.a.Os]:{uh:d.a.setWacFlightValue},[l.a.wi]:{uh:d.a.setOverlayContent},[l.a.ji]:{uh:d.a.storeHostKeyValue},[l.a.Ci]:{uh:d.a.updateBootComplete},[u.a.blurFocus]:{lh:f.a.po},[u.a.continueAccessibilityLoop]:{lh:f.a.vo},[u.a.grabFocus]:{lh:f.a.jo},[u.a.moveToFolder]:{lh:f.a.ti},[u.a.popState]:{lh:f.a.To},[u.a.sendChannelId]:{lh:f.a.yo},[u.a.sendConvId]:{lh:f.a.Ao},[u.a.teamsUsersReply]:{lh:f.a.Eo},[u.a.teamsUserMentionReply]:{lh:f.a.Po},[u.a.backButtonPressed]:{lh:f.a.Uo},[u.a.getClientUrl]:{lh:f.a.Ro},[u.a.getWebUrl]:{lh:f.a.Wo},[u.a.sendAccessToken]:{lh:f.a.Mo},[u.a.sendAuthToken]:{lh:f.a.ko},[u.a.sendHWRTelemetry]:{lh:f.a.tn},[u.a.sendCustomAuthConfig]:{lh:f.a.No},[u.a.sendDavUrl]:{lh:f.a.Lo},[u.a.sendEmbeddedViewUrl]:{lh:f.a.Ho},[u.a.sendFrameTrustResult]:{lh:f.a.$e},[u.a.sendSessionInfo]:{lh:f.a.Do},[u.a.sendUserAccessAndPermissions]:{lh:f.a.Vo},[u.a.sendWopiInfo]:{lh:f.a.Bo},[u.a.signalShared]:{lh:f.a.Yo},[u.a.completeSharedFilePicker]:{lh:f.a.pi},[l.a.Ie]:{fh:p.a.AccessibilityLoopCompleted},[l.a._e]:{fh:p.a.ActionCompleted},[l.a.Ee]:{fh:p.a.BrowserEvent},[l.a.Ri]:{fh:p.a.CAAEMessage},[l.a.Pe]:{fh:p.a.Close},[l.a.Re]:{fh:p.a.Conversation},[l.a.We]:{fh:p.a.CopyAndEdit},[l.a.Fe]:{fh:p.a.CreateNewDocument},[l.a.ke]:{fh:p.a.Download},[l.a.Ne]:{fh:p.a.Edit},[l.a.xe]:{fh:p.a.Error},[l.a.He]:{fh:p.a.FileEmbed},[l.a.De]:{fh:p.a.FileProperties},[l.a.Ve]:{fh:p.a.FileRenamed},[l.a.Le]:{fh:p.a.FileVersions},[l.a.Ge]:{fh:p.a.GetAccessToken},[l.a.Xe]:{fh:p.a.GetDavUrlFromIds},[l.a.qe]:{fh:p.a.GetCustomAuthConfig},[l.a.Ze]:{fh:p.a.GetWopiInfoFromUrl},[l.a.Je]:{fh:p.a.FrameStateChanged},[l.a.Ye]:{fh:p.a.ModeSwitched},[l.a.ti]:{fh:p.a.MoveToFolder},[l.a.ei]:{fh:p.a.OpenInMobileApp},[l.a.ii]:{fh:p.a.OpenInBrowser},[l.a.si]:{fh:p.a.OpenInClient},[l.a.oi]:{fh:p.a.PageChanged},[l.a.ri]:{fh:p.a.PushState},[l.a.hi]:{fh:p.a.RedeemForCommenting},[l.a.di]:{fh:p.a.RefreshSessionInfo},[l.a.li]:{fh:p.a.ReplyWithChanges},[l.a.pi]:{fh:p.a.SharedFilePicker},[l.a.fi]:{fh:p.a.ReportAbuse},[l.a.mi]:{fh:p.a.SaveStatus},[l.a.Oi]:{fh:p.a.Share},[l.a.gi]:{fh:p.a.ShareForm},[l.a.vi]:{fh:p.a.SignIn},[l.a.yi]:{fh:p.a.UserAccessAndPermissions},[l.a.Ai]:{fh:p.a.UserActivity},[l.a.Ei]:{fh:p.a.UserEditActivity},[l.a.Pi]:{fh:p.a.Workflow},[l.a.Ui]:{fh:p.a.ZoomChanged},[l.a.Vi]:{fh:p.a.AcquireOAuthTokenTeams},[l.a.Qe]:{fh:p.a.LoadingStatus},[l.a.Bi]:{fh:p.a.SwitchNotebook},[l.a.Li]:{fh:p.a.FailedBootCheckFileInfo},[l.a.Ji]:{fh:p.a.GetTeamsUsers},[l.a.$i]:{fh:p.a.SendTeamsUserMention},[l.a.Gi]:{fh:p.a.NavigateBackToHost},[l.a.zi]:{fh:p.a.GetClientUrlComplete},[l.a.qi]:{fh:p.a.GetWebUrlComplete},[l.a.Ki]:{fh:p.a.CopyLinkComplete},[l.a.Zi]:{fh:p.a.SendConversationId},[l.a.Xi]:{fh:p.a.CloseTeamsConversation},[l.a.Qi]:{fh:p.a.PageLoaded},[l.a.bs]:{fh:p.a.InitEnd},[l.a.ws]:{fh:p.a.SplashScreenShown},[l.a.gs]:{fh:p.a.PrintRedirect},[l.a.vs]:{fh:p.a.RequestFullScreen},[l.a.js]:{fh:p.a.ShowCopilotBottomBar},[l.a.Ss]:{fh:p.a.ExternalDocumentShare}};var b=i(9),w=i(54),O=i(41),g=i(43),v=i(44);class j{get diagnostics(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}}raiseEvent(t,e){this.logger.ULS.cn(574654541,o.a.X,n.a.Info,"Raising event: "+t);try{this.ph(t,e)}catch(t){this.logger.ULS.cn(593506838,o.a.X,n.a.Error,"Event handler error: "+Object(b.b)(t))}}addActionHandler(t,e){this.mh[t]||(this.mh[t]=[]),this.mh[t].push(e)}removeActionHandler(t,e){const i=this.mh[t];if(i&&i.length>0){const t=i.indexOf(e);t>-1&&i.splice(t,1)}}run(t,e,i){if(this.state===s.a.Disposed&&this.backgroundSession)return this.logger.ULS.cn(525203609,o.a.X,n.a.Info,"Redirecting to background session: "+t),this.backgroundSession.run(t,e,i);const r=[],c=this.mh[t];if(c&&c.length>0)r.push(this.bh(t,e));else{const s=m[t];if(s){const c=s.uh,a=s.lh;if(c){this.logger.ULS.cn(574654542,o.a.X,n.a.Info,"Running flow: "+c);const s=this.wh[c](t,e,this,this.Oh[c],i).catch(t=>(this.gh(c,t),{completion:"failure",errorSource:"jsapi",error:t}));r.push(s)}else a&&(this.container&&this.container.postMessage(a,e),r.push(Promise.resolve({completion:"success"})))}else r.push(Promise.resolve({completion:"failure"})),this.logger.ULS.cn(593500189,o.a.X,n.a.Warning,"Unhandled command: "+t)}return Promise.race(r)}dispose(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.je.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.mh={},!this.pendingReboot){const t=this.application.sessions,e=t.indexOf(this.session);e>-1&&t.splice(e,1)}}constructor(t,e,i,d,u,l,f){var j;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.appBootState="Unknown",this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.mh={},this.onMessage=t=>{const e=t.MessageId,i=t.Values||{},s=this.mh[e];if(s&&s.length>0)this.bh(e,i);else{const s=m[e];if(s){const r=s.uh,c=s.fh;r?(this.logger.ULS.cn(574654543,o.a.X,n.a.Info,"Running flow: "+r),this.wh[r](e,i,this,this.Oh[r]).catch(t=>{this.gh(r,t)})):c&&(c===p.a.Share&&(i.sendTimeAsClickTime=t.SendTime),this.raiseEvent(c,i))}}},this.gh=(t,e)=>{this.logger.ULS.cn(596459925,o.a.X,n.a.Error,`${t} flow error: ${Object(b.b)(e)}`),this.remoteTelemetryUrl&&Object(r.c)(this.remoteTelemetryUrl,this.appInfo.name,"flowException")},this.bh=(t,e)=>{this.logger.ULS.cn(574654544,o.a.X,n.a.Info,"Dispatching action: "+t);const i=this.mh[t].slice().reverse();for(let s=i.length-1;s>-1;s-=1)try{i[s](t,e)}catch(e){this.logger.ULS.cn(596444186,o.a.X,n.a.Error,`${t} action handler error: ${Object(b.b)(e)}`)}return Promise.resolve({completion:"success"})},this.state=s.a.Unknown;const[S,I]=Object(w.a)();this.isLoggerFromOwl=!!i.logger,this.logger=null!==(j=i.logger)&&void 0!==j?j:Object(c.a)(),this.logger.ULS.cn(593506837,o.a.X,n.a.Info,JSON.stringify(I)),this.sessionId=S,this.hostSessionId=i.hostSessionId,this.host=t.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=t.user,this.bootstrapperUrl=t.bootstrapperUrl,this.ui=t.ui||{},this.viewMode=t.viewMode,this.application=d,this.appInfo=e,this.session=u,this.featureManager=Object(a.a)(t.host.capabilities&&t.host.capabilities.isFeatureEnabledCallback,this.logger),this.je=new h.a(e.name,this.logger),this.preloader=e.preloader,[this.wh,this.Oh]=l(this.featureManager),this.ph=f,this.clientDiagnostics=Object(O.c)(),this.pageStateObserver=new g.a(this.logger,!0),this.authTokenTrustValidator=new v.a(this.logger)}}class S{get id(){return this.vh.sessionId}get diagnostics(){return this.vh.diagnostics}run(t,e,i){return this.vh.run(t,e,i)}boot(t,e){return this.vh.run(u.a.boot,t,e)}dispose(t){return this.vh.run(u.a.dispose,void 0,t)}constructor(t,e,i,o,n,r){!function(t){if(!t)throw new TypeError("SessionInitParams");if(!t.hostSessionId)throw new TypeError("HostSessionId")}(i),this.vh=new j(t,e,i,o,this,r,(t,e)=>n({type:t,data:e,session:this})),this.vh.state=s.a.Initialized}}var I=i(84),_=i(38),C=i(18);class T{get name(){return this.jh.name}get version(){return Object(C.a)()}addEventListener(t){this.Sh.add(t)}removeEventListener(t){this.Sh.remove(t)}createContainer(t){const e=`WacFrame_${this.jh.name}_${this.containers.length}`,i=new I.a(t,e);return this.containers.push(i),i}createSession(t){const e=new S(this.Ih,this.jh,t,this,this._h,this.Ch);return this.sessions.push(e),e}dispose(t){const e=this.sessions.map(e=>e.dispose(t).catch(t=>{}));return Promise.all(e).then(t=>(this.Sh.removeAll(),this.sessions=[],this.containers=[],{completion:"success"}))}constructor(t,e,i){this.sessions=[],this.containers=[],this._h=t=>{this.Sh.dispatch(t)},function(t){if(!t)throw new TypeError("ApplicationInitParams");const e=t.host;if(!e||!e.storageHostName)throw new TypeError("HostInfo");const i=t.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(t),this.Ih=t,this.jh=e,this.Ch=i,this.Sh=new _.a,Object(C.b)(t.host.owlVersion)}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i(9);function o(){const t=new Uint8Array(31),e=function(t){const e={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){e.crypto=!0;try{return i.getRandomValues(t),e}catch(t){e.exceptions.push("crypto: "+Object(s.b)(t))}}e.perfNow=!0;for(let i=0;i<t.length;i+=1){try{let t=Math.floor(100*window.performance.now())%10;(t<0||t>9)&&(t=0);for(let e=0;e<t;e+=1)Math.random()}catch(t){e.exceptions.push("Math.random: "+Object(s.b)(t))}t[i]=Math.floor(16*Math.random())}return e}(t);let i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const s=15&t[i];return i+=1,("x"===e?s:3&s|8).toString(16)}),e]}},function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return c}));var s,o=i(37),n=i(18);function r(t,e,i,s=!0){const n={type:e.toString(),payloadJson:JSON.stringify(i)};Object(o.a)(JSON.stringify(n),t,s)}function c(t,e,i){r(t,s.JSAPI_STATE,{application:e,build:Object(n.a)(),state:i})}!function(t){t.JSAPI_STATE="JSAPI_STATE",t.H_V2="H_V2"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"d",(function(){return h})),i.d(e,"e",(function(){return d})),i.d(e,"c",(function(){return u})),i.d(e,"b",(function(){return l})),i.d(e,"f",(function(){return f}));var s,o=i(0),n=i(1),r=i(8),c=i(5),a=i(9);function h(t,e,i,s,o,n,r,c,a,h){t.style.top="0",t.style.bottom="0",t.style.left="0",t.style.right="0",t.style.height="100%",t.style.width="100%";const u=t.ownerDocument,l=u.createElement("iframe");if(l.id=e,l.name=e,l.src="",l.title="Office on the web Frame",l.marginWidth="0",l.marginHeight="0",l.style.top="0",l.style.bottom="0",l.style.left="0",l.style.right="0",l.style.height="100%",l.style.width="100%",l.style.display="block",l.style.position="absolute",l.style.backgroundColor="transparent",l.style.border="none",l.frameBorder="0",l.setAttribute("allowfullscreen","true"),l.setAttribute("allowTransparency","true"),l.setAttribute("allow",i),d(l,r),s&&(t.style.minHeight=s,l.style.minHeight=s),o&&(t.style.minWidth=o,l.style.minWidth=o),c&&l.setAttribute("role","none"),n){const e=u.createElement("div");e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%",e.style.backgroundColor="#393a3d",e.style.backfaceVisibility="hidden",s&&(e.style.minHeight=s),o&&(e.style.minWidth=o),e.appendChild(l),t.appendChild(e)}else t.appendChild(l);return a&&l.addEventListener("load",a,{once:!0}),h&&l.addEventListener("error",h,{once:!0}),l}function d(t,e){Object(r.c)()===r.a.Safari?t.style.display=e?"none":"block":t.style.visibility=e?"hidden":"visible"}function u(t,e,i,s,o){const n=t.ownerDocument,r=n.createElement("form");r.id=i,r.name=i,r.action=s,r.target=e,r.method="POST";for(const t in o){const e=n.createElement("input");e.type="hidden",e.name=t,e.value=o[t],r.appendChild(e)}return t.appendChild(r),r}function l(t,e,i){Object(c.a)(e,s.Th,String(i?window.outerHeight:t.offsetHeight)),Object(c.a)(e,s.yh,String(i?window.outerWidth:t.offsetWidth)),Object(c.a)(e,s.Ah,String(Object(r.h)())),Object(c.a)(e,s.Eh,String(Object(r.d)())),Object(c.a)(e,s.Ph,String(Object(r.i)())),Object(c.a)(e,s.Uh,String(Object(r.k)())),Object(c.a)(e,s.Rh,String(Object(r.j)())),Object(c.a)(e,s.Wh,String(Object(r.b)())),Object(c.a)(e,s.Fh,String(window.innerHeight)),Object(c.a)(e,s.Mh,String(window.innerWidth))}function f(t){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(e){return t&&t.ULS.cn(591525084,o.a.X,n.a.Info,"Trust check error: "+Object(a.b)(e)),!1}}!function(t){t.hr="access_token",t.dr="access_token_ttl",t.ur="wac_token",t.lr="bundleSrc",t.pr="bundleStaleness",t.Ur="DocID",t.kh="SiteID",t.Nh="WebID",t.Rr="ETag",t.Cr="feature_status",t.wr="fileExtension",t.mr="fileGetUrl",t.br="customFontCatalogUrl",t.Or="fileName",t.gr="fileSize",t.Ph="forceSLR",t.Th="frameHeightPx",t.yh="frameWidthtPx",t.Eh="highContrast",t.yr="highDpi",t._r="host_diagnostics",t.Er="hostName",t.Tr="huictrls",t.jr="owner_id",t.Sr="sc",t.Ar="softBlockedBrowser",t.Pr="templateUrl",t.Ah="touchMode",t.vr="user_id",t.xh="hfck",t.Hh="hfcv",t.Dh="timeZoneId",t.Uh="darkCssMedia",t.Wh="forcedColors",t.Rh="prefersContrast",t.Wr="caae",t.Mr="meetingId",t.kr="meetingTitle",t.Nr="meetingType",t.Vh="scheduledStartTime",t.xr="scheduledEndTime",t.Vr="isPresenter",t.Dr="meetingOrganizerId",t.Hr="meetingJoinUrl",t.Br="isMeetingTeamsRoom",t.qr="jsapibuild",t.Lr="owlver",t.Jr="owlro",t.Fr="caaemode",t.Kr="traceparent",t.Zr="tracestate",t.Ir="supports_zipit",t.$r="sipcn",t.Gr="devcs",t.zr="dceit",t.Fh="frameInnerHeightPx",t.Mh="frameInnerWidthPx"}(s||(s={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var s=i(0),o=i(1),n=i(14),r=i(15);class c{setFrameError(){this.Bh=!0}setTimeoutStage(t){this.Lh=t,this.Jh="Boot_HeartBeat_"+t+(this.Bh?"_FrameError":"")}restart(){const t=this.$h.getValue(n.a.Rs,!1);this.Gh=Object(r.b)()+(this.zh?this.zh:this.$h.getValue(n.a.Is,6e5));const e=this.Qn?3e3:5e3;this.qh=window.setInterval(()=>{t&&this.Wn.ULS.cn(595724178,s.a.X,o.a.Info,this.Jh),Object(r.b)()>this.Gh&&(this.stop(),this.Kh(),this.Zh&&this.Zh())},this.$h.getValue(n.a.Us,e)),this.Xh.push(window.setTimeout(this.Kh,this.$h.getValue(n.a._s,3e4),1)),this.Xh.push(window.setTimeout(this.Kh,this.$h.getValue(n.a.Cs,12e4),2)),this.Xh.push(window.setTimeout(this.Kh,this.$h.getValue(n.a.Ts,18e4),3))}stop(){this.Gh=0,this.qh&&(window.clearInterval(this.qh),this.qh=void 0),this.Xh.forEach(t=>{window.clearTimeout(t)}),this.Xh=[]}constructor(t,e,i,n,r){this.Gh=0,this.Xh=[],this.Qn=!1,this.Jh="Boot_HeartBeat",this.Bh=!1,this.Lh="FrameCreated",this.Kh=t=>{const e="Boot_NotComplete_"+(t||"Final")+"_"+this.Lh+(this.Bh?"_FrameError":"");this.Wn.ULS.cn(594901218,s.a.X,o.a.Warning,e),this.Wn.ULS.flush()},this.Qn=t,this.$h=e,this.Wn=i,this.Zh=n,this.zh=r,this.restart()}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return c}));var s=i(7),o=i(0),n=i(1);function r(t){localStorage.setItem(t.flightKey,t.flightValue.toString())}const c=(t,e,i,c,a)=>t!==s.a.Os?Promise.reject("Wrong flow"):new Promise(t=>{const s=e.flightKey,c=e.flightValue;i.logger.ULS.cn(507343134,o.a.Pt,n.a.Info,`setWacFlightValue ${s}: ${c}`),r(e),t({completion:"success"})})},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return r}));var s=i(7),o=i(16);function n(t){const e=window.navigator;if(e&&e.virtualKeyboard&&void 0!==e.virtualKeyboard.overlaysContent&&window===top)return e.virtualKeyboard.overlaysContent=t}const r=(t,e,i,r,c)=>t!==s.a.wi?Promise.reject("Wrong flow"):new Promise(t=>{n(e.overlayContent),i.container&&i.container.postMessage(o.a.zo,void 0),t({completion:"success"})})},function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return h}));var s=i(7),o=i(16),n=i(0),r=i(1),c=i(17);function a(t){return Object(c.b)(t.hostKey)}const h=(t,e,i,c,h)=>t!==s.a.Ke?Promise.reject("Wrong flow"):new Promise(t=>{const s=e.hostKey;i.logger.ULS.cn(574408915,n.a.X,r.a.Info,"getHostKeyValue "+s);const c=a(e);i.container&&i.container.postMessage(o.a.Io,{hostKey:s,hostValue:c}),t({completion:"success"})})},function(t,e,i){"use strict";i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return a}));var s=i(7),o=i(0),n=i(1),r=i(17);function c(t){Object(r.d)(t.hostKey,t.hostValue,r.c)}const a=(t,e,i,r,a)=>t!==s.a.ji?Promise.reject("Wrong flow"):new Promise(t=>{const s=e.hostKey,r=e.hostValue;i.logger.ULS.cn(574408914,o.a.X,n.a.Info,`storeHostKeyValue ${s}: ${r}`),c(e),t({completion:"success"})})},function(t,e,i){"use strict";function s(t,e,i,s){const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{s&&s(o)}finally{null!=o&&(o.onreadystatechange=()=>{})}}},o.open("POST",t);for(const t in i)o.setRequestHeader(t,i[t]);o.send(e)}i.d(e,"a",(function(){return s}))},function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return l})),function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(s||(s={}));var o=i(1);var n=i(37),r=i(15),c=i(18);class a{getTimeSpentLogging(){return this.Qh}addLoggingTime(t){this.Qh+=t}configure(t){const e=Object(r.b)();if(t.uploadCadenceInMs&&(this.Yh=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.td=t.uploadTriggerSize),t.sessionId&&(this.ed=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.sd)throw new Error("Remote ULS endpoint is already set");this.sd=this.od(t.remoteUlsEndpoint),this.nd=Object(r.a)(),this.rd()}this.Qh+=Object(r.b)()-e}handleTrace(t){const e=Object(r.b)();t.message.length>3072&&(t.message=t.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.hd.push(t),(this.hd.length>this.td||t.level===o.a.Error)&&this.rd(),this.Qh+=Object(r.b)()-e}getUserSessionId(){return this.ed}constructor(t){this.Yh=3e4,this.td=30,this.dd=0,this.hd=[],this.nd=Object(r.a)(),this.ud=[],this.ed="",this.Qh=0,this.flushOnClose=()=>{this.ld(!1,!1)},this.flush=()=>{this.rd()},this.flushAndSetNewEndpoint=(t,e)=>{var i;const s=this.od(t);s.localeCompare(null!==(i=this.sd)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(this.ud.push(()=>{this.sd=s,e&&e()}),this.ld(!0,!0))},this.updateEndpointAndFlush=t=>{this.sd=this.od(t),this.ld(!0,!0)},this.od=t=>t+"?usid="+this.ed+"&officeserverversion="+Object(c.a)(),this.rd=()=>{window.setTimeout(()=>this.ld(!0,!0),0)},this.ld=(t,e)=>{const i=Object(r.b)();if(window.clearTimeout(this.mc),this.sd){if(this.hd.length>0){this.dd+=1;const i=function(t,e,i,s){const o=[],n=t.map(t=>function(t,e,i){const s={};if(s.G=t.tag,s.T=t.timestamp-e,s.M=t.message,s.C=t.category,t.correlationId){let e=i.findIndex(e=>e===t.correlationId);e<0&&(e=i.push(t.correlationId)-1),s.I=e}const o=1e3*t.type+t.level;return s.D=o,s}(t,s,o)),r=function(t,e,i,s,o){const n={};return n.T=t,n.L=e,n.S=i,n.I=s,o&&o.length>0&&(n.W=o),n.V=1,n}(s,n,e,i,o);return JSON.stringify(r)}(this.hd.splice(0,t?this.td:this.hd.length),this.ed,this.dd,this.nd);Object(n.a)(i,this.sd,e),this.nd=Object(r.a)()}0===this.hd.length&&this.ud.length>0&&(this.ud.forEach(t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):window.setTimeout(t,0)}),this.ud=[]),t&&(this.mc=window.setTimeout(()=>{this.rd()},this.hd.length>this.td||this.ud.length>0?1e3:this.Yh)),this.Qh+=Object(r.b)()-i}},t&&this.configure(t)}}let h,d=[];var u=i(14);function l(t){const e=new a(t);function i(t,i,o,n){const c=Object(r.b)();if(function(t){return 1===d[t]}(t))return;const a={timestamp:Object(r.a)(),category:i,tag:t,level:o,type:s.Trace,message:n,correlationId:""};e.addLoggingTime(Object(r.b)()-c),e.handleTrace(a)}return{ULS:{cn:(t,e,s,o)=>{i(t,e,s,o)},shipAssertTag:(t,e,s,n)=>{s&&i(t,e,o.a.Error,n)},debugAssertTag:(t,e,i,s)=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose,setCorrelationId:()=>{}},configure:t=>{e.configure(t)},settingsChangeHandler:t=>{var i,s;i=t.je.getValue(u.a.As,""),s=t.je.getValue(u.a.ys,""),h&&s===h||(d=[],h=s,i&&i.split(",").forEach(t=>{const e=parseInt(t,10);e&&(d[e]=1)})),e.configure({uploadCadenceInMs:t.je.getValue(u.a.Ws,6e4)});const o=t.je.getValue(u.a.Ms,"").toString();""!==o&&e.flushAndSetNewEndpoint(o)},getTimeSpentLogging:()=>e.getTimeSpentLogging(),getUserSessionId:()=>e.getUserSessionId(),flushAndSetNewEndpoint:(t,i)=>{e.flushAndSetNewEndpoint(t,i)},updateEndpointAndFlush:t=>{e.updateEndpointAndFlush(t)}}}},,,,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e),i.d(e,"Application",(function(){return p})),i.d(e,"Viewer",(function(){return m})),i.d(e,"createApplication",(function(){return b}));var s=i(29),o=i(53),n=i(30),r=i(27),c=i(35),a=i(36),h=i(3);i.d(e,"ApplicationEvents",(function(){return h.a}));var d=i(50);i.d(e,"DocRebootSupportMode",(function(){return d.a}));var u=i(39);i.d(e,"CommandIds",(function(){return u.a}));var l=i(51);i.d(e,"EventIds",(function(){return l.a}));var f=i(52);i.d(e,"createCancellationToken",(function(){return f.b}));const p=new n.a(r.b,{forceSingleStepBoot:!1,preconnector:Object(s.a)(!0)}),m=new n.a(c.a,{forceSingleStepBoot:!0,useViewerInitializer:!0,preconnector:Object(s.a)(!0)}),b=t=>{const e={name:"Word",preconnector:Object(s.a)(!0)};return new o.a(t,e,a.a)}},,,function(t,e,i){"use strict";var s;i.d(e,"a",(function(){return s})),function(t){t.appReboot="appReboot",t.boot="boot",t.closeTab="closeTab",t.createNew="createNew",t.dispose="dispose",t.frameTrust="frameTrust",t.getAuthToken="getAuthToken",t.getHostKeyValue="getHostKeyValue",t.handleBootState="handleBootState",t.postWacToken="postWacToken",t.rename="rename",t.setOverlayContent="setOverlayContent",t.storeHostKeyValue="storeHostKeyValue",t.switchMode="switchMode",t.updateBootComplete="updateBootComplete",t.setWacFlightValue="setWacFlightValue"}(s||(s={}))},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var s=i(0),o=i(1),n=i(7),r=i(5),c=i(9),a=i(17),h=i(15),d=i(16);class u{setTargetOrigin(t){const e=Object(r.i)(t).toLowerCase();this.zn&&this.zn!==e&&this.Wn.ULS.cn(593232847,s.a.X,o.a.Warning,`Updating origin: [${Object(r.g)(this.zn)}]->[${Object(r.g)(e)}]`),this.zn=e,this.Xn=Object(r.h)(e,2),this.Qn=Object(r.n)(e),this.Yn=Object(r.o)(e)}setTargetFrame(t,e){this.fd=t,this.qn=!!e}setMessageHandler(t){this.pd=t}removeMessageHandler(){this.pd=void 0}postMessage(t,e,i){if(!this.fd||!this.fd.contentWindow)return void this.Wn.ULS.cn(593232848,s.a.X,o.a.Error,"Missing target to send message: "+t);this.Wn.ULS.cn(593232849,s.a.X,o.a.Info,"Sending message: "+t);const n={MessageId:t,SendTime:Object(h.a)(),CorrelationId:i,Values:e};this.fd.contentWindow.postMessage(JSON.stringify(n),this.zn)}dispose(){window.removeEventListener("message",this.md,!1),this.pd=void 0}constructor(t,e,i,h){var u;this.zn="",this.Xn="",this.Qn=!1,this.Yn=!1,this.qn=!1,this.tr=!1,this.md=t=>{let e,i=!1,a=!0,h="",u=!1;if(this.fd&&this.fd.contentWindow&&(i=!0,a=t.source===this.fd.contentWindow),t.origin&&(h=Object(r.h)(t.origin,2).toLowerCase(),u=h===this.Xn,!u&&this.or&&(h=Object(r.h)(t.origin).toLowerCase(),u=this.or.includes(h))),!this.Qn&&(!this.Yn||u&&a)||this.Wn.ULS.cn(593232850,s.a.X,o.a.Info,"Window: available["+i+"] valid["+a+"]; Origin: valid["+u+"] expected["+this.Xn+"] actual["+h+"]"),!u||this.qn&&!a)return;try{if("string"!=typeof t.data)return void this.Wn.ULS.cn(505771930,s.a.X,o.a.Info,"Event data is not of type string");e=JSON.parse(t.data)}catch(t){return void this.Wn.ULS.cn(593232851,s.a.X,o.a.Info,"Failed to parse event data: "+Object(c.b)(t))}const l=e.MessageId;if(l){var f;if(this.Wn.ULS.cn(593232854,s.a.X,o.a.Info,`Received message: ${l}, correlation: ${e.CorrelationId}`),l!==n.a.Ae&&l!==n.a.Qe||this.setTargetOrigin(t.origin),e.Values&&e.Values.ackExpected&&this.postMessage(d.a.uo,void 0,e.CorrelationId),this.tr&&l===n.a.fs)return window._pageTimings=null!==(f=window._pageTimings)&&void 0!==f?f:{},void(window._pageTimings[e.Values.name]=e.Values.time);if(this.pd)try{this.pd(e)}catch(t){this.Wn.ULS.cn(594556386,s.a.X,o.a.Error,"Message handler error: "+Object(c.b)(t))}else this.Wn.ULS.cn(591933923,s.a.X,o.a.Error,"No message handler")}else(this.Qn||this.Yn)&&this.Wn.ULS.cn(593232853,s.a.X,o.a.Info,"Missing message id")},this.Wn=e,this.setTargetOrigin(t),this.or=h,i&&this.setMessageHandler(i),this.tr=!(null===(u=window.location)||void 0===u||null===(u=u.search)||void 0===u||!u.match(/wdpa=1/gi))||"1"===Object(a.b)("EnableMetricLogging"),window.addEventListener("message",this.md,!1)}}var l=i(56);class f{get element(){return this.bd}get frameId(){return this.Od}get formId(){return this.gd}get isTopFrameTrusted(){return this.vd}boot(t,e,i,n,r,c,a){this.Wn=i,this.jd=new u(t,i,this.pd,n.additionalReceivingDomainList);const h=n.useAdditionalDiv,d=n.permissionsPolicy;this.Sd&&!h?(this.Sd.setAttribute("allow",d),this.Wn.ULS.cn(588793045,s.a.X,o.a.Info,"Wac frame reused")):(this.Sd=Object(l.d)(this.bd,this.Od,d,n.minHeight,n.minWidth,h,n.isInvisible,n.setNoneRole,c,a),this.Wn.ULS.cn(588793046,s.a.X,o.a.Info,"Wac frame created")),r(),this.jd.setTargetFrame(this.Sd,n.enforceSameWindow),h&&(this.Id=this.Sd.parentElement),n.useFrameFixForTeams&&i.ULS.cn(509143245,s.a.X,o.a.Info,"Frame fix enabled for teams uiHost"),Object(l.b)(this.Sd,e,n.useFrameFixForTeams),e.parentOrigin=window.origin||"",this._d=Object(l.c)(this.bd,this.Od,this.gd,t,e),this._d.submit()}setVisibility(t){this.Sd&&Object(l.e)(this.Sd,t)}setMessageHandler(t){this.pd=t,this.jd&&this.jd.setMessageHandler(t)}setWrapperPostMessage(t){this.Cd=t}removeMessageHandler(){this.pd=void 0,this.jd&&this.jd.removeMessageHandler()}postMessage(t,e){this.Cd?this.Cd(t,e):this.jd&&this.jd.postMessage(t,e)}dispose(t,e){return new Promise(i=>{if(this._d&&(this.bd.removeChild(this._d),this._d=void 0),this.jd&&(this.jd.dispose(),this.jd=void 0,this.pd=void 0),this.Cd&&(this.Cd=void 0),this.Wn=void 0,!this.Sd||!this.Id&&t)i();else{const t=()=>{this.Id?(this.Id.removeChild(this.Sd),this.bd.removeChild(this.Id)):this.bd.removeChild(this.Sd),this.Sd=void 0,this.Id=void 0,i()};e?t():(this.Sd.src="about:blank",window.setTimeout(t,0))}})}constructor(t,e){!function(t){if(!t||!t.appendChild)throw TypeError("Container")}(t),this.bd=t,this.Od=e,this.gd=e+"_Form",this.vd=Object(l.f)()}}}]);
//# sourceMappingURL=word.boot.9a68cc5ff9148b93467d.js.map