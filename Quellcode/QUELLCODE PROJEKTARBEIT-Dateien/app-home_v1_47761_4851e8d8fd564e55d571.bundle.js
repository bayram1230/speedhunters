"use strict";(self["app-home_v1_jsonp"]=self["app-home_v1_jsonp"]||[]).push([[47761],{41839:(e,t,n)=>{n.d(t,{N:()=>m}),n(39583);var r=n(86315),o=n(62399),a=n(33894),i=n(22268),s=n(70703),l=n(87558),c=n(61319),u=n(67336),d=n(40369),g=n(71124),h=n(62843);const m=e=>{let{children:t}=e;const n=(0,u.F7)(),m=(0,h.Zp)(),f=(0,d.md)(a.t),p=(0,d.md)(s.cj),E=(0,g.useContext)(r.g),v=(0,c.Y)("brsDisableGccCheck");return(0,g.useEffect)((()=>{(async()=>{if(null!==v&&f===i.k.LoggedIn&&(null==n?void 0:n.tenantId)&&null!==p){const e=p===l.$.GCC;if(p===l.$.GCCHigh||!v&&e){if(e&&E.officeAppName===o.z.OneNote)return void window.location.replace(`https://m365.cloud.microsoft/launch/onenote?username=${n.username}`);m("/denied")}}})()}),[n,f,m,v,E.officeAppName,p]),g.createElement(g.Fragment,null,t)}},1916:(e,t,n)=>{n.d(t,{J:()=>oe});var r=n(86315),o=n(62399),a=n(33894),i=n(22268),s=n(22905),l=n(70703),c=n(63280),u=n(12091),d=n(26406),g=n(27061),h=n(74661),m=n(64130);const f=(e,t)=>{let n="ecs.cache.AppHome";t.length&&t.forEach((t=>{e[t]&&delete e[t]}));const r=Object.values(e).filter((e=>null!=e));return r.length&&(n+=`.${r.join(".")}`),n};var p=n(79160);let E;class v{newLogger(e){return new S}}class S{error(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}warn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}debug(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}log(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}constructor(){}}n(39552),n(87847);var w=function(e){return e.SessionId="HP.SID",e.UserId="HP.UID",e.FlightOverridingAllowed="flightOverridingAllowed",e}({}),T=n(73957),y=n(45714);var C=function(e){return e[e.Unknown=0]="Unknown",e[e.Success=1]="Success",e[e.Failed=2]="Failed",e[e.FromCache=4]="FromCache",e[e.FromDefault=8]="FromDefault",e[e.OverridesSet=16]="OverridesSet",e[e.InvalidEnvironment=32]="InvalidEnvironment",e[e.ParsingError=64]="ParsingError",e[e.CanaryError=128]="CanaryError",e[e.CacheNotAvailable=256]="CacheNotAvailable",e}({}),A=n(87558);function N(e){switch(e){case A.$.GCC:return"https://gccmod.ecs.office.com";case A.$.GCCHigh:return"https://config.ecs.gov.teams.microsoft.us";case A.$.DoD:return"https://config.ecs.dod.teams.microsoft.us";case A.$.Gallatin:return"https://mooncake.ecs.office.com";case A.$.AirGap08:return"https://config.ecs.teams.eaglex.ic.gov";case A.$.AirGap09:return"https://config.ecs.teams.microsoft.scloud";default:return"https://config.edge.skype.com"}}async function I(e,t,n,r,a,i){const s=(()=>{switch((0,m.r)()){case o.D.Unknown:case o.D.Fastfood:return"innerring";case o.D.Dogfood:return"outerring";case o.D.Production:return"production";default:return}})(),l=performance.now();if(!s)return(0,d.a)({eventName:"ECSServiceRequest",httpCode:500,error:"ECSInvalidEnvironmentError",latency:performance.now()-l,area:"ECSService",subArea:"ECSServiceCall"}),C.InvalidEnvironment;const c=(()=>{const e=(0,y.kr)();if(e&&(()=>{const e=(0,m.r)(),t=[o.D.Unknown,o.D.Fastfood,o.D.Dogfood];return!(!e||!t.includes(e))&&(document.cookie.includes(`${w.FlightOverridingAllowed}=true`)||"true"===localStorage.getItem(T.U.FlightOverridingAllowed))})())return e.split(";").reduce(((e,t)=>{if("default"===t.toLowerCase())return{type:0,values:e.values};const n=t.split(":");return 2!==n.length?e:{type:e.type,values:[...e.values??[],{name:n[0],value:n[1]}]}}),{type:1,values:[]})})(),u={client:"WAC",version:"1.0.0.0",domain:N(i),agents:["AppHome"],filters:{environment:s,userId:r,sessionId:e,tenantId:a,application:t,UiCulture:n}},g=(e=>{var t;const n={};return null==e||null===(t=e.values)||void 0===t||t.forEach((e=>{let t;t="true"===e.value||"false"!==e.value&&(isNaN(parseFloat(e.value))?e.value:parseFloat(e.value)),n[e.name]=t})),n})(c),S=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const r={...null==e?void 0:e.filters},o={ecsParameters:e,serviceName:"AppHome",cacheConsumerKey:f(r,["sessionId","tenantId","application"]),overrides:t,ecsClientLoggerFactory:new v};return E=h.E.getInstance(),(0,p.JP)(null==e||null===(n=e.filters)||void 0===n?void 0:n.userId)?1:E.initialize(o)}(u,g);return 200==function(e){switch(e){case C.FromCache:case C.Success:case C.OverridesSet:case C.FromDefault:return 200;default:return 500}}(S)?(0,d.a)({eventName:"ECSServiceRequest",httpCode:200,latency:performance.now()-l,area:"ECSService",subArea:"ECSServiceCall"}):(0,d.a)({eventName:"ECSServiceRequest",httpCode:500,latency:performance.now()-l,area:"ECSService",subArea:"ECSServiceCall",error:`Flighting initialization failed with status ${S}`}),S}var O=n(73865),R=n(58700),P=n(17705);function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;n.expires&&(r+=`; Expires=${n.expires instanceof Date?n.expires.toUTCString():n.expires}`),r+=`; Path=${n.path||"/"}`,n.domain&&(r+=`; Domain=${n.domain}`),!1!==n.secure&&(r+="; Secure"),n.sameSite?r+=`; SameSite=${n.sameSite}`:r+="; SameSite=Strict",document.cookie=r}function k(){const e={};return decodeURIComponent(document.cookie).split(";").forEach((t=>{const[n,r]=t.trim().split("=");"HP.SID"!==n&&"HP.UID"!==n||(e[n]=r)})),e}n(39583);var M=n(65613),D=n(71363),F=n(95266);function L(){let e=(0,y.oM)();e&&(0,F.GY)(e)||(e=(0,D.W)());let t=(0,y.nQ)();t&&(0,M.W)(t)||(t=void 0);let n=(0,y.ll)();n&&(0,F.lA)(n)||(n=void 0);let r=(0,y.$Y)();var o,a;return r&&(0,F.GY)(r)||(r=void 0),e=null==e?void 0:e.toUpperCase().trim(),t=null==t?void 0:t.toLowerCase().trim(),o=null==n?void 0:n.trim(),n=null==o||null===(a=o.toLowerCase())||void 0===a?void 0:a.replace(/(?:^\w|[A-Z]|\b\w)/g,(e=>e.toUpperCase())),r=null==r?void 0:r.trim(),{wdOrigin:e,wdPreviousSession:t,wdPreviousSessionSrc:n,from:r}}var U=n(37043),_=n(3123),x=n(93936),W=function(e){return e.PC="PC",e.Mac="Mac",e.WindowsPhone="WindowsPhone",e.iPad="iPad",e.iPhone="iPhone",e.AndroidPhone="AndroidPhone",e.AndroidTablet="AndroidTablet",e.Linux="Linux",e.Chromebook="Chromebook",e.Other="Other",e}({});let H;function G(e){const t=parseInt(e);return isNaN(t)?0:t}var z=function(e){return e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Standard5g="Standard5g",e.Unknown="Unknown",e}({});let B;const $=[{keyword:"slow-2g",networkType:z.Slow2g},{keyword:"2g",networkType:z.Standard2g},{keyword:"3g",networkType:z.Standard3g},{keyword:"4g",networkType:z.Standard4g}];function q(){var e,t;if(B)return B;const n=(null===(t=window.navigator)||void 0===t||null===(e=t.connection)||void 0===e?void 0:e.effectiveType)||"Unknown";let r={keyword:"Unknown",networkType:z.Unknown};return $.some((e=>-1!==n.toLowerCase().indexOf(e.keyword)&&(r=e,!0))),B=r.networkType,B}class j{static getInstance(){return j.instance||(j.instance=new j),j.instance}async initialize(e,t,n,r,o,a,i,s){var l;if((0,_.rI)()&&!(0,x.I_)(this.currentAccount,i)&&this.currentLocale===a)return;const c=null==i||null===(l=i.idTokenClaims)||void 0===l?void 0:l.tid,{sessionId:u,wdOrigin:d,wdPreviousSession:h,wdPreviousSessionSrc:f}=r,p={isMsa:(0,x.Xu)(c),isOrgId:!(0,x.Xu)(c),puid:(0,x.Pn)(i)??"",tenantId:c||""},E=s||d||"",v=function(){switch(function(){if(H)return H;const e=window.navigator.userAgent.toLowerCase();let t={keyword:"Other",platformType:W.Other};[{keyword:"Windows NT",platformType:W.PC},{keyword:"Windows XP",platformType:W.PC},{keyword:"Macintosh",platformType:W.Mac},{keyword:"Windows Phone",platformType:W.WindowsPhone,pageName:"windows-phone"},{keyword:"iPad",platformType:W.iPad,pageName:"ipad"},{keyword:"iPhone",platformType:W.iPhone,pageName:"iphone"},{keyword:"Android",platformType:W.AndroidPhone,pageName:"android-phone"},{keyword:"Linux",platformType:W.Linux},{keyword:"CrOS",platformType:W.Chromebook}].some((n=>-1!==e.indexOf(n.keyword.toLowerCase())&&(t=n,!0))),t.platformType===W.AndroidPhone&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:W.AndroidTablet});let n={major:0,minor:0,build:0};if(t.platformType===W.Mac){const e=/Mac OS X (\d+)(_|\.)(\d+)([_.]?)(\d*)/i.exec(window.navigator.userAgent);e&&e.length>=6&&(n={major:G(e[1]),minor:G(e[3]),build:G(e[5])})}else if(t.platformType===W.PC||t.platformType===W.WindowsPhone)if(-1!==e.indexOf("windows xp"))n={major:5,minor:1,build:0};else{const e=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(window.navigator.userAgent);e&&e.length>=5&&(n={major:G(e[3]),minor:G(e[4]),build:0})}else if(t.platformType===W.iPad||t.platformType===W.iPhone){const t=e.match(/os (\d+)_(\d+)(_(\d+))?/);n={major:G(t&&t[1]),minor:G(t&&t[2]),build:G(t&&t[4])}}return H={platform:t,platformVersion:n},H}().platform.platformType){case W.AndroidPhone:return"AndroidPhone";case W.AndroidTablet:return"AndroidTablet";case W.Chromebook:return"Chromebook";case W.Linux:return"Linux";case W.Mac:return"Mac";case W.PC:return"PC";case W.WindowsPhone:return"WindowsPhone";case W.iPad:return"iPad";case W.iPhone:return"iPhone";default:return"Other"}}(),S=q(),w=(0,m.r)(),T=(0,m.K)()??"";(0,g.HC)({appName:"OfficeAppHomePages",officeAppName:e,appPlatform:"Web",appWorkload:"Web",appWorkloadType:"Web_React",appVersion:T,appLanguage:a,correlationId:n,dataBoundary:o,deploymentEnvironment:w,requestOrigin:E,sessionId:u,serviceEnvironment:t,utelAriaNameSpace:"Office.AppHome.Pages",utelAriaTenant:"73cd9ea53a48401197086beffaa61fa6-57540980-5639-41c5-a764-8e42aef126ad-6904",deviceType:v,networkType:S,identity:p,utelEnabled:!0,wdOrigin:d,wdPreviousSession:h,wdPreviousSessionSrc:f}),(0,U.Vq)([{logEvent:g.BI,flush:U.bX}]),(0,_.dL)(!0),this.currentAccount=i,this.currentLocale=a}logEvent(e,t){(0,U.$s)(e,t)}flush(){(0,U.bX)()}}j.instance=null;const K=j.getInstance();var X=n(53150),V=(n(31033),n(12661)),Q=n(13029),J=n(99324);const Y=new Map([[o.D.Fastfood,"https://odc.edog.officeapps.live.com/odc/v2.1/federationprovider"],[o.D.Dogfood,"https://odc-df.officeapps.live.com/odc/v2.1/federationprovider"],[o.D.Production,"https://odc.officeapps.live.com/odc/v2.1/federationprovider"],[o.D.Unknown,"https://odc.edog.officeapps.live.com/odc/v2.1/federationprovider"]]);var Z=n(67336),ee=n(40369),te=n(71124),ne=n(62843),re=n(5324);const oe=e=>{let{children:t}=e;const{instance:n}=(0,Z.dk)(),[d,h]=(0,ee.fp)(u.O),[f,p]=(0,ee.fp)(u.$),v=(0,ee.Xr)(l.K5),S=(0,ee.md)(a.t),T=(0,ee.md)(O.WF),C=(0,ee.md)(l.cj),A=(0,ne.zy)(),N=(0,te.useRef)(k()),M=(0,te.useContext)(r.g),D=(0,te.useRef)((0,re.A)()),F=N.current[w.SessionId]||D.current,U=(0,te.useRef)({...L(),sessionId:F,setSessionId:e=>{U.current.sessionId=e}});return(0,te.useEffect)((()=>{const e=()=>{N.current=k()};if(e(),S===i.k.Unknown||!T||!C)return void(0,g.fM)();const t=n.getActiveAccount(),r=t?(0,s.Pn)(t):null;if(r){if(N.current[w.UserId]!==r){var a,l;const t=(0,re.A)();b(w.SessionId,t),null===(a=(l=U.current).setSessionId)||void 0===a||a.call(l,t),b(w.UserId,r||""),e()}else if(!N.current[w.SessionId]){var u,y;b(w.SessionId,F),null===(u=(y=U.current).setSessionId)||void 0===u||u.call(y,F),e()}}else if(N.current[w.UserId]){var A,O;const t=(0,re.A)();b(w.SessionId,t),null===(A=(O=U.current).setSessionId)||void 0===A||A.call(O,t),function(e){const{path:t="/",domain:n,sameSite:r="Strict"}={};document.cookie=`${e}=; Path=${t}; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Secure${n?`; Domain=${n}`:""}${r?`; SameSite=${r}`:""}`}(w.UserId),e()}else if(!N.current[w.SessionId]){var D,L;b(w.SessionId,F),null===(D=(L=U.current).setSessionId)||void 0===D||D.call(L,F),e()}var _,x;N.current[w.SessionId]&&N.current[w.SessionId]!==U.current.sessionId&&(null===(_=(x=U.current).setSessionId)||void 0===_||_.call(x,N.current[w.SessionId])),d&&0!=f||(async()=>{const e=await I(U.current.wdPreviousSession||U.current.sessionId,M.officeAppName,T,(0,s.F)(t),(0,s.EO)(t),C);p(e),h(!0),R.R.markAsReady(P.S.Flights)})(),d&&void 0!==(0,g.CX)()&&async function(e){E.setTelemetryLoggerAsync(e,(0,g.p)(),(0,g.ip)())}((0,g.CX)());const W=async e=>{try{await K.initialize(M.officeAppName,C,(0,re.A)(),U.current,e,T,t??void 0),(0,g.mn)()}catch(e){console.error("Error initializing telemetry:",e)}};t?(async()=>{if((0,s.Xu)(t.tenantId))W(c.n.RoW),v(c.n.RoW);else try{const e=M.EnvironmentName==o.D.Fastfood;let n=(0,s.xk)(t);if(!e){const e=await(async(e,t,n)=>{const r={isEUBD:!1};let o=!1;try{const o=(0,J.A)(Y.get(e),`?domain=${t}`),a=await fetch(o,{headers:{"X-Office-Application":"160","X-Office-Platform":"Web","X-Office-Version":(0,m.K)(),"X-CorrelationId":n,"Enlightened-Hrd-Client":"1"}}),i=await a.json();i&&(null==i?void 0:i.configProviderName)&&-1!==(null==i?void 0:i.configProviderName.toLowerCase().indexOf("eudb"))&&(r.isEUBD=!0)}catch(e){(0,V.v)({eventName:"FetchHRDError",errorType:"HRD_Error",message:e instanceof Error?e.message:"Error fetching HRD data",debugInfo:null==e?void 0:e.toString()}),r.isEUBD=!0,o=!0}return r.isEUBD&&(0,Q.t)({featureName:"HRD",message:`${c.n.EU} with HRD API hasError: ${o}`}),r})(M.EnvironmentName,(0,s.EO)(t),U.current.sessionId);n=(null==e?void 0:e.isEUBD)?c.n.EU:c.n.RoW}W(n),v(n)}catch(e){console.error("Error fetching EUDB status:",e),W(c.n.EU),v(c.n.EU)}})():W(c.n.RoW)}),[n,M,F,d,S,f,T,v]),(0,te.useEffect)((()=>{(0,y.mZ)(),(0,y.kr)()&&h(!1)}),[A.search,h]),te.createElement(X.I.Provider,{value:U.current},t)}},46560:(e,t,n)=>{n.d(t,{k:()=>R});var r=n(33894),o=n(22905),a=n(22268),i=n(73865);const s={af:"af-za",am:"am-et",ar:"ar-sa","as-in":"as-in","az-latn-az":"az-latn-az","be-by":"be-by",bg:"bg-bg","bn-bd":"bn-bd","bn-in":"bn-in","bs-latn-ba":"bs-latn-ba","ca-es-valencia":"ca-es-valencia",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr","en-gb":"en-gb","en-us":"en-us","es-mx":"es-mx",es:"es-es",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph","fr-ca":"fr-ca",fr:"fr-fr","ga-ie":"ga-ie","gd-gb":"gd-gb",gl:"gl-es",gu:"gu-in","ha-latn-ng":"ha-latn-ng",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",hy:"hy-am",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",ka:"ka-ge",kk:"kk-kz","km-kh":"km-kh",kn:"kn-in",ko:"ko-kr",kok:"kok-in",ky:"ky-kg","lb-lu":"lb-lu","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv","mi-nz":"mi-nz",mk:"mk-mk",ml:"ml-in","mn-mn":"mn-mn",mr:"mr-in",ms:"ms-my","mt-mt":"mt-mt","ne-np":"ne-np",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",or:"or-in","pa-in":"pa-in",pl:"pl-pl",prs:"prs-af","pt-pt":"pt-pt",pt:"pt-br","quz-pe":"quz-pe",ro:"ro-ro",ru:"ru-ru","sd-arab-pk":"sd-pk","si-lk":"si-lk",sk:"sk-sk",sl:"sl-si",sq:"sq-al","sr-cyrl-ba":"sr-cyrl-ba","sr-cyrl":"sr-cyrl-rs",sr:"sr-latn-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th","tk-tm":"tk-tm",tr:"tr-tr",tt:"tt-ru","ug-cn":"ug-cn",uk:"uk-ua",ur:"ur-pk",uz:"uz-uz",vi:"vi-vn","zh-hans":"zh-hans","zh-hant":"zh-hant","zu-za":"zu-za"},l=(Object.fromEntries(Object.entries(s).map((e=>{let[t,n]=e;return[n,t]}))),["af-za","am-et","ar-sa","as-in","az-latn-az","be-by","bg-bg","bn-bd","bn-in","bs-latn-ba","ca-es","ca-es-valencia","cs-cz","cy-gb","da-dk","de-de","el-gr","en-gb","en-us","es-es","es-mx","et-ee","eu-es","fa-ir","fi-fi","fil-ph","fr-ca","fr-fr","ga-ie","gd-gb","gl-es","gu-in","ha-latn-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","is-is","it-it","ja-jp","ka-ge","ky-kg","kk-kz","km-kh","kn-in","ko-kr","kok-in","lb-lu","lo-la","lt-lt","lv-lv","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","nb-no","ne-np","nl-nl","nn-no","or-in","pa-in","pl-pl","prs-af","pt-br","pt-pt","quz-pe","ro-ro","ru-ru","sd-pk","si-lk","sk-sk","sl-si","sq-al","sr-cyrl-ba","sr-cyrl-rs","sr-latn-rs","sv-se","sw-ke","ta-in","te-in","th-th","tk-tm","tr-tr","tt-ru","ug-cn","uk-ua","ur-pk","uz-uz","vi-vn","zh-hans","zh-hant","zu-za"]),c=e=>l.indexOf(e)>=0,u=e=>s[e];n(48419),n(72803),n(80111),n(83734),n(32909),n(57184);var d=n(99324);function g(e){const t=e.pathname.split("."),n=t.length>1?t.pop():"",r=n&&["html","xml","txt","png","jpg","jpeg","gif","svg","webp","sass","scss","css","js","jsx","json","ts","tsx"].includes(n);return e.pathname.endsWith("/")||r||(e.pathname+="/"),e}n(39552);var h=n(69767);const m=e=>{window.location.href!==e&&(window.history.replaceState?window.history.replaceState({path:e},"",e):window.location.href=e)};var f=n(75558),p=n(58700),E=n(17705),v=n(43176),S=n(41932),w=n(5324),T=n(22566);var y=n(60968),C=n(81416),A=n(83337),N=n(67336),I=n(40369),O=n(71124);const R=e=>{let{children:t}=e;const n=(0,N.F7)(),[s,l]=(0,O.useState)((0,y.eQ)()),R=(0,I.md)(r.t),P=(0,I.Xr)(i.WF),b=(0,O.useCallback)((async()=>{sessionStorage.removeItem(v.l.AuthLocalePreference);const e=await(0,y.ex)(),t=u(e??"en-us");P(t),(e=>{let t=new URL(window.location.href);const n=t.pathname.split("/"),r=n[1]??"";if(!c(r)||!h.i9.has(r)){t.pathname=(0,d.A)(e,...n.slice(1)),t=g(t);const r=t.toString();m(r)}})(t),p.R.markAsReady(E.S.Localization)}),[P]),k=(0,O.useCallback)((async()=>{(()=>{let e=new URL(window.location.href);const t=e.pathname.split("/"),n=t[1]??"";if(c(n)){e.pathname=(0,d.A)(...t.slice(2)),e=g(e);const n=e.toString();m(n)}})();const e=sessionStorage.getItem(v.l.AuthLocalePreference);let t;if(e&&c(e))t=e;else{let e;if((0,o.Xu)((0,o.EO)(n)))e=[...navigator.languages.map((e=>({option:e,checkStrictly:!1})))];else{var r,a;const t=await(async e=>{try{return await(async e=>{let t=null;try{const n=new AbortController,r=(0,T.K)().api("/me/settings/regionalAndLanguageSettings").version("beta").header(S.X.Area,"GraphService").header(S.X.SubArea,e).header(S.X.CorrelationId,(0,w.A)()).header(S.X.APIName,"GetRegionalAndLanguageSettings").options({signal:n.signal}).get();return t=setTimeout((()=>{n.abort("Request timed out")}),5e3),await r}finally{t&&clearTimeout(t)}})(e)}catch(e){return null}})("Localization");e=[{option:null==t||null===(r=t.defaultDisplayLanguage)||void 0===r?void 0:r.locale,checkStrictly:!1},{option:null==n||null===(a=n.idTokenClaims)||void 0===a?void 0:a.xms_pl,checkStrictly:!1},...navigator.languages.map((e=>({option:e,checkStrictly:!1})))]}t=(e=>{for(const{option:t,checkStrictly:n}of e)if(t)if(n){if(c(t)&&h.i9.has(t))return t}else try{const e=(0,f.U5)(t);if(e){const t=u(e);if(h.i9.has(t))return t}}catch{}return"en-us"})(e),sessionStorage.setItem(v.l.AuthLocalePreference,t)}const i=(0,f.U5)(t);i!==await(0,y.ex)()&&(await(0,y.Gd)(i),l((0,y.eQ)())),P(t),p.R.markAsReady(E.S.Localization)}),[P,n]);return(0,O.useEffect)((()=>{R===a.k.LoggedIn?k():R===a.k.LoggedOut&&b()}),[n,R,k,b]),O.createElement(A.G,{lookupString:(0,C.zB)(s)},t)}},830:(e,t,n)=>{n.d(t,{K:()=>c}),n(39583);var r=n(8466);class o extends r.c{async navigateInternal(e,t){const n=e.replace(window.location.origin,"");return t.noHistory?this.navigate(n,{replace:!0}):this.navigate(n),!1}constructor(e){super(),this.navigate=e}}var a=n(35530),i=n(67336),s=n(71124),l=n(62843);const c=e=>{let{children:t}=e;const n=(0,l.Zp)(),r=new o(n);return a.Jp.setNavigationClient(r),s.createElement(i.r7,{instance:a.Jp},t)}},98269:(e,t,n)=>{n.d(t,{A:()=>b}),n(4589);var r=n(86315),o=n(62399),a=n(79927),i=n(97565),s=n(71124),l=n(75380),c=n(12661),u=n(62843);const d=()=>{const e=(0,u.r5)();return e&&(0,c.v)({debugInfo:e.toString(),eventName:"ErrorBoundary",errorType:"ErrorBoundary_Error"}),s.createElement("div",null,"Error")};var g=n(61319);const h=e=>{let{children:t,flight:n,fallbackTo:r="/"}=e;const o=(0,g.Y)(n);return null===o?null:o?s.createElement(s.Fragment,null,t):s.createElement(u.C5,{to:r,replace:!0})},m=s.lazy((()=>Promise.all([n.e(64644),n.e(10050),n.e(59669),n.e(92008),n.e(31137),n.e(94055)]).then(n.bind(n,94055)))),f=s.lazy((()=>Promise.all([n.e(64644),n.e(95370),n.e(42294),n.e(10050),n.e(92008),n.e(93901),n.e(43512),n.e(51566),n.e(99799),n.e(41589),n.e(47384),n.e(13589),n.e(3103)]).then(n.bind(n,3103)))),p=s.lazy((()=>Promise.all([n.e(64644),n.e(7770),n.e(41925),n.e(76390),n.e(95370),n.e(42294),n.e(60619),n.e(10050),n.e(75215),n.e(59669),n.e(97033),n.e(62097),n.e(92008),n.e(93901),n.e(61828),n.e(45259),n.e(43512),n.e(51566),n.e(63666),n.e(68001),n.e(14219),n.e(99799),n.e(41589),n.e(47384),n.e(59837),n.e(13589),n.e(36810),n.e(15126),n.e(75477),n.e(40482)]).then(n.bind(n,40482)))),E=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(59837),n.e(66062)]).then(n.bind(n,66062)))),v=s.lazy((()=>Promise.all([n.e(64644),n.e(69925),n.e(44956),n.e(76390),n.e(88410),n.e(95370),n.e(54144),n.e(42294),n.e(10050),n.e(75215),n.e(11242),n.e(49421),n.e(6735),n.e(97033),n.e(92008),n.e(93901),n.e(43512),n.e(43379),n.e(86668),n.e(86191),n.e(86945),n.e(88762),n.e(51566),n.e(66235),n.e(99799),n.e(41589),n.e(47384),n.e(59837),n.e(13589),n.e(68007),n.e(95653)]).then(n.bind(n,93518)))),S=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(59837),n.e(81674)]).then(n.bind(n,81674)))),w=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(69789)]).then(n.bind(n,69789)))),T=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(56016),n.e(59812),n.e(79243)]).then(n.bind(n,79243)))),y=s.lazy((()=>Promise.all([n.e(64644),n.e(69925),n.e(95370),n.e(42294),n.e(10050),n.e(68006),n.e(92008),n.e(93901),n.e(43512),n.e(41713),n.e(99799),n.e(41589),n.e(47384),n.e(59837),n.e(13589),n.e(56016),n.e(99079),n.e(43387),n.e(62944),n.e(43967)]).then(n.bind(n,73375)))),C=s.lazy((()=>Promise.all([n.e(64644),n.e(69925),n.e(7770),n.e(41925),n.e(44956),n.e(76390),n.e(88410),n.e(95370),n.e(54144),n.e(42294),n.e(60619),n.e(10050),n.e(45063),n.e(75215),n.e(59669),n.e(84794),n.e(11242),n.e(21827),n.e(68006),n.e(49421),n.e(98815),n.e(76371),n.e(6735),n.e(97033),n.e(62097),n.e(92008),n.e(86324),n.e(93901),n.e(45259),n.e(43512),n.e(43379),n.e(40188),n.e(86668),n.e(9514),n.e(67592),n.e(23971),n.e(60869),n.e(4986),n.e(55130),n.e(97729),n.e(17692),n.e(68044),n.e(8910),n.e(26388),n.e(5975),n.e(70723),n.e(14079),n.e(35774)]).then(n.bind(n,35774)))),A=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(59837),n.e(56016),n.e(99079),n.e(43387),n.e(62944),n.e(98258),n.e(66327)]).then(n.bind(n,50183)))),N=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(57468)]).then(n.bind(n,57468)))),I=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(72742),n.e(40035)]).then(n.bind(n,40035)))),O=s.lazy((()=>Promise.all([n.e(99799),n.e(41589),n.e(72742),n.e(66367)]).then(n.bind(n,66367)))),R=s.lazy((()=>Promise.all([n.e(64644),n.e(76390),n.e(95370),n.e(10050),n.e(61828),n.e(45259),n.e(63666),n.e(99799),n.e(41589),n.e(46154)]).then(n.bind(n,46154)))),P=s.lazy((()=>Promise.all([n.e(45063),n.e(76371),n.e(99799),n.e(41589),n.e(59837),n.e(56016),n.e(99079),n.e(43387),n.e(62944),n.e(91451),n.e(98258),n.e(92781)]).then(n.bind(n,30489)))),b=e=>{let{pageThemes:t,wrapper:n}=e;const u=(0,s.useContext)(r.g),g=(0,s.useCallback)((e=>{const{route:n,element:r,useShell:o=!1}=e;return o?{element:s.createElement(m,{pageThemes:t}),children:[{path:n,element:r}]}:{path:n,element:r}}),[t]),b=(0,s.useMemo)((()=>[{route:"/:locale?/*",element:s.createElement(f,null),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint]),useShell:!0},{route:"/:locale?/*",element:s.createElement(p,null),apps:new Set([o.z.OneNote]),useShell:!0},{route:"/denied",element:s.createElement(N,null),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint,o.z.OneNote])},{route:"/:locale?/signup",element:s.createElement(E,{mode:a.T.Signup,pageName:i.L.SignUp}),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint,o.z.OneNote])},{route:"/:locale?/signin",element:s.createElement(E,{mode:a.T.Signin,pageName:i.L.SignIn}),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint,o.z.OneNote])},{route:"/:locale?/new",element:s.createElement(h,{flight:"brsRedirectPageEnabled"},s.createElement(A,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint,o.z.OneNote])},{route:"/:locale?/search/:searchQuery",element:s.createElement(v,null),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint]),useShell:!0},{route:"/signout",element:s.createElement(h,{flight:"brsSignoutPageEnabled"},s.createElement(S,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint,o.z.OneNote])},{route:"/open/*",element:s.createElement(h,{flight:"brsOpenPageEnabled"},s.createElement(w,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint,o.z.OneNote])},{route:"/open/onedrive/error",element:s.createElement(h,{flight:"brsOpenPageEnabled"},s.createElement(I,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint,o.z.OneNote])},{route:"/:locale?/edit",element:s.createElement(h,{flight:"brsEditPageEnabled"},s.createElement(T,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint])},{route:"/:locale?/edit/error",element:s.createElement(h,{flight:"brsEditPageEnabled"},s.createElement(O,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint])},{route:"/upload-resume",element:s.createElement(y,null),apps:new Set([o.z.Word]),useShell:!0},{route:"/:locale?/upload/",element:s.createElement(y,null),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint]),useShell:!0},{route:"/chat",element:s.createElement(h,{flight:"brsShowCopilotPage"},s.createElement(C,{pageThemes:t})),apps:new Set([o.z.Word]),useShell:!0},{route:"/:locale?/handoff/chatgpt",element:s.createElement(h,{flight:"brsHandoffGPTPageEnabled"},s.createElement(R,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint]),useShell:!0},{route:"/:locale?/handoff/marketing",element:s.createElement(h,{flight:"brsHandoffMarketingPageEnabled"},s.createElement(P,null)),apps:new Set([o.z.Word,o.z.Excel,o.z.PowerPoint])}]),[t]),k=(0,s.useMemo)((()=>{const e=[];for(const t of b)t.apps.has(u.officeAppName)&&e.push(g(t));return e}),[u.officeAppName,b,g]),M=(0,s.useMemo)((()=>(0,l.Ys)([{element:n,children:k,errorElement:s.createElement(d,null)}])),[n,k]);return function(){const e=window;(void 0!==e.trustedTypes&&void 0!==e.trustedTypes.createPolicy?e.trustedTypes:{createPolicy:(e,t)=>t}).createPolicy("ocvPolicy",{createscript:e=>e.startsWith("https://clients.config.office.net")?e:((0,c.v)({eventName:"TrustedTypes_OCVUrlViolation",errorType:"TrustedTypes_Error",message:"Error in loading feedback package.",debugInfo:"Trusted-types error: Script path does not match ocpsUrl in config for unauth"}),"")})}(),s.createElement(l.pg,{router:M})}},73705:(e,t,n)=>{n.d(t,{S:()=>f}),n(31033);var r=n(62399),o=n(64130),a=n(33894),i=n(22268),s=n(87558),l=n(70703),c=n(26406),u=n(5324);const d=n(72618).A.create({baseURL:"https://login.microsoftonline.com",timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/json"}});n(39552);var g=n(67336),h=n(40369),m=n(71124);const f=e=>{let{children:t}=e;const n=(0,g.F7)(),f=(0,h.md)(a.t),p=(0,h.Xr)(l.cj),E=(e=>{switch(e){case r.D.Fastfood:return s.$.Fastfood;case r.D.Dogfood:return s.$.Dogfood;case r.D.Production:return s.$.Production;case r.D.GCCHigh:return s.$.GCCHigh;case r.D.DoD:return s.$.DoD;case r.D.AirGap08:return s.$.AirGap08;case r.D.AirGap09:return s.$.AirGap09;default:throw new Error(`Unsupported AppEnvironment: ${e}`)}})((0,o.r)());return(0,m.useEffect)((()=>{(async()=>{if(f===i.k.LoggedIn&&(null==n?void 0:n.tenantId))try{const t=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Other";const n=performance.now(),r=(0,u.A)();try{const o=await d.get(`/${e}/.well-known/openid-configuration`);return(0,c.a)({eventName:"GetOpenIdTenantConfiguration",httpCode:o.status,latency:performance.now()-n,area:"AADAuthorityService",subArea:t,correlationId:r}),(null==o?void 0:o.data)??null}catch(e){var o;const a=e;return(0,c.a)({eventName:"GetOpenIdTenantConfiguration",httpCode:(null===(o=a.response)||void 0===o?void 0:o.status)??500,error:e instanceof Error?JSON.stringify({name:e.name,message:e.message,debugInfo:e.stack}):"Unknown error",latency:performance.now()-n,area:"AADAuthorityService",subArea:t,correlationId:r}),null}}(n.tenantId);(e=t)&&e.authorization_endpoint&&e.tenant_region_sub_scope&&e.tenant_region_sub_scope.toLowerCase().includes("gcc")?p(s.$.GCC):(e=>{if(e&&e.authorization_endpoint&&e.tenant_region_scope){const t=e.tenant_region_scope.toLowerCase();if(t.includes("usg")||t.includes("usgov"))return!0}return!1})(t)?p(s.$.GCCHigh):p(E)}catch(e){console.error("[TenantInitWrapper] Failed to resolve tenant type:",e),p(E)}else p(E);var e})()}),[null==n?void 0:n.tenantId,f,p]),m.createElement(m.Fragment,null,t)}},28631:(e,t,n)=>{function r(e){return null!=e}function o(e){return e.filter(r)}n.d(t,{S:()=>o})},81169:(e,t,n)=>{function r(e){return"string"==typeof e?Object.keys(e.split("")):"number"==typeof e||"boolean"==typeof e?[]:Object.keys(e)}n.d(t,{H:()=>r})},51031:(e,t,n)=>{function r(e){return"string"==typeof e}function o(e){return e.length?e[0].toUpperCase()+e.slice(1):e}function a(e){return e.length?e[0].toLowerCase()+e.slice(1):e}function i(e,t){return e.slice(0,t.length)===t}function s(e,t){return e.slice(0-t.length)===t}n.d(t,{Kg:()=>r,Zb:()=>o,d5:()=>s,oZ:()=>a,w1:()=>i})},74661:(e,t,n)=>{n.d(t,{E:()=>me});var r=function(e){return e[e.Success=0]="Success",e[e.Success_NoChanges=1]="Success_NoChanges",e[e.Abandoned_ClientVeryActive=2]="Abandoned_ClientVeryActive",e[e.Abandoned_NoNetwork=3]="Abandoned_NoNetwork",e[e.Error_TimedOut=4]="Error_TimedOut",e[e.Error_TransformFailed=5]="Error_TransformFailed",e[e.Error_BrowserError=6]="Error_BrowserError",e[e.Error_Unknown=7]="Error_Unknown",e[e.NotStarted=8]="NotStarted",e}({}),o=function(e){return e[e.Valid=0]="Valid",e[e.Invalid=1]="Invalid",e[e.Expired=2]="Expired",e[e.NoData=3]="NoData",e[e.NoCache=4]="NoCache",e}({}),a=function(e){return e.Filters="Filters",e.None="None",e.ConsumerKey="ConsumerKey",e}({}),i=function(e){return e.OnExpiry="OnExpiry",e.Never="Never",e}({});function s(e,t,n){const{strategy:r,excludeFilters:o,consumerKey:i}=t;let s=`ecs.cache.${e}`;switch(r){case a.ConsumerKey:if(!i)throw new Error("Cannot generate key using PartitionStrategy.ConsumerKey if consumerKey is not provided");s=`${i}`;break;case a.Filters:{if(!n)throw new Error("Cannot generate key using PartitionStrategy.Filters if ecsParameters is not set during instantiation");const e=n.filters||{};o.length&&o.forEach((t=>{e[t]&&delete e[t]}));const t=Object.values(e).filter((e=>void 0!==e||null!==e));t.length&&(s+=`.${t.join(".")}`);break}case a.None:}return{configKey:s,metadataKey:`${s}.metadata`}}n(31033);class l{async initializeCache(e){this.cache={storage:e.storage,partitionOptions:{strategy:e.partitionBy||a.None,excludeFilters:e.excludeFiltersFromPartition||[],consumerKey:e.consumerKey},invalidate:e.invalidateCache||i.Never,validateCachedData:e.validateCachedData};const{configKey:t,metadataKey:n}=s(this.serviceName,this.cache.partitionOptions,this.ecsParameters);this.logger.debug(`Storage Keys calculated: ${t}, ${n}`);try{const e=await this.cache.storage.getItem(t);if(e){const o=JSON.parse(e),a=await this.cache.storage.getItem(n),i=a?JSON.parse(a):{requestStatus:r.Success};this.data={ecsConfiguration:o,...i},this.logger.log(`Cache successfully loaded: ${t}`)}else this.logger.log(`No cached data found: ${t}`)}catch(e){this.logger.log(`Error while loading from cache '${t}', error:`,e)}}get(){var e;return(null===(e=this.cache)||void 0===e?void 0:e.invalidate)===i.OnExpiry&&this.cacheState===o.Expired&&(this.logger.log("Cache expired, clearing cache"),this.clearCache()),this.data}get expiration(){var e,t;const n=null===(t=this.data)||void 0===t||null===(e=t.headers)||void 0===e?void 0:e.Expires;return n&&new Date(n)}get cacheState(){return void 0===this.cache?o.NoCache:this.data?this.cache.validateCachedData&&!this.cache.validateCachedData(this.data)?o.Invalid:this.expiration&&this.expiration.valueOf()>Date.now()?o.Valid:o.Expired:o.NoData}getDiagnosticInfo(){return{serviceName:this.serviceName,ecsParameters:this.ecsParameters,expirationTime:this.expiration}}async clearCache(){if(this.data=void 0,void 0===this.cache)return;const{configKey:e,metadataKey:t}=s(this.serviceName,this.cache.partitionOptions,this.ecsParameters);await this.cache.storage.removeItem(e),await this.cache.storage.removeItem(t),this.logger.log(`Cache for '${e}' and ${t} cleared.`)}constructor(e,t,n){this.serviceName=e,this.ecsParameters=n,this.logger=t.newLogger(`EcsClient_${this.serviceName}`,"services-io-ecs")}}var c=function(e){return e.AuthFailed="AuthFailed",e.AuthResolveFailed="AuthResolveFailed",e.BaseUrlFailedToResolve="BaseUrlFailedToResolve",e.BaseUrlTimeout="BaseUrlTimeout",e.CustomTelemetryFailed="CustomTelemetryFailed",e.FailedToFetch="FailedToFetch",e.InvalidCancellationToken="InvalidCancellationToken",e.InvalidParameters="Invalid pararameters",e.InvalidUrl="InvalidUrl",e.ModelFailedToInitialize="ModelFailedToInitialize",e.ModelTimeOut="ModelTimeOut",e.NotImplemented="NotImplemented",e.RejectHttpError="RejectHttpError",e.RequestCancelled="RequestCancelled",e.RequireStatusFailed="RequireStatusFailed",e.TimedOut="TimedOut",e.TransformFailed="TransformFailed",e}({}),u=n(5324),d=function(e){return e[e.Manual=0]="Manual",e[e.WhenExpired=1]="WhenExpired",e}({});const g="c72ea287-ed77-4fa6-a480-3712406c367e";n(4589);var h=function(e){return e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_AUTHORIZED=401]="NOT_AUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.ENCRYPTION_ERROR=463]="ENCRYPTION_ERROR",e[e.REQUEST_TERMINATED=487]="REQUEST_TERMINATED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED",e[e.SERVER_TIMEOUT=599]="SERVER_TIMEOUT",e}({}),m=function(e){return e.Initial="Initial",e.Auth="Auth",e.AuthDecorate="AuthDecorate",e.AuthResolve="AuthResolve",e.BaseUrlResolve="BaseUrlResolve",e.Retry="Retry",e.RetryDelay="RetryDelay",e.Redirect="Redirect",e.Throttle="Throttle",e}({}),f=n(46583),p=n(88841),E=n(31371);function v(e){if(!e)return;if(e.baseDelayMs<3e3)throw new Error("Base delay must be greater than 3000ms.");if(e.exponentialFactor<2)throw new Error("Exponential factor must be greater than 2.");if(e.maxRetries<0)throw new Error("Max retries must be greater than 0.");const t=new Set([h.SERVER_TIMEOUT,h.SERVER_ERROR,c.RejectHttpError,c.FailedToFetch]);return{shouldRetry:(n,r)=>n<e.maxRetries&&t.has(r),nextDelay:t=>e.baseDelayMs*Math.pow(e.exponentialFactor,t)}}const S=(e,t,n,r,o)=>Promise.resolve({constructRequest:(t,o,a)=>({apiName:"getConfiguration",url:e,method:"GET",headers:{...n,...r,...a?{"If-None-Match":a}:void 0},correlationId:t}),customTelemetry:T,transformResponse:y(t),allowedResponses:[h.OK,h.NOT_MODIFIED,h.CREATED,h.NO_CONTENT],retryPolicy:v(o)});function w(e){const{ecsParameters:t,serviceName:n,logger:r,retryPolicy:o}=e,a=function(e){return`${e.domain}/config/v1/${e.client}/`}(t),i=function(e){const t=[];if((0,f.A)(e.filters,((e,n)=>{(0,p.A)(e)||((0,E.A)(e)?e.forEach((e=>{t.push(`${n}=${e}`)})):t.push(`${n}=${e}`))})),e.agents){const n=e.agents.join(",");t.push(`agents=${n}`)}return t.push("ECSCanary=1"),`${e.version}?${t.join("&")}`}(t),s=function(e){return{"X-ECS-Client-Last-Telemetry-Events":`ecs_client_library_name=@1js/ecs-client,ecs_client_app_name=${e},ecs_client_version=2.5.6`}}(n);return{endpointUrl:`${a}${i}`,endpointModels:()=>({baseUrl:a,serviceName:n,models:{getConfigurationAsync:S(i,r,s,t.additionalHeaders,o)}})}}function T(e,t,n){return JSON.stringify({correlationId:e,serviceName:t,eTag:n,initialFetch:void 0===n})}const y=e=>async t=>{switch(e.debug(`Response headers: ${JSON.stringify(t.headers)}`),t.status){case h.OK:{const n=await t.body.json(),o=t.headers.expires??n.Headers.Expires,a=t.headers.etag??n.Headers.ETag,i=n.Headers.CountryCode;return{requestStatus:r.Success,ecsConfiguration:n,headers:C(e,o,a,i)}}case h.NOT_MODIFIED:case h.CREATED:case h.NO_CONTENT:return{requestStatus:r.Success_NoChanges,headers:C(e,t.headers.expires,t.headers.etag)};default:throw new Error(`Response status ${t.status} unexpectedly allowed`)}},C=(e,t,n,r)=>{let o=Date.parse(t);if(isNaN(o)){const e=t.match(/\d+/g);if(e&&1===e.length&&(o=Number.parseInt(t,10)),isNaN(o))throw new Error(`Invalid or missing expiration date: '${t}'`)}if(!n)throw new Error("Missing etag value");return r||e.warn("Missing country code"),{ETag:n,Expires:new Date(o),CountryCode:r}};class A extends l{get didFetch(){return this._didFetch}async fetch(){var e;const t=void 0===this.eTag,n=(0,u.A)();this.lastAttemptedFetch=new Date,this.logger.log(`Getting ECS configuration from ${this.fetchUrl}. correlationId=${n}, isInitialFetch=${t}`);const o=(null===(e=this.fetchPrecheck)||void 0===e?void 0:e.call(this))||!0;if(!0!==o)return this.scheduleNextConfigurationFetch(),this.logger.debug(`${o.errorMessage}. correlationId=${n}`),{requestStatus:o.requestStatus};try{var a;const e=await this.ecsApi.getConfigurationAsync(n,this.serviceName,this.eTag);this.logger.log(`ECS configuration fetch complete. status=${r[e.requestStatus]}, correlationId=${n}, isInitialFetch=${t}`),this.data=this.onSuccess(e,n),this._didFetch=!0,this.configIds=null===(a=e.ecsConfiguration)||void 0===a?void 0:a.ConfigIDs,this.updateCache()}catch(e){return this.onError(e,n)}finally{this.scheduleNextConfigurationFetch()}return this.data}startFetchSchedule(e,t){this.host=e,this.callbackFunction=t,this.fetchMode=d.WhenExpired,this.logger.debug("Starting ECS configuration fetch schedule in WhenExpired mode."),this.scheduleNextConfigurationFetch()}updateParameters(e){const t=this.fetchUrl,{endpointUrl:n,endpointModels:r}=w({ecsParameters:e,serviceName:this.serviceName,logger:this.logger,retryPolicy:this.fetchRetryPolicy});return this.fetchUrl=n,this.ecsApi=this.endpointsManager.createApi(r),this.ecsParameters=e,t!==this.fetchUrl}dispose(){this.fetchMode=d.Manual,this.clearConfigurationFetchSchedule()}getDiagnosticInfo(){return{serviceName:this.serviceName,configIds:this.configIds,ecsParameters:this.ecsParameters,etag:this.eTag,fetchUrl:this.fetchUrl,lastAttemptedFetch:this.lastAttemptedFetch,lastSuccessfulFetch:this.lastSuccessfulFetch,nextScheduledFetch:this.nextScheduledFetch,fetchMode:this.fetchMode,expirationTime:this.expiration}}get eTag(){var e,t;if(this.cacheState!==o.Invalid)return null===(t=this.data)||void 0===t||null===(e=t.headers)||void 0===e?void 0:e.ETag}async updateCache(){var e;if(void 0===this.cache)return;const{storage:t}=this.cache,{configKey:n,metadataKey:r}=s(this.serviceName,this.cache.partitionOptions,this.ecsParameters);if(!(null===(e=this.data)||void 0===e?void 0:e.ecsConfiguration)||0===Object.keys(this.data.ecsConfiguration).length)return void this.logger.log(`updateCache() received empty data. Cache State: ${o[this.cacheState]} (Storage key: ${n})`);const{ecsConfiguration:a,...i}=this.data;await t.setItem(n,JSON.stringify(a)),await t.setItem(r,JSON.stringify(i)),this.logger.log(`Cache '${n}' updated.`)}onSuccess(e,t){let n;switch(e.requestStatus){case r.Success:var o;if(!e.ecsConfiguration)throw new Error("ECS configuration is unexpectedly undefined on a successful response");if(!e.headers)throw new Error("Headers object is unexpectedly undefined on a successful response");if(!this.ecsParameters.disableSentinelConfigValidation&&!this.validateSentinelConfig(e.ecsConfiguration))throw new Error("Sentinel Config is missing from response");n=(null===(o=this.transformData)||void 0===o?void 0:o.call(this,e))||e;break;case r.Success_NoChanges:if(!e.headers)throw new Error("Headers object is unexpectedly undefined on a successful response");n={...this.data,requestStatus:e.requestStatus,headers:e.headers},this.logger.debug(`ECS configuration is unchanged. eTag=${this.eTag}, correlationId=${t}`);break;default:throw new Error(`Received unexpected request status of ${r[e.requestStatus]}`)}return this.lastSuccessfulFetch=this.lastAttemptedFetch,n.fetchParams=this.ecsParameters,n}onError(e,t){var n;const o=this.processErrorText(e,"unknown error");let a=r.Error_Unknown;switch(e.reason){case c.TimedOut:a=r.Error_TimedOut;break;case c.TransformFailed:a=r.Error_TransformFailed;break;default:var i;a=(null==e?void 0:e.reason)===c.RejectHttpError&&void 0===(null==e||null===(i=e.serverResponse)||void 0===i?void 0:i.status)?r.Error_BrowserError:r.Error_Unknown}return this.logger.error(`Fetching ECS configuration failed. error=${e}, innerExceptionMessage=${null===(n=e.innerException)||void 0===n?void 0:n.message} correlationId=${t}`),{requestStatus:a,errorMessage:o}}processErrorText(e,t){let n=t;var r;return e&&(n=(null===(r=Object.keys(e))||void 0===r?void 0:r.length)>0?JSON.stringify(e):e.message,e.innerException&&(n+=` innerExceptionMessage: ${e.innerException.message}`)),n}validateSentinelConfig(e){var t;return e[g]?(this.logger.log("ECS Sentinel Config is present in ECS response at the root level"),!0):(null===(t=e.ECS)||void 0===t?void 0:t[g])?(this.logger.log("ECS Sentinel Config is present in ECS response inside ECS object"),!0):(this.logger.error("ECS Sentinel Config is missing from ECS response"),!1)}clearConfigurationFetchSchedule(){this.setTimeoutHandle&&this.host&&(this.host.clearTimeout(this.setTimeoutHandle),this.setTimeoutHandle=void 0,this.logger.debug("Cleared existing queued configuration fetch"))}scheduleNextConfigurationFetch(){if(this.clearConfigurationFetchSchedule(),this.fetchMode===d.Manual)return void this.logger.debug("No need to queue configuration fetch in manual mode, ignoring...");if(!this.host)return void this.logger.error("No host provided, cannot schedule next configuration fetch");const e=this.calculateFetchInterval();this.setTimeoutHandle=this.host.setTimeout((async()=>{const e=await this.fetch();this.callbackFunction&&this.callbackFunction(e)}),e),this.nextScheduledFetch=new Date(Date.now()+e),this.logger.debug(`Next ECS configuration fetch will occur in ${e}ms at ${this.nextScheduledFetch}`)}calculateFetchInterval(){if(this.fetchMode===d.Manual)throw new Error(`Calculating fetch interval is not supported when using ${d[this.fetchMode]} fetch mode.`);const e=(this.expiration??new Date).valueOf()-Date.now();return e<A.MinimumRefreshIntervalInMilliseconds?(this.logger.warn(`Calculated refresh interval of ${e}ms based on expires header was below the allowed minimum of ${A.MinimumRefreshIntervalInMilliseconds}ms. Minimum value will be used instead.`),A.MinimumRefreshIntervalInMilliseconds):e}constructor(e,t,n,r,o,a,i,s){super(e,n,t),this.ecsParameters=t,this.endpointsManager=r,this.fetchPrecheck=o,this.fetchRetryPolicy=a,this.transformData=i,this.fetchMode=d.Manual,this._didFetch=!1,this.clientType="EcsClient";const{endpointUrl:l,endpointModels:c}=w({ecsParameters:t,serviceName:e,logger:this.logger,retryPolicy:a});this.fetchUrl=l,this.ecsApi=this.endpointsManager.createApi(c),s&&(this.data=s.data,this.cache=s.cache)}}A.MinimumRefreshIntervalInMilliseconds=18e5;class N extends l{createClient(e){let{ecsParameters:t,endpointsManager:n,loggerFactory:r,fetchPrecheck:o,fetchRetryPolicy:a,transformData:i}=e;const s={data:this.data,cache:this.cache};return new A(this.serviceName,t,r,n,o,a,i,s)}constructor(...e){super(...e),this.clientType="LocalEcsClient"}}function I(e,t,n){const r=new Error(e);return Object.assign(r,{reason:e,serverResponse:t,innerException:n})}function O(e,t,n){let r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.TimedOut;const a=new Promise((e=>{r=t.setTimeout(e,n)}));return Promise.race([e,a.then((()=>{throw I(o)}))]).then((e=>(t.clearTimeout(r),e)))}function R(e,t){return new Promise(((n,r)=>{if(e<0)r(I(c.InvalidParameters));else{let r=0;r=t.setTimeout((()=>{t.clearTimeout(r),n()}),e)}}))}function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.NOT_FOUND;return Array.isArray(t)?t.some((t=>b(e,t))):b(e,t)}function b(e,t){return"string"==typeof t?new RegExp(t.replace(/x/gi,"\\d")).test(e.toString()):e===t}n(48419),n(72803),n(80111),n(83734),n(32909),n(57184),n(39583);function k(e){return"string"==typeof e}const M=e=>async t=>{try{return{response:await e(t)}}catch(e){return{response:e.serverResponse,error:e}}},D=(e,t,n,r)=>{const{cancellationMap:o}=r;let a=e;var i,s;return a=function(e,t,n){return async r=>{const{cancellationToken:o}=r,a=((e,t)=>{if(e){const n=t.get(e);if(!n)throw I(c.InvalidCancellationToken);return n}})(o,t)??new AbortController;r.signal=a.signal;try{return await e(r)}catch(e){throw(null==e?void 0:e.reason)!==c.TimedOut||void 0!==n&&!n||a.abort(),e}}}(a,r.cancellationMap,t.abortOnTimeout),n.authResource&&(i=a,s=n.authResource,a=async e=>{const t=e.operationLogger.logStep(m.AuthDecorate),n=await(async(e,t)=>{try{return await t(e)}catch(e){throw I(c.AuthFailed,void 0,e)}})(e,s);if(t&&t({result:h[h.OK]}),!n)throw I(c.AuthFailed);const r=n.request,o=await i(r),a=await(async(e,t,n)=>{const r=t.operationLogger.beginStep(m.AuthResolve,t);try{const o=n(e,t);return o.then((t=>(r&&t&&r({result:h[e.status]},e),t))),await o}catch(t){throw I(c.AuthResolveFailed,e,t)}})(o,r,n.resolver);return a?(a.operationLogger.nextStep(m.Auth,{result:h[o.status]},a,o),i(a)):o}),a=((e,t,n)=>async r=>{const{baseUrl:o,baseUrlPromise:a}=t,i=r.operationLogger.logStep(m.BaseUrlResolve),s=o||a&&await O(a().catch((e=>{throw I(c.BaseUrlFailedToResolve,void 0,e)})),n.globalContext,n.configuration.baseUrlResolutionTimeoutInMs,c.BaseUrlTimeout);try{if(s){const e=!s.endsWith("/")&&r.url.length>0?`${s}/`:s,t=r.url.startsWith("/")?r.url.substring(1):r.url;r.url=new URL(t,e).href}}catch(e){throw I(c.InvalidUrl)}return i&&i({result:h[h.OK]}),e(r)})(a,n,r),a=((e,t,n)=>{if(!t.redirectPolicy)return e;const{maxRedirects:r,useAbsoluteRedirect:o,headers:a,redirectOn:i,onRedirect:s}=t.redirectPolicy;return async t=>{const l={...t,headers:{...t.headers,...a}};let u=await e(l);for(let a=0;;a++){const{status:d,headers:{location:g}}=u;if(!(a<r&&P(d,i)))return u;try{let e;if(s?e=s(g,d):g&&(e=new URL(g)),!e)return u;o?(n.baseUrl=e.origin,l.url=e.pathname):(l.url=t.url,n.baseUrl=e.href)}catch(e){throw I(c.InvalidUrl,void 0,e)}l.operationLogger.nextStep(m.Redirect,{result:h[u.status]},l,u),u=await e(l)}}})(a,t,n),t.rejectHttpError&&(a=function(e){return async t=>{const n=await e(t);if(n.status>=h.BAD_REQUEST)throw I(c.RequireStatusFailed,n,[h[n.status]]);return n}}(a)),t.allowedResponses&&(a=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return t=>e(t).then((e=>{if(((e,t)=>t.indexOf(e)>-1||t.filter(k).map((e=>new RegExp(e.replace(/x/gi,"\\d")))).some((t=>t.test(e.toString()))))(e.status,n))return e;const t=[h[e.status]];throw I(c.RequireStatusFailed,e,t)}))}(a,...t.allowedResponses)),t.retryPolicy&&(a=function(e,t,n){const r=new Map;return o=>((e,t,n,r)=>{let{globalContext:o}=r;return async r=>{let a=await M(e)(r);for(let i=0;;i++){const{response:s,error:l}=a,u=null==s?void 0:s.status,d=u||(null==l?void 0:l.reason)||c.FailedToFetch,g=null==s?void 0:s.headers,f=n.get(d)||0;if(n.set(d,f+1),!t.shouldRetry(i,d,n,g)){if(l)throw l;return a.response}{const n=t.nextDelay(i,g,d),c=u&&h[u]||void 0;r.operationLogger.nextStep(m.RetryDelay,{result:c,resultError:l},void 0,s),await R(n,o),r.operationLogger.nextStep(m.Retry,{result:h[h.OK]},r),a=await M(e)(r)}}}})(e,t,r,n)(o)}(a,t.retryPolicy,r)),a=((e,t)=>async n=>{const{cancellationToken:r}=n;r&&t.set(r,new AbortController);try{return await e(n)}finally{r&&t.delete(r)}})(a,o),a};var F=n(59434);class L{get observable(){return this.observable$}subscribe(e){return this.observable$.subscribe(e)}onNext(e){this.observedValue=e,this.subscriptions.forEach((t=>{t.next(e)}))}onComplete(){this.subscriptions.forEach((e=>{e.closed||e.complete()}))}onError(e){this.subscriptions.forEach((t=>{t.error(e)}))}get value(){return this.observedValue}constructor(e){this.subscriptions=new Set,this.observedValue=e,this.observable$=new F.c((e=>(this.subscriptions.add(e),()=>{this.subscriptions.has(e)&&this.subscriptions.delete(e)})))}}const U=e=>({...H,...e}),_=(e,t,n)=>{var r;const o=null===(r=n.get(x(e,t)))||void 0===r?void 0:r.healthSubject.value;return o&&{...o}},x=(e,t)=>`${e}_${t}`,W=(e,t,n,r)=>async o=>e(o).then((e=>(t(o.apiName||"",n,e.status,r),e))).catch((e=>{throw t(o.apiName||"",n,e.reason,r),e})),H={isHealthy:e=>{if(e&&e.length>0){const t=e[e.length-1];if("number"!=typeof t&&t!==c.RequestCancelled)return!1}return!0},historyLength:5},G=e=>{let t="";return e.forEach((e=>{t=`${t}${JSON.stringify(e.healthSubject.value)}`})),t?null==(n=t)||0===n.length?n:` ${n}`.substr(1):"";var n},z=!0,B=new L(z);var $=n(26401),q=n.n($);function j(e,t,n){if(!t)return;const r=n?new URL(n.url).hostname:"";return{name:t.apiName||"",dateTime:e,method:t.method,hostname:r,requestHeaders:t.headers||{},responseHeaders:(null==n?void 0:n.headers)||{},status:null==n?void 0:n.status,performance:K(null==n?void 0:n.url),authPerformanceLogs:t.authPerformanceLogs||{}}}function K(e){if(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType)return t[t.length-1]}}function X(e,t){const{globalContext:n}=t,r=new Map,o=new Map,{networkMonitor:a,networkState:i}=(()=>{const e=e=>B.onNext(e);return{networkMonitor:{processResponse:t=>{void 0!==t.status&&t.status!==h.NOT_MODIFIED&&t.status!==h.GATEWAY_TIMEOUT&&e(z)},processResponseError:t=>{t&&(t.reason===c.RejectHttpError?e(!1):t.serverResponse&&e(z))}},networkState:{observeIsOnline:()=>B.observable,isOnline:()=>B.value}}})(),s=((e,t)=>async n=>t(n).then((t=>(e.processResponse(t),t))).catch((t=>{throw e.processResponseError(t),t})))(a,(l=((e,t)=>async n=>((e,t,n)=>{let{url:r,method:o,body:a,headers:i,credentials:s,timeout:l,signal:u}=e;if(null==u?void 0:u.aborted)throw I(c.RequestCancelled);return O(q()(r,{method:o,headers:i&&new Headers(i),body:a,signal:u,credentials:s}),t,l??n.defaultRequestTimeoutInMs).then((e=>{var t;const n={};return null===(t=e.headers)||void 0===t||t.forEach(((e,t)=>n[t]=e)),{status:e.status,headers:n,body:e,url:e.url}}))})(n,e,t))(n,t.configuration),async e=>{try{return await l(e)}catch(n){var t;if(n instanceof TypeError&&"failed to fetch"===(null===(t=n.message)||void 0===t?void 0:t.toLowerCase())){const t=e.headers&&e.headers.cache;if(t&&-1!==t.indexOf("only-if-cached"))return{status:h.GATEWAY_TIMEOUT};throw I(c.RejectHttpError,void 0,n)}if("AbortError"===n.name)throw I(c.RequestCancelled);throw n}}));var l;const{trackHealth:d,...g}=(()=>{const e=new Map,t=(t,n)=>e.get(x(t,n))||((t,n)=>{const r={responseHistory:[],healthSubject:new L({serviceName:t,endpointName:n,isHealthy:void 0})};return e.set(x(t,n),r),r})(t,n),n=(e,n,r,o)=>{const a=t(n,e);((e,t,n)=>{e.responseHistory.push(t),e.responseHistory.length>n&&e.responseHistory.shift()})(a,r,o.historyLength||5);const i=o.isHealthy([...a.responseHistory]);if(a.healthSubject.value.isHealthy!==i){const t={serviceName:n,endpointName:e,isHealthy:i};a.healthSubject.onNext(t)}};return{trackHealth:(e,t,r)=>W(e,n,t,U(r)),observeEndpointHealth:(e,n)=>{if(e&&n)return t(e,n).healthSubject.observable},getEndpointHealth:(t,n)=>_(t,n,e),dumpState:()=>G(e)}})();return{createApi:n=>V(n,e,{...t,cancellationMap:r,trackHealth:d,throttleMap:o},s),createCancelToken:()=>{const e=(0,u.A)();return{token:e,cancel:()=>{const t=r.get(e);return t&&t.abort(),!t}}},networkState:i,health:g}}const V=(e,t,n,r)=>{const o={},a=e(t),{baseUrlPromise:i,models:s}=a;i&&i();for(const e in s){const t=s[e];o[e]=Q(e,t,a,n,r)}return o},Q=(e,t,n,r,o)=>{const{trackHealth:a,throttleMap:i,globalContext:s}=r,l=((e,t,n)=>{let r,o;return t.then((e=>{if(e.throttlePolicy){o=e.throttlePolicy;const t=null==o?void 0:o.throttleKey;t?(r=n.get(t)||[],n.has(t)||n.set(t,r)):r=[]}})),t=>o?n=>async function n(a){const i=function(e,t){const{maxPerThrottleInterval:n,throttleInterval:r}=t,o=Date.now()-r;let a=e.length-1;for(;a>=0&&o<e[a];)a--;e.splice(0,a);const i=e.length-n;return i>=0?e[i]-o:0}(r,o);if(!i)return function(e){return r.push(Date.now()),t(e)}(a);const s=a.operationLogger.logStep(m.Throttle);return await R(i,e),s&&s({result:h[h.OK]}),n(a)}(n):t})(s,t,i),{telemetryProvider:u}=r,{serviceName:d}=n;return async function(){for(var i=arguments.length,g=new Array(i),f=0;f<i;f++)g[f]=arguments[f];let p,E,v,S;const w=(new Date).toISOString(),T=performance.now();try{const e=await O(t.catch((e=>{throw I(c.ModelFailedToInitialize,void 0,e)})),s,r.configuration.modelInitializationTimeoutInMs,c.ModelTimeOut);let i=D(o,e,n,r);p=e.constructRequest(...g),p.operationLogger=(e=>{const t=[];let n;const r=(e,n,r)=>{const o=new Date;return(a,i,s)=>{t.push({type:e,duration:a-n,result:i,request:j(o,r,s)})}},o=(e,t)=>{const o=performance.now();return(a,i)=>{n(o,a,i),n=r(e,o,t)}};return n=r(m.Initial,performance.now(),e),{nextStep:(e,t,n,r)=>{o(e,n)(t,r)},beginStep:o,logStep:(e,t,n)=>{const o=r(e,performance.now(),t);return e=>o(performance.now(),e,n)},complete:(e,r)=>(n(performance.now(),e,r),t)}})(p),i=a(i,n.serviceName,e.healthPolicy),i=l(i);try{var y;S=null===(y=e.customTelemetry)||void 0===y?void 0:y.call(e,...g)}catch(e){throw I(c.CustomTelemetryFailed,void 0,e)}return E=await i(p),(C=e,async e=>{try{var t,n;if(C.transformResponse)return await C.transformResponse(e);if(e.status===h.NO_CONTENT)return;const r=C.responseType||function(e){if(e.headers){const t=e.headers["content-type"];if(t){if(-1!==t.indexOf("application/json"))return"json";if(-1!==t.indexOf("text/"))return"text"}if("0"===e.headers["content-length"])return"text"}}(e)||"json";return await(e.body&&(null===(t=(n=e.body)[r])||void 0===t?void 0:t.call(n)))}catch(t){throw"AbortError"===t.name?I(c.RequestCancelled):I(c.TransformFailed,e,t)}})(E)}catch(e){throw e.serverResponse&&(E=e.serverResponse),v=e,e}finally{const t=performance.now()-T,n=null==p?void 0:p.correlationId,r=null==E?void 0:E.status,o=r&&h[r]||void 0,a=(null==p?void 0:p.operationLogger.complete({result:o,resultError:v},E))||[],i=(null==v?void 0:v.reason)||o||"";u({apiName:e,serviceName:d,createdTime:w,parameters:S,duration:t,result:i,innerError:null==v?void 0:v.innerException,operationLogs:a,correlationId:n})}var C}};class J{setItem(e,t){return new Promise((n=>{try{globalThis.localStorage.setItem(e,t)}catch(e){console.error("Error setting item in localStorage",e)}n()}))}getItem(e){return new Promise((t=>{try{return void t(globalThis.localStorage.getItem(e))}catch(e){console.error("Error getting item from localStorage",e)}t(null)}))}removeItem(e){return new Promise((t=>{try{globalThis.localStorage.removeItem(e)}catch(e){console.error("Error removing item from localStorage",e)}t()}))}}class Y{newLogger(e){return new Z(e)}}class Z{error(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console.error({eventName:"EcsServiceCallError",errorType:"Flighting_Error",message:"ECSClient error occurred for "+this.label,debugInfo:e+n})}warn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console.warn({featureName:"ECSClient",message:`ECS Client warning: ${e} args: ${n}`})}debug(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console.debug({featureName:"ECSClient",message:`ECS Client debug log: ${e} args: ${n}`})}log(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console.log({featureName:"ECSClient",message:`ECS Client log: ${e} args: ${n}`})}constructor(e){this.label=e}}const ee=()=>X({},{globalContext:new te,telemetryProvider:ne,configuration:{modelInitializationTimeoutInMs:2e4,baseUrlResolutionTimeoutInMs:35e3,defaultRequestTimeoutInMs:2e4}});class te{setTimeout(e,t){return window.setTimeout(e,t)}clearTimeout(e){window.clearTimeout(e)}}function ne(e){me.getInstance().setEndpointsManagerData(e)}var re=n(46462),oe=n(92321);const ae="Office.Experimentation";var ie=n(27435),se=function(e){return e[e.Unknown=0]="Unknown",e[e.Success=1]="Success",e[e.Failed=2]="Failed",e[e.FromCache=4]="FromCache",e[e.FromDefault=8]="FromDefault",e[e.OverridesSet=16]="OverridesSet",e[e.InvalidEnvironment=32]="InvalidEnvironment",e[e.ParsingError=64]="ParsingError",e[e.CanaryError=128]="CanaryError",e[e.CacheNotAvailable=256]="CacheNotAvailable",e}({});async function le(e,t,n,i,s,l,c,u){const d=performance.now(),g=await(async(e,t,n)=>await async function(e){let{serviceName:t,cacheOptions:n,loggerFactory:r}=e;const o=new N(t,r);return await o.initializeCache(n),o}({serviceName:e,cacheOptions:{storage:new J,partitionBy:a.ConsumerKey,consumerKey:t},loggerFactory:n??new Y}))(n,i,u);let h,m="",f=se.Unknown,p=d,E=r.NotStarted,v="";var S;if(g.cacheState===o.Valid&&(h=g.get(),(null==h?void 0:h.ecsConfiguration)&&(f=se.FromCache,E=h.requestStatus,v=(null===(S=h.headers)||void 0===S?void 0:S.ETag)??"",p=performance.now()-d)),!(null==h?void 0:h.ecsConfiguration)&&!c){const e=g.createClient({ecsParameters:t,endpointsManager:ee(),loggerFactory:u??new Y});var w;h=await e.fetch(),(null==h?void 0:h.ecsConfiguration)&&(f=se.Success,E=h.requestStatus,v=(null===(w=h.headers)||void 0===w?void 0:w.ETag)??"",p=performance.now()-d)}return(null==h?void 0:h.ecsConfiguration)?Object.keys((null==h?void 0:h.ecsConfiguration)??{}).forEach((n=>{var r;if("ConfigIDs"===n)Object.keys(null==h||null===(r=h.ecsConfiguration)||void 0===r?void 0:r.ConfigIDs).forEach((e=>{var t,n;const r=null==h||null===(n=h.ecsConfiguration)||void 0===n||null===(t=n.ConfigIDs)||void 0===t?void 0:t[e];m=""===m?r:`${m}, ${r}`}));else if("Headers"===n||"ECS"===n);else{var o;Object.keys(null==h||null===(o=h.ecsConfiguration)||void 0===o?void 0:o[n]).forEach((r=>{var o,a,i;const s=null===(a=h.ecsConfiguration)||void 0===a||null===(o=a[n])||void 0===o?void 0:o[r],c=l||!1!==l&&((null===(i=t.agents)||void 0===i?void 0:i.length)??0)>1;s.constructor==={}.constructor?Object.keys(s).forEach((t=>{ce(e,c?n+"."+r+"."+t:r+"."+t,s[t])})):ce(e,c?n+"."+r:r,s)}))}})):(f=c?se.CacheNotAvailable:se.Failed,E=(null==h?void 0:h.requestStatus)??r.Error_Unknown,p=performance.now()-d),s.setConfigMetadata({flightingResponseStatus:f,ecsRequestStatus:E,responseTime:p,flightingIds:m,eTag:v}),s.flightingTelemetryLogger&&s.loggerTenantName&&(s.emitConfigurationEvents(),s.emitEndpointsManagerData()),(c||f==se.Failed)&&async function(e,t,n,r){e.createClient({ecsParameters:t,endpointsManager:ee(),loggerFactory:r??new Y,fetchRetryPolicy:{retryType:"exponential-backoff",baseDelayMs:3e3,exponentialFactor:2,maxRetries:3}}).fetch().then((e=>{var t;null===(t=n.flightingTelemetryLogger)||void 0===t||t.sendTelemetryEvent({eventName:ae+".Flighting.ReHydrateEcsConfigCache",eventFlags:{diagnosticLevel:re.o.DiagnosticLevel.RequiredServiceData},dataFields:[(0,oe.m9)("ResponseStatus",e.requestStatus.toString())]})}))}(g,t,s,u),{flightingContext:e,flightingIds:m||"",responseStatus:f}}function ce(e,t,n){e.has(t)&&e.get(t).featureGateFlag&ie.jj.Evaluated||e.set(t,{featureGateValue:n,featureGateSource:ie.xv.Service,featureGateFlag:ie.jj.Default})}var ue=n(68421);let de;function ge(e,t,n){return de=new ue.M,de.setTenantToken(e,t),de.setTenantToken(ae,"e6e58d16cfb94942b795b4918258153a-765be17b-66ea-435e-8b55-5a128f3decd3-6873"),de.addSink(n),de}var he=function(e){return e[e.Success=0]="Success",e[e.Error_LoggerAlreadySet=1]="Error_LoggerAlreadySet",e}({});class me{static getInstance(){return this.flightConfigAdapter||(this.flightConfigAdapter=new this)}async initialize(e){return this.isInitialized?this.ecsFlightingResponse.responseStatus:(this.initializationPromise||(this.initializationPromise=(async()=>(void 0!==e.isCaseSensitive&&e.isCaseSensitive&&(this.isCaseSensitive=!0),!(e.telemetryLogger&&e.hostTenantName&&e.hostTenantAriaToken)||this.flightingTelemetryLogger&&this.loggerTenantName||(this.loggerTenantName=e.hostTenantName,this.flightingTelemetryLogger=ge(e.hostTenantName,e.hostTenantAriaToken,e.telemetryLogger)),this.ecsFlightingResponse=await le(this.ecsFlightingResponse.flightingContext,e.ecsParameters,e.serviceName,e.cacheConsumerKey,this,e.enableNamespacePrefix,e.enableWaitForCacheReadOnly,e.ecsClientLoggerFactory),this.addConfigOverrides(e.overrides||{}),this.enableSendFeatureQueryMetadata=!!e.enableSendFeatureQueryMetadata,this.isInitialized=!0,this.ecsFlightingResponse.responseStatus))()),this.initializationPromise)}getValue(e){return this.ecsFlightingResponse.flightingContext.has(e)?this.ecsFlightingResponse.flightingContext.get(e):{featureGateValue:void 0,featureGateSource:ie.xv.Default,featureGateFlag:ie.jj.Default}}addFeatureGateToFlightingContext(e,t,n,r){this.ecsFlightingResponse.flightingContext.set(e,{featureGateValue:t,featureGateSource:n,featureGateFlag:r})}markFeatureGateEvaluated(e){this.ecsFlightingResponse.flightingContext.get(e).featureGateFlag|=ie.jj.Evaluated}markFeatureGateTriggered(e){this.ecsFlightingResponse.flightingContext.get(e).featureGateFlag|=ie.jj.Triggered}getFlightIds(){var e;if(this.isInitialized)return null===(e=this.ecsFlightingResponse)||void 0===e?void 0:e.flightingIds}IsCaseSensitive(){return this.isCaseSensitive}addConfigOverrides(e){let t=!1;const n=this.ecsFlightingResponse.flightingContext;return Object.keys(e).forEach((r=>{n.has(r)&&n.get(r).featureGateFlag&ie.jj.Evaluated||(n.set(r,{featureGateValue:e[r],featureGateSource:ie.xv.Override,featureGateFlag:ie.jj.Default}),t=!0)})),t&&(this.ecsFlightingResponse.responseStatus|=se.OverridesSet),this.ecsFlightingResponse.responseStatus}async setTelemetryLoggerAsync(e,t,n){return this.flightingTelemetryLogger&&this.loggerTenantName?he.Error_LoggerAlreadySet:(this.loggerTenantName=t,this.flightingTelemetryLogger=ge(t,n,e),this.emitConfigurationEvents(),this.emitEndpointsManagerData(),he.Success)}async emitConfigurationEvents(){var e,t;this.configMetadata&&!this.hasEmittedConfigurationEvents&&(null===(e=this.flightingTelemetryLogger)||void 0===e||e.sendTelemetryEvent({eventName:ae+".Flighting.ECSServiceRequest",eventFlags:this.eventFlags,dataFields:[(0,oe.m9)("FlightingResponseStatus",this.configMetadata.flightingResponseStatus.toString()),(0,oe.m9)("ECSResponseStatus",this.configMetadata.ecsRequestStatus.toString()),(0,oe.ip)("ECSRequestResponseTime",this.configMetadata.responseTime)]}),null===(t=this.flightingTelemetryLogger)||void 0===t||t.sendTelemetryEvent({eventName:this.loggerTenantName+".Flighting.EcsFlightingResponse",eventFlags:this.eventFlags,eventContract:{name:"",dataFields:[(0,oe.m9)("Session.EcsETag",this.configMetadata.eTag||"")]},dataFields:[(0,oe.m9)("ECSConfigs",this.configMetadata.flightingIds||"")]}),this.hasEmittedConfigurationEvents=!0)}setConfigMetadata(e){this.configMetadata=e}async emitEndpointsManagerData(){var e,t,n,r,o,a,i,s,l,c,u;this.endpointsManagerData&&!this.hasEmittedEndpointsManagerData&&(null===(u=this.flightingTelemetryLogger)||void 0===u||u.sendTelemetryEvent({eventName:ae+".ECSClient.EndPointsManager",eventFlags:this.eventFlags,dataFields:[(0,oe.m9)("ApiName",this.endpointsManagerData.apiName),(0,oe.m9)("ServiceName",this.endpointsManagerData.serviceName),(0,oe.m9)("CorrelationId",(null===(e=this.endpointsManagerData.correlationId)||void 0===e?void 0:e.toString())??""),(0,oe.ip)("Duration",this.endpointsManagerData.duration),(0,oe.m9)("OperationType",(null===(t=this.endpointsManagerData.operationLogs[0])||void 0===t?void 0:t.type)??""),(0,oe.m9)("OperationMethod",(null===(o=this.endpointsManagerData.operationLogs[0])||void 0===o||null===(r=o.request)||void 0===r||null===(n=r.method)||void 0===n?void 0:n.toString())||""),(0,oe.m9)("OperationResult",null===(a=this.endpointsManagerData.operationLogs[0])||void 0===a?void 0:a.result.toString()),(0,oe.m9)("OperationStatus",(null===(l=this.endpointsManagerData.operationLogs[0])||void 0===l||null===(s=l.request)||void 0===s||null===(i=s.status)||void 0===i?void 0:i.toString())||""),(0,oe.m9)("OperationDuration",null===(c=this.endpointsManagerData.operationLogs[0])||void 0===c?void 0:c.duration.toString()),(0,oe.m9)("Result",this.endpointsManagerData.result)]}),this.hasEmittedEndpointsManagerData=!0)}setEndpointsManagerData(e){this.endpointsManagerData=e}constructor(){this.isInitialized=!1,this.enableSendFeatureQueryMetadata=!1,this.flightingTelemetryLogger=void 0,this.hasEmittedConfigurationEvents=!1,this.hasEmittedEndpointsManagerData=!1,this.eventFlags={diagnosticLevel:re.o.DiagnosticLevel.RequiredServiceData},this.ecsFlightingResponse={flightingContext:new ie.Fg,flightingIds:"",responseStatus:se.Unknown},this.isCaseSensitive=!1,this.initializationPromise=null}}},27435:(e,t,n)=>{n.d(t,{Fg:()=>i,jj:()=>a,xv:()=>o});var r=n(74661),o=function(e){return e[e.Default=0]="Default",e[e.Service=1]="Service",e[e.Override=2]="Override",e}({}),a=function(e){return e[e.Default=0]="Default",e[e.Evaluated=1]="Evaluated",e[e.Triggered=2]="Triggered",e}({});class i extends Map{set(e,t){return r.E.getInstance().IsCaseSensitive()?super.set(e,t):super.set(e.toLowerCase(),t)}get(e){return r.E.getInstance().IsCaseSensitive()?super.get(e):super.get(e.toLowerCase())}has(e){return r.E.getInstance().IsCaseSensitive()?super.has(e):super.has(e.toLowerCase())}delete(e){return r.E.getInstance().IsCaseSensitive()?super.delete(e):super.delete(e.toLowerCase())}constructor(){super()}}},87748:(e,t,n)=>{n.d(t,{J:()=>d}),n(31033);const r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]},o="undefined"!=typeof console?console:void 0,a={trace:((null==o?void 0:o.trace)??r).bind(o),warn:((null==o?void 0:o.warn)??r).bind(o),table:((null==o?void 0:o.table)??r).bind(o)};var i=n(51206);const s="undefined"!=typeof __WHY_DID_YOU_RECOMPUTE__&&__WHY_DID_YOU_RECOMPUTE__||"undefined"!=typeof globalThis&&globalThis.__WHY_DID_YOU_RECOMPUTE__,l={empty:!0},c={},u="undefined"==typeof WeakMap?null:WeakMap,d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(!u)return e;let n=g(),r=0,o=0;const d=s?new Map:void 0,h=s?new Error("Memoized function defined").stack:"";return function(){for(var u=arguments.length,m=new Array(u),f=0;f<u;f++)m[f]=arguments[f];let p=n;(0!==o||t>0&&r>t)&&(n=g(),r=0,o=0,null==d||d.clear()),p=n;for(let e=0;e<m.length;e++){var E,v;const t=(w=m[e])?"object"==typeof w||"function"==typeof w?w:(c[w]||(c[w]={val:w}),c[w]):l;var S;if(!(null===(E=p.map)||void 0===E?void 0:E.has(t))&&(null===(S=p.map)||void 0===S||S.set(t,g()),s&&d)){const e=d.get(p)??[],n=e.filter((e=>e!==t&&(0,i.A)(e,t)))[0];if(n){a.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");const e=new Error("Indentical argument passed").stack,r=(e,t)=>{a.table(e),Object.keys(e).forEach((n=>{const o=e[n],s=t[n];o!==s&&(0,i.A)(o,s)&&(a.warn(`Duplication present in child prop '${n}'`),r(o,s))}))};r(n,t),a.warn(e),a.warn(h)}d.set(p,[...e,t])}p=null===(v=p.map)||void 0===v?void 0:v.get(t)}var w;return p.hasOwnProperty("value")||(p.value=e(...m),r++),p.value}};function g(){return{map:u?new u:null}}},81416:(e,t,n)=>{n.d(t,{Ex:()=>S,qP:()=>w,zB:()=>v,QR:()=>b,MT:()=>E}),n(87847),n(39583);var r=n(87748),o=n(81169),a=n(51031),i=n(60968),s=n(73095);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=e.indexOf("{",t);if(-1===n)return;const r=function(e,t){let n=0;for(let r=t+1;r<e.length;r++)switch(e[r]){case"{":n++;break;case"}":if(0===n)return r;n--}return-1}(e,n);return-1!==r?[e.slice(t,n+1),e.slice(n+1,r),e[r]]:void 0}var c=n(60235);const u={a:"",A:"",b:"",B:"",c:"",C:"",d:"",D:"",e:"",E:"",f:"",F:"",g:"",G:"",h:"",H:"",i:"",I:"",j:"",J:"",k:"",K:"",l:"",L:"",m:"",M:"",n:"",N:"",o:"",O:"",p:"",P:"",q:"",Q:"",r:"",R:"",s:"",S:"",t:"",T:"",v:"",V:"",u:"",U:"",w:"",W:"",x:"",X:"",y:"",Y:"",z:"",Z:""},d=e=>e.split("").reduce(((e,t)=>{const n=u[t]||t,r=n+((e=>"aeiou".indexOf(e.toLowerCase())>=0)(t)?n:"");return e+r}),"");var g=n(19230);const h=/\\{\\d+\\}/g,m=(0,r.J)((e=>new RegExp(`\\{${e}\\}`,"g")));function f(e,t,n){try{return(0,s.l6)()&&t?(0,s.Ty)()?y(t.text):t.text:!(0,g.KU)(e,n)&&t?t.text:(0,g.eX)(e,n)}catch(e){return(0,g.uy)(e,n),""}}const p=(e,t)=>n=>{try{return e(n)}catch(e){return(0,g.uy)(e,t),""}};function E(e,t,n,r){try{return(0,s.l6)()&&t&&t.text&&!(null==r?void 0:r.alreadyPseudoLocalized)?p((e=>(0,s.Ty)()?function(e,t){const n={},r={};(0,o.H)(t).forEach(((e,o)=>{const a=`${T}_${o}`;n[e]=a,r[a]=t[e]}));const a=y(O(e.text(n)));return(0,o.H)(r).reduce(((e,t)=>e.replace(new RegExp(P(t),"g"),r[t])),R(a))}(t,e):t.text(e)),n):!(0,g.KU)(e,n)&&t&&t.text?p(t.text,n):p((t=>(0,o.H)(t).sort().reduce(((e,n,r)=>{const o=t[n],a=("string"==typeof o&&o||o&&o.toString&&o.toString()||"").replace(h,"");return(e||"").replace(m(r),a)}),(0,g.eX)(e,n))),n)}catch(e){return(0,g.uy)(e,n),()=>""}}function v(e){return t=>n=>n?E(t,void 0,e)(n):f(t,void 0,e)}function S(e,t){const n=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.eQ)();return f(e,t,n)};return n.toString=n,n.key=e,n}function w(e,t){const n=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,i.eQ)();return E(e,t,r)(n)};return n.toString=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.eQ)();if((0,s.l6)()&&t){const n=(0,c.UI)(e,t).stringToBeLocalized;return(0,s.Ty)()?y(n):n}return!(0,g.KU)(e,n)&&t?(0,c.UI)(e,t).stringToBeLocalized:(0,g.eX)(e,n)},n.key=e,n}const T="0.7059175321136157";function y(e){if(function(e){return(0,a.w1)(e,C)&&(0,a.d5)(e,A)}(e))return function(e){let t=C,n=C.length;for(;n<e.length;){const r=l(e,n);if(!r)break;const[o,a,i]=r;t+=o+y(a)+i,n+=o.length+a.length+i.length}return t+e.slice(n)}(e);const t={},n={};(e.match(/({.+?})/g)||[]).forEach(((e,r)=>{const o=`${T}_${r}`;t[e]=o,n[o]=e}));const r=Object.keys(t).reduce(((e,n)=>e.replace(n,t[n])),O(e)),o=d(r);return Object.keys(n).reduce(((e,t)=>e.replace(t,n[t])),R(o))}const C="{count, plural,",A="}",N="->INF::",I=`${T}_-1`;function O(e){return e.replace(new RegExp(N,"g"),I)}function R(e){return e.replace(new RegExp(I,"g"),N)}function P(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(e,t){const n={},r={};(0,o.H)(t).forEach(((e,o)=>{const a=`${T}_${o}`;n[e]=a,r[a]=t[e]}));const a=e(n);return(0,o.H)(a).forEach((e=>{const t=d(O(a[e]));a[e]=(0,o.H)(r).reduce(((e,t)=>e.replace(new RegExp(P(t),"g"),r[t])),R(t))})),a}},60968:(e,t,n)=>{n.d(t,{Gd:()=>u,Re:()=>s,eQ:()=>i,ex:()=>c,yl:()=>l});var r=n(73095),o=n(19230);let a={currentLocale:void 0,strings:{},errorHandler:e=>console.error(e),loaders:[],stringMapInitialized:!1,suppressEmptyStringMapErrors:(0,r.Nu)()};function i(){return a}function s(e,t){a=(0,o.Bm)(e,t,a)}function l(e){a=(0,o.mL)(e,a)}function c(){return(0,o.kk)(i())}async function u(e){return a=await(0,o.Au)(e,a),a.currentLocale}},73095:(e,t,n)=>{n.d(t,{Cu:()=>a,Nu:()=>s,Ty:()=>l,l6:()=>i});let r=!1,o=!1;function a(){return"undefined"!=typeof __DEV__&&__DEV__&&!o}function i(){return a()||"undefined"!=typeof __SKIP_LOC__&&__SKIP_LOC__}function s(){return Boolean("undefined"!=typeof process&&process.env&&!1)}function l(){return!("undefined"==typeof __DEV__||!__DEV__||o||"undefined"!=typeof __DISABLE_PSEUDO_LOC__&&__DISABLE_PSEUDO_LOC__||r)}},60235:(e,t,n)=>{n.d(t,{UI:()=>l}),n(39583);var r=n(51031),o=n(81169),a=n(28631);function i(e){throw new Error(e)}function s(e){return(e=(0,r.Zb)(e.trim()))&&!(0,r.d5)(e,".")&&(e+="."),e}function l(e,t){const n=(0,o.H)(t.placeholders).filter(r.Kg).sort(),l={};for(const e of(0,o.H)(t.placeholders))l[e]=(0,r.Kg)(e)?`{${n.indexOf(e)}}`:i(`Placeholder name ${e} is not a string`);const c=t.text(l),u=[t.comment,...n.map(((e,n)=>{const o=t.placeholders[e].trim();return o?`{${n}} is a placeholder for ${(0,r.oZ)(o)}`:null}))];let d=(0,a.S)(u).map(s).filter(Boolean).join(" ");return n.forEach(((e,t)=>{d=d.replace("{"+e+"}","{"+t+"}")})),{key:e,stringToBeLocalized:c,comment:d,placeholderNames:n}}n(31033)},19230:(e,t,n)=>{n.d(t,{Bm:()=>l,mL:()=>c,kk:()=>u,uy:()=>i,eX:()=>f,Au:()=>g,KU:()=>m}),n(87847);var r=n(87748),o=n(81169),a=n(73095);function i(e,t){t.errorHandler(e)}const s=(0,r.J)(((e,t)=>{const n=h(t);return t=>Promise.resolve(e===t?n:{})}));function l(e,t,n){if(n.currentLocale===e||void 0===n.currentLocale){const r=h(t);return{...n,currentLocale:void 0===n.currentLocale?e:n.currentLocale,strings:{...n.strings,...r},stringMapInitialized:!0}}return c(s(e,t),n)}function c(e,t){return-1===t.loaders.indexOf(e)?{...t,loaders:t.loaders.concat(e)}:t}function u(e){return d?d.then((e=>e.currentLocale)):Promise.resolve(e.currentLocale)}let d;function g(e,t){const n=async function(e,t){const n=t.loaders.map((async n=>{try{return await n(e)}catch(e){const n=e.message||"unknown error";return t.errorHandler(`Async string map loader failed: ${n}`),{}}}));return(await Promise.all(n)).map(h).reduce(((e,t)=>({...e,...t})),{})}(e,t).then((n=>({...t,strings:n,currentLocale:e,stringMapInitialized:!0})));return d=d?d.then((()=>n)):n}function h(e){const t={};return e&&function e(n,r){for(const a of(0,o.H)(r))if("string"==typeof a){const o=r[a];"string"==typeof o?t[n+a]=o:"object"==typeof o&&e(n+a+".",o)}}("",e),t}function m(e,t){return"string"==typeof t.strings[e]}function f(e,t){const n=t.strings[e]??t.strings[function(e){if(0===e.length)return"0";if("#"===e[0])return e;let t=0;for(let n=0;n<e.length;++n)t=(t<<5)-t+e.charCodeAt(n)|0;return"#"+t.toString(36)}(e)];if(!n||"string"!=typeof n){const n=(0,a.Cu)()||(0,a.Nu)()?e:"";return function(e){for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}(t.strings)?!t.suppressEmptyStringMapErrors&&t.errorHandler(`The current string map is empty. The string is probably resolved too early, at import time. Key: ${e}`):t.errorHandler(`Key ${e} does not exist in string map`,{stringsLoaded:!!t.stringMapInitialized}),n}return n}},75558:(e,t,n)=>{n.d(t,{U5:()=>a}),n(39583),n(31033);const r=["af","am","ar","as-in","az-latn-az","be-by","bg","bn-in","bn-bd","bs-latn-ba","ca","ca-es-valencia","cs","cy","da","de","el","en-gb","en-us","es","es-mx","et","eu","fa","fi","fil","fr","fr-ca","ga-ie","gd-gb","gl","gu","ha-latn-ng","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","ky","lb-lu","lo-la","lt","lv","mi-nz","mk","ml","mn-mn","mr","ms","mt-mt","ne-np","nl","nn-no","no","or","pa-in","pl","prs","pt","pt-pt","quz-pe","ro","ru","sd-arab-pk","si-lk","sk","sl","sq","sr","sr-cyrl","sr-cyrl-ba","sv","sw","ta","te","th","tk-tm","tr","tt","ug-cn","uk","ur","uz","vi","zh-hans","zh-hant","zu-za"];function o(e){return r.indexOf(e)>=0}function a(e,t){if(e){const t=e.toLowerCase().replace("_","-"),n=i(t);if(n)return n;if(o(t))return t;const a=t.split("-");if(a.length>2){const e=a.slice(0,a.length-1).join("-");if(o(e))return e;const t=i(e);if(t)return t}if(a.length>1){const e=a[0];if(o(e))return e}const s=t.substr(0,2);if(o(s))return s;const l=i(s);if(l)return l;for(const e of r)if(0===e.indexOf(s))return e}if(t)return t;throw new Error(`${e} cannot be mapped to a supported locale`)}function i(e){if(0===e.indexOf("es-")&&"es-es"!==e)return"es-mx";if(0===e.indexOf("en-")&&"en-us"!==e)return"en-gb";if(0===e.indexOf("ja-"))return"ja";switch(e){case"zh-hk":case"zh-mo":case"zh-rhk":case"zh-rtw":case"zh-tw":return"zh-hant";case"zh-rcn":case"zh-sg":return"zh-hans";case"ga":return"ga-ie";case"in":return"id";case"iw":return"he";case"nb":return"no";default:return}}},64130:(e,t,n)=>{n.d(t,{K:()=>a,r:()=>o});var r=n(62399);const o=()=>{var e;return(null===(e=window.configuration)||void 0===e?void 0:e.environmentName)??r.D.Unknown},a=()=>{var e;return(null===(e=window.configuration)||void 0===e?void 0:e.buildVersion)??null}},79845:(e,t,n)=>{n.d(t,{UP:()=>r,gm:()=>o,lT:()=>i,nr:()=>a});const r=()=>{var e;return(null===(e=window.navigator.userAgent)||void 0===e?void 0:e.indexOf("Edg/"))>0},o=()=>{var e;return(null===(e=window.navigator.userAgent)||void 0===e?void 0:e.indexOf("Firefox"))>0},a=()=>{var e,t;const n=(null===(e=window.navigator.userAgent)||void 0===e?void 0:e.indexOf("Chrome"))>-1;return(null===(t=window.navigator.userAgent)||void 0===t?void 0:t.indexOf("Safari"))>-1&&!n},i=()=>{const e=window.navigator.userAgent.indexOf("MSIE ")>-1,t=window.navigator.userAgent.indexOf("Trident/")>-1;return e||t}},41932:(e,t,n)=>{n.d(t,{J:()=>o,X:()=>r});var r=function(e){return e.StartTime="X-start-time",e.CorrelationId="X-correlation-id",e.RetryAttempt="X-retry-attempt",e.RetryAfter="X-retry-after",e.APIName="X-api-name",e.Area="X-area",e.SubArea="X-sub-area",e}({});const o=[429,503,504,408,500]},46808:(e,t,n)=>{n.d(t,{Kn:()=>i,cn:()=>l,k$:()=>o,mh:()=>s,yO:()=>c});var r=n(35609);const o=(0,r.eU)([]),a=(0,r.zp)(),i=e=>{a.set(o,(t=>[...t,e]))},s=e=>a.get(o).find((t=>t.type===e)),l=e=>{a.set(o,(t=>t.filter((t=>t.type!==e))))},c=()=>{a.set(o,[])}},62399:(e,t,n)=>{n.d(t,{D:()=>r,z:()=>o});var r=function(e){return e.Unknown="unknown",e.Fastfood="fastfood",e.Dogfood="dogfood",e.Production="production",e.GCCHigh="gcchigh",e.DoD="dod",e.Gallatin="gallatin",e.AirGap08="airgap08",e.AirGap09="airgap09",e}({}),o=function(e){return e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Unknown="Unknown",e}({})},79927:(e,t,n)=>{n.d(t,{T:()=>r});var r=function(e){return e.Signin="Signin",e.Signup="Signup",e}({})},41246:(e,t,n)=>{n.d(t,{OC:()=>r,cH:()=>o}),n(39552);var r=function(e){return e.None="none",e.OpenFilePicker="OpenFilePicker",e.UploadBlankFile="UploadBlankFile",e.OpenNewDocument="OpenNewDocument",e.UploadResume="UploadResume",e.OpenInNewTab="OpenInNewTab",e.UnauthEditControl_CommandButtons="UnauthEditControl_CommandButtons",e.UnauthEditControl_Create="UnauthEditControl_Create",e.AccountSwitching="AccountSwitching",e}({});const o="intents:"},62091:(e,t,n)=>{n.d(t,{u:()=>r});var r=function(e){return e.Word="WordHomePage",e.Excel="ExcelHomePage",e.PowerPoint="PowerPointHomePage",e.OneNote="OneNoteHomePage",e.Unknown="Unknown",e}({})},83337:(e,t,n)=>{n.d(t,{G:()=>a});var r=n(71124),o=n(86113);function a(e){let{lookupString:t,children:n}=e;const a=(0,o.eO)(),i=r.useMemo((()=>{return{lookupString:(e=t,n=a.lookupString,t=>r=>{const o=e(t)(r);if(o!==t)return o;const a=n(t)(r);return a!==t?a:t})};var e,n}),[t,a]);return r.createElement(o.d7,{value:i},n)}},86113:(e,t,n)=>{n.d(t,{d7:()=>i,eO:()=>s});var r=n(27285),o=n(71124);const a=(0,r.m)({lookupString:e=>()=>e},"LocalizationComponentsStringProvider"),i=a.Provider;function s(){return o.useContext(a)}},27285:(e,t,n)=>{n.d(t,{m:()=>a});var r=n(71124);const o=(0,n(80054).D)("@1js/create-shared-react-context",{});function a(e,t){const n=o.get();return n[t]||(n[t]=r.createContext(e))}},21446:(e,t,n)=>{n.d(t,{i:()=>g,O:()=>m}),n(39552),n(39583);var r=n(74465),o=n(26406),a=n(12661),i=n(32041),s=n(48686),l=n(22905);const c=["interaction_required","consent_required","login_required","bad_token","no_tokens_found","native_account_unavailable","refresh_token_expired","monitor_window_timeout"],u=["no_network_connectivity","endpoints_resolution_error","authorization_code_missing_from_server_response","state_not_found","post_request_failed"];var d=n(35530);const g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{overrideToOneDriveForMSA:!1},n=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;const g=d.Jp.getActiveAccount();try{return await(0,r.L)((async()=>await h(e,t,n,g,l)),{totalAttempts:5,delayInMs:50,functionName:n,exponentialBackoff:!0,isRetryable:e=>!(e instanceof i.lR)||u.includes(e.errorCode)})}catch(t){const r=t,i=t instanceof s.CB||c.includes(null==r?void 0:r.errorCode),u=r&&"invalid_grant"===r.errorCode&&r.errorMessage.startsWith("AADSTS700084");if(i||u){var m;(0,o.a)({eventName:"GetTokenRedirect",httpCode:200,latency:0,subArea:"AuthUtilites",area:n});const t={...e,loginHint:null==g||null===(m=g.idTokenClaims)||void 0===m?void 0:m.login_hint,claims:l};await d.Jp.acquireTokenRedirect(t)}else(0,a.v)({eventName:"GetTokenError",errorType:"Auth_Error",errorCode:null==r?void 0:r.errorCode,message:null==r?void 0:r.errorMessage,debugInfo:JSON.stringify(r)})}return null},h=async(e,t,n,r,a)=>{if(!r)return null;a&&(e={...e,claims:a}),t.overrideToOneDriveForMSA&&(0,l.Xu)((0,l.EO)(r))&&(e={...e,scopes:["OneDrive.ReadWrite"],authority:"https://login.microsoftonline.com/consumers"});const i=performance.now();try{const t=await d.Jp.acquireTokenSilent({...e,redirectUri:l.AK,account:r});return(0,o.a)({eventName:"GetToken",httpCode:200,latency:performance.now()-i,subArea:"AuthUtilites",area:n}),t}catch(e){const t=e;throw(0,o.a)({eventName:"GetToken",httpCode:500,latency:performance.now()-i,subArea:"AuthUtilites",area:n,error:null==t?void 0:t.errorCode}),e}},m=e=>{const t={};if(-1!=e.indexOf(" ")){const n=e.indexOf(" ");e.substring(n+1).split(",").forEach((e=>{const[n,r]=e.split("=");t[n.trim()]=window.decodeURI(r.replace(/['"]+/g,""))}))}return t}},22905:(e,t,n)=>{n.d(t,{AK:()=>l,C:()=>h,DR:()=>i,E9:()=>m,EO:()=>u,F:()=>f,FZ:()=>T,Pl:()=>S,Pn:()=>p,W1:()=>v,Xu:()=>c,ZF:()=>E,a1:()=>s,p$:()=>g,xk:()=>w}),n(39552),n(39583);var r=n(63280),o=n(13029),a=n(35530);const i="9188040d-6c67-4c5b-b112-36a304b66dad",s="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa",l="https://"+window.location.host+"/auth.html",c=e=>e===i,u=e=>{var t;return e||(e=a.Jp.getActiveAccount()),(null==e||null===(t=e.idTokenClaims)||void 0===t?void 0:t.tid)??null},d=e=>{if(!e)return null;const t=e.split("@");return 2===t.length?t[1]:null},g=e=>{var t,n;return e||(e=a.Jp.getActiveAccount()),(null==e||null===(t=e.idTokenClaims)||void 0===t?void 0:t.upn)??(null==e||null===(n=e.idTokenClaims)||void 0===n?void 0:n.preferred_username)??null},h=e=>{if(!e)return null;const t=d(e);return t?t.split(".")[0]:null},m=e=>{var t;return e||(e=a.Jp.getActiveAccount()),"microsoft.com"===(null===(t=d(g(e)))||void 0===t?void 0:t.toLowerCase())},f=e=>{var t;return e||(e=a.Jp.getActiveAccount()),(null==e||null===(t=e.idTokenClaims)||void 0===t?void 0:t.oid)??null},p=e=>{var t;return(null==e||null===(t=e.idTokenClaims)||void 0===t?void 0:t.puid)??null},E=e=>{var t;return e||(e=a.Jp.getActiveAccount()),(null==e||null===(t=e.idTokenClaims)||void 0===t?void 0:t.ageGroup)??0},v=e=>{const t=g(e),n=h(t)??"",r=(e=>e&&e.includes("@")&&e.includes(".")?e.trim().toLowerCase().replace(/[@.]/g,"_"):null)(t)??"";return`https://${n}-my.sharepoint.com/personal/${r}`},S=e=>{const t=g(e);return`https://${h(t)??""}.sharepoint.com`},w=e=>{var t;e||(e=a.Jp.getActiveAccount());const n="EU"===(null==e||null===(t=e.idTokenClaims)||void 0===t?void 0:t.xms_tdbr)?r.n.EU:((0,o.t)({featureName:"AccountUtils",message:"DataBoundary claim not present, defaulting to RoW"}),r.n.RoW);return(0,o.t)({featureName:"AccountUtils",message:`DataBoundary read from claim: ${n}`}),n},T=e=>{var t,n;return e||(e=a.Jp.getActiveAccount()),!e||c(u(e))||m(e)||"tempeuhomepages.onmicrosoft.com"===(null===(t=d(g(e)))||void 0===t?void 0:t.toLowerCase())||"temphomepages.onmicrosoft.com"===(null===(n=d(g(e)))||void 0===n?void 0:n.toLowerCase())}},35530:(e,t,n)=>{n.d(t,{ef:()=>C,Jp:()=>I});var r=n(41246),o=n(46808),a=n(79845),i=n(43176),s=n(73957),l=n(12661),c=n(28630),u=n(13029),d=n(68948),g=n(65337),h=n(45714),m=n(78705),f=n(29701),p=n(51681),E=n(70374),v=n(33894),S=n(22268),w=(n(39552),n(26406)),T=n(48686),y=n(22905);const C=async(e,t,n,r,o,a)=>{if((0,u.t)({featureName:"LoginRedirect",pageName:n},{SubArea:r,ScenarioId:o??""}),o&&o==d.C.UnauthAppHomePage){const e=window.location.href;let n=g.O.Unauth;a&&(n=g.O.UnauthControl);const o=t.wdOrigin;let i=(0,h.Io)(e,n,o);"SignInButton"===r&&(i=(0,h.Io)(i,g.O.ShellSignIn,o)),window.history.replaceState?window.history.replaceState({path:i},"",i):(0,l.v)({eventName:"AccessHistoryAPIError",errorType:"URF_Error",message:"Unable to access the HTML5 History API. Cannot append the new wdOrigin to the URL.",subArea:r})}await I.loginRedirect({...e,correlationId:t.sessionId,scenarioId:null==o?void 0:o.toString()})},A={auth:{clientId:"2821b473-fe24-4c86-ba16-62834d6e80c3",authority:"https://login.microsoftonline.com/common",postLogoutRedirectUri:"https://"+window.location.host,clientCapabilities:["CP1"],redirectUri:window.location.origin},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:(0,a.lT)()||(0,a.UP)()||(0,a.gm)()},system:{loggerOptions:{loggerCallback:(e,t,n)=>{if(!n)switch(e){case m.$.Error:return void(0,l.v)({eventName:"MsalAuthConfigError",errorType:"Auth_Error",message:"Error in msal auth config",debugInfo:t});case m.$.Warning:return void(0,u.t)({featureName:"MsalAuthConfigWarning",message:t});case m.$.Verbose:return void(0,u.t)({featureName:"MsalAuthConfigVerbose",message:t});default:return}}},iframeHashTimeout:2e4,loadFrameTimeout:2e4}},N={actAsBroker:!0,preferredInteractionType:p.X8.Redirect},I=new E.E(A,N,{enableMATS:!0,appName:"AppHomePages",appVersion:"1.0"});I.addEventCallback((async e=>{if(e.eventType===f.B.SSO_SILENT_SUCCESS&&e.payload)"logout"===sessionStorage.getItem(i.l.RequestOrigin)&&sessionStorage.removeItem(i.l.RequestOrigin),(0,u.t)({featureName:"SSOSilent",message:"Success"});else if(e.eventType===f.B.LOGOUT_SUCCESS)(0,v.U)(S.k.LoggedOut),localStorage.setItem(s.U.UserRecentlyLoggedOut,"true"),sessionStorage.setItem(i.l.RequestOrigin,"logout"),(0,c.Km)({eventName:"SignOutSuccess",area:"UnauthShell",result:"SignOut",target:"UnauthShell"});else if(e.eventType===f.B.LOGIN_FAILURE){var t,n;e.interactionType!=p.X8.Silent&&(0,l.v)({eventName:"SignInFailure",errorType:"Auth_Error",errorCode:null===(t=e.error)||void 0===t?void 0:t.name,debugInfo:null===(n=e.error)||void 0===n?void 0:n.message})}else if(e.eventType===f.B.LOGOUT_FAILURE){var r,o;(0,l.v)({eventName:"SignOutFailure",errorType:"Auth_Error",errorCode:null===(r=e.error)||void 0===r?void 0:r.name,debugInfo:null===(o=e.error)||void 0===o?void 0:o.message})}else e.eventType===f.B.ACQUIRE_TOKEN_SUCCESS&&e.payload&&(0,v.U)(S.k.LoggedIn)})),I.initializeBrokering().then((()=>I.initialize().then((()=>{I.handleRedirectPromise().then((e=>(async e=>{if(e){if(e.state){const t=(e=>{const t=e.split("|").find((e=>e.startsWith(r.cH)));let n=!1;if(t)try{const e=JSON.parse(t.substring(r.cH.length));null==e||e.forEach((e=>{(0,o.Kn)(e)})),n=!0}catch(e){n=!1}return n})(e.state);!1===t&&(0,l.v)({eventName:"UserIntentError",area:"AuthShell",errorType:"App_Error",message:"Error parsing user intent from state"})}"logout"===sessionStorage.getItem(i.l.RequestOrigin)&&sessionStorage.removeItem(i.l.RequestOrigin);const t=e.account;I.setActiveAccount(t),(0,v.U)(S.k.LoggedIn),localStorage.setItem(s.U.UserRecentlyLoggedOut,"false"),(0,c.Km)({eventName:"SignInSuccess",area:"AuthShell",result:"SignIn",target:"AuthShell"})}else{const e=localStorage.getItem(s.U.UserRecentlyLoggedOut),t=I.getAllAccounts();if((null==t?void 0:t.length)>0)return(0,v.U)(S.k.LoggedIn);if((null===e||"false"===e)&&0==(null==t?void 0:t.length))return await(async e=>{(0,u.t)({featureName:"SSOSilent",message:"No accounts in cache, trying SSO silent call."});const t=performance.now(),n=(0,h.i9)(),r=(0,a.nr)()?e.loginPopup({scopes:["User.Read"],redirectUri:y.AK,prompt:"none",loginHint:n}):e.ssoSilent({scopes:["User.Read"],redirectUri:y.AK,loginHint:n});(0,u.t)({featureName:"SSOSilent"},{MethodName:(0,a.nr)()?"loginPopup":"ssoSilent"}),await r.then((n=>{const r=performance.now();(0,w.a)({eventName:"SSOSilent",httpCode:200,latency:r-t,subArea:"AuthUtilites"}),n.accessToken||(0,v.U)(S.k.LoggedOut);const o=n.account;e.setActiveAccount(o),(0,v.U)(S.k.LoggedIn)})).catch((async n=>{var r,o;(0,v.U)(S.k.LoggedOut);const a=performance.now(),i=n;(0,w.a)({eventName:"SSOSilent",httpCode:500,latency:a-t,subArea:"AuthUtilites",error:`${null==i?void 0:i.errorCode}-${null==i?void 0:i.errorMessage}`}),n instanceof T.CB||"popup_window_error"===(null==i?void 0:i.errorCode)?n instanceof T.CB&&(null==n||null===(r=n.errorMessage)||void 0===r?void 0:r.includes("AADSTS"))&&!(null==n||null===(o=n.errorMessage)||void 0===o?void 0:o.includes("AADSTS50058"))?((0,c.Km)({eventName:"SignInAccount",area:"AuthShell",result:"SignIn",target:"Other"},{Message:"SSO Silent call failed with an interactive error"}),await e.loginRedirect({scopes:["User.Read"],prompt:"select_account"})):(0,u.t)({featureName:"SSOSilent",message:`SSO silent call failed - ${i}`}):(0,l.v)({eventName:"SSOSilentError",errorType:"Auth_Error",errorCode:null==i?void 0:i.errorCode,message:null==i?void 0:i.errorMessage,debugInfo:null==i?void 0:i.message})}))})(I);(0,v.U)(S.k.LoggedOut)}})(e)))}))))},33894:(e,t,n)=>{n.d(t,{U:()=>s,t:()=>a});var r=n(35609),o=n(22268);const a=(0,r.eU)(o.k.Unknown),i=(0,r.zp)(),s=e=>{i.set(a,e)}},22268:(e,t,n)=>{n.d(t,{k:()=>r});var r=function(e){return e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut",e[e.Unknown=2]="Unknown",e}({})},70703:(e,t,n)=>{n.d(t,{K5:()=>o,cj:()=>a});var r=n(35609);const o=(0,r.eU)(null),a=((0,r.eU)((e=>!!e(o))),(0,r.eU)(null))},63280:(e,t,n)=>{n.d(t,{n:()=>r});var r=function(e){return e.EU="EU",e.RoW="RoW",e}({})},87558:(e,t,n)=>{n.d(t,{$:()=>r});var r=function(e){return e.Unknown="unknown",e.Fastfood="fastfood",e.Dogfood="dogfood",e.Production="production",e.GCC="gcc",e.GCCHigh="gcchigh",e.DoD="dod",e.Gallatin="gallatin",e.AirGap08="airgap08",e.AirGap09="airgap09",e}({})},69767:(e,t,n)=>{n.d(t,{_t:()=>o,i9:()=>r,wL:()=>a});const r=new Set(["ar-sa","bg-bg","cs-cz","da-dk","de-de","el-gr","en-gb","en-us","es-es","es-mx","et-ee","fi-fi","fr-ca","fr-fr","he-il","hr-hr","hu-hu","id-id","it-it","ja-jp","ko-kr","lt-lt","lv-lv","nl-nl","nb-no","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sv-se","th-th","tr-tr","uk-ua","vi-vn","zh-hans","zh-hant"]),o=e=>"en-gb"===e?"en-us":"es-mx"===e?"es-es":"fr-ca"===e?"fr-fr":"zh-hans"===e?"zh-cn":"zh-hant"===e?"zh-tw":e,a=e=>{const t=e.toLowerCase();return"zh-cn"===t?"zh-hans":"zh-tw"===t?"zh-hant":e}},73865:(e,t,n)=>{n.d(t,{jC:()=>i,WF:()=>a,r$:()=>s});var r=n(35609);n(39552);const o=["ar-sa","fa-ir","he-il","sd-pk","ug-cn","ur-pk"],a=(0,r.eU)(null),i=(0,r.eU)((e=>!!e(a))),s=(0,r.eU)((e=>{const t=e(a);return t?(e=>o.includes(e)?"rtl":"ltr")(t):"ltr"}))},55082:(e,t,n)=>{n.d(t,{J:()=>r});const r=(e,t,n)=>{let r=Math.pow(2,e)*t;return n&&(r=Math.min(r,n)),Math.max(0,r)}},38305:(e,t,n)=>{n.d(t,{p:()=>r});const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Math.random()*Math.max(1,e)}},74465:(e,t,n)=>{n.d(t,{L:()=>o}),n(4589);var r=n(55082);const o=async(e,t)=>{let n,{totalAttempts:o,delayInMs:a,maxDelayInMs:i=Number.MAX_VALUE,exponentialBackoff:s=!1,isValid:l=e=>!!e,isRetryable:c=()=>!0}=t;o=Math.max(1,o),a=Math.max(0,a),i=Math.max(0,i);let u=null;const d=[];for(n=0;n<o;n++){try{const t=await e();if(l(t))return t;u=null}catch(e){u=e,d.push(u)}if(n===o-1||u&&!c(u)){n+=1;break}{const e=s?(0,r.J)(n,a,i):Math.min(a,i);await new Promise((t=>setTimeout(t,e)))}}if(d.length>0)throw d[d.length-1];return null}},73957:(e,t,n)=>{n.d(t,{U:()=>r});var r=function(e){return e.UserRecentlyLoggedOut="userRecentlyLoggedOut",e.FlightOverridingAllowed="flightOverridingAllowed",e.OpenNewDocument="openNewDocument",e}({})},43176:(e,t,n)=>{n.d(t,{l:()=>r});var r=function(e){return e.UnauthEditWdParamCache="editWdParams",e.RequestOrigin="requestOrigin",e.AuthLocalePreference="sessionLocalePreference",e}({})},37043:(e,t,n)=>{n.d(t,{xA:()=>l,bX:()=>u,Vq:()=>c,$s:()=>i,G4:()=>s}),n(4589);let r=[];const o=new class{queueEvent(e){this.queuedEvents.push(e)}drainQueue(){return this.queuedEvents.splice(0,this.queuedEvents.length)}constructor(){this.queuedEvents=[]}};let a=!1;function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.length>0?r.forEach((n=>{n.logEvent(e,t)})):s(e,t)}function s(e,t){const n={eventName:e,params:t};o.queueEvent(n)}function l(){o.drainQueue().forEach((e=>{i(e.eventName,e.params)}))}function c(e){r.length>0||e&&0!==e.length&&(r=e.slice(),l())}function u(){a||(a=!0,l(),r.length>0&&r.forEach((e=>{e.flush()})),a=!1)}},28524:(e,t,n)=>{n.d(t,{a:()=>c});var r=n(12661),o=n(13029),a=n(74679);function i(e){return Math.round(10*e)/10}class s{get browserSupportsPerformanceTimeline(){try{return!(void 0===window.performance||null===window.performance||void 0===window.performance.getEntriesByType||null===window.performance.getEntriesByType)}catch(e){return(0,r.v)({eventName:"BrowserSupportsPerformanceTimeline",errorType:"ResourceTimingLogger_Error",message:`Error while checking if browser supports performance timeline ${e}`,area:"ResourceTimingLogger"}),!1}}resourceTimingShouldBeAggregated(e){return e.endsWith(".js")||e.endsWith(".css")||e.endsWith(".webp")||e.endsWith(".svg")}isTimingCached(e){try{const t=e.transferSize;return null!=t&&0!==t?!t:e.responseEnd-e.fetchStart<this._cacheThresholdInMs}catch(e){(0,r.v)({eventName:"IsTimingCached",errorType:"ResourceTimingLogger_Error",area:"ResourceTimingLogger",message:"Error attempting to get cache value of resource {e}"})}return!1}tryAggregateResourceTiming(e){const t=function(e){if(!e)return"";const t=-1===e.indexOf("#")?e.length:e.indexOf("#");let n=e.lastIndexOf("/",t);if(-1!==n&&n+1===e.indexOf("://")+3)return"";n+=1;let r=e.indexOf("?");if(r=r>=t?-1:r,-1!==r&&n>r)return"";const o=-1===r?t:r;return n>=o?"":e.substring(n,o)}(e.name.toLowerCase());if(this.resourceTimingShouldBeAggregated(t)){if(t in this._aggregatedResourceMetrics)return(0,o.t)({featureName:"ResourceTimingLogger",message:`file downloaded multiple times for filename: ${t}`}),!1;const n={startTime:i(e.startTime),workerStart:i(e.workerStart),redirectStart:i(e.redirectStart),redirectEnd:i(e.redirectEnd),fetchStart:i(e.fetchStart),domainLookupStart:i(e.domainLookupStart),domainLookupEnd:i(e.domainLookupEnd),connectStart:i(e.connectStart),secureConnectionStart:i(e.secureConnectionStart),connectEnd:i(e.connectEnd),requestStart:i(e.requestStart),responseStart:i(e.responseStart),responseEnd:i(e.responseEnd),isCached:this.isTimingCached(e),nextHopProtocol:e.nextHopProtocol,encodedSize:e.encodedBodySize,decodedSize:e.decodedBodySize};return this._aggregatedResourceMetrics[t]=n,!0}return!1}getResourceTimings(){if(this.browserSupportsPerformanceTimeline)try{const e=window.performance.getEntriesByType("resource"),t=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);t&&(window.performance.clearResourceTimings(),this._currentEntryIndex=0);let n=!1;for(let t=this._currentEntryIndex;t<e.length;t++)n=this.tryAggregateResourceTiming(e[t])||n;n?this._idleRunCount=0:(this._idleRunCount++,this._idleRunCount>=this._idleRunsThreshold&&(this.stopLogger(),this._idleRunCount=0,(0,o.t)({featureName:"ResourceTimingLogger",message:"Reached idle time limit. Stopping logger as no new entries were found"}),this.logResourceTimings())),t||(this._currentEntryIndex=e.length)}catch(e){(0,r.v)({eventName:"GetResourceTimings",message:"ResourceTimingLogger.Flush: Error while logging resource timings. Error: ${e}",errorType:"ResourceTimingLogger_Error",area:"ResourceTimingLogger"})}}getAdditionalData(){if(!this._aggregatedResourceMetrics)return"";let e=0,t=0,n=0,r=0,o=0,a=0,i=0,s=0,l=0,c=0,u=0;for(const d in this._aggregatedResourceMetrics){const g=this._aggregatedResourceMetrics[d];void 0!==g.responseEnd&&(e+=g.responseEnd-g.fetchStart,c++),!0===g.isCached?(u++,n+=g.responseEnd-g.fetchStart,a+=g.encodedSize,l+=g.decodedSize):(t+=g.responseEnd-g.fetchStart,o+=g.encodedSize,s+=g.decodedSize),r+=g.encodedSize,i+=g.decodedSize}const d={totalResourceDownloadLatency:e,totalResourceDownloadLatencyForCacheMiss:t,totalResourceDownloadLatencyForCacheHit:n,totalEncodedDataDownloaded:r,totalEncodedDataDownloadedForCacheMiss:o,totalEncodedDataDownloadedForCacheHit:a,totalDecodedDataDownloaded:i,totalDecodedDataDownloadedForCacheMiss:s,totalDecodedDataDownloadedForCacheHit:l,totalNumberOfResourcesDownloaded:c,totalNumberOfCachedResourcesDownloaded:u};return JSON.stringify(d)}getAggregateResourceTimings(){return JSON.stringify(this._aggregatedResourceMetrics)}logResourceTimings(){if(null!=this._aggregatedResourceMetrics&&Object.keys(this._aggregatedResourceMetrics).length>0){const e=this.getAggregateResourceTimings(),t=this.getAdditionalData();if(e.length<25e3)(0,a.N)({eventName:"ResourceTimingLogger",resourceTimingsData:e,summarizedResourceTimingsData:t});else{const e=Object.keys(this._aggregatedResourceMetrics).length,n=Object.entries(this._aggregatedResourceMetrics);for(let r=0;r<e;r+=50){const e=JSON.stringify(Object.fromEntries(n.slice(r,r+50)));(0,a.N)({eventName:"ResourceTimingLogger",resourceTimingsData:e,summarizedResourceTimingsData:t})}}this._aggregatedResourceMetrics={}}}runLogger(){this.browserSupportsPerformanceTimeline&&(this._timerId=window.setInterval((()=>this.getResourceTimings()),1e3*this._loggerTimerIntervalInSeconds))}stopLogger(){this._timerId&&(clearInterval(this._timerId),this._timerId=void 0)}constructor(e=100,t=3,n=3){this._currentEntryIndex=0,this._aggregatedResourceMetrics={},this._idleRunCount=0,this._cacheThresholdInMs=e,this._loggerTimerIntervalInSeconds=t,this._idleRunsThreshold=n}}let l;function c(){return l||(l=new s),l}},19689:(e,t,n)=>{n.d(t,{f$:()=>o,rK:()=>a,xd:()=>r});const r=".",o="1.0.0",a=["word.cloud-dev.microsoft","excel.cloud-dev.microsoft","powerpoint.cloud-dev.microsoft","onenote.cloud.dev.microsoft","df.word.cloud.microsoft","df.excel.cloud.microsoft","df.powerpoint.cloud.microsoft","df.onenote.cloud.microsoft","word.cloud.microsoft","excel.cloud.microsoft","powerpoint.cloud.microsoft","onenote.cloud.microsoft"]},47967:(e,t,n)=>{n.d(t,{o:()=>s}),n(39552);const r=["ResizeObserver loop completed with undelivered notifications","ResizeObserver loop limit exceeded"],o=["chrome-extension://","moz-extension://"];var a=n(12661);const i=new Set,s=()=>{window.onerror=function(e,t,n,s,l){const c=(null==e?void 0:e.toString())||"",u=!((e,t)=>!!e&&r.some((t=>e.includes(t)))||!!t&&o.some((e=>t.includes(e))))(c,t),d=!i.has(c);(u||d)&&(u||i.add(c),(0,a.v)({debugInfo:JSON.stringify({source:t,lineno:n,colno:s,stack:null==l?void 0:l.stack}),eventName:u?"DefaultErrorCatcher":"KnownErrorCatcher",errorType:"CatchAll_Error",message:c}))},window.onunhandledrejection=e=>{e&&(0,a.v)({debugInfo:JSON.stringify(null==e?void 0:e.reason),eventName:"DefaultErrorCatcher",errorType:"UnhandledRejection_Error"})}}},3123:(e,t,n)=>{n.d(t,{dL:()=>i,rI:()=>s,tT:()=>o});var r=n(35609);const o=(0,r.eU)(!1),a=(0,r.zp)(),i=e=>{a.set(o,e)},s=()=>a.get(o)},93936:(e,t,n)=>{n.d(t,{I_:()=>o,Pn:()=>a,Xu:()=>r});const r=e=>"9188040d-6c67-4c5b-b112-36a304b66dad"===e,o=(e,t)=>(null==e?void 0:e.homeAccountId)!==(null==t?void 0:t.homeAccountId),a=e=>{var t;return(null==e||null===(t=e.idTokenClaims)||void 0===t?void 0:t.puid)??null}},80366:(e,t,n)=>{n.d(t,{h:()=>r});var r=function(e){return e.PageView="PageView",e.Action="Action",e.Refer="Refer",e.Request="Request",e.Component="Component",e.Performance="Performance",e.Error="Error",e.Activity="Activity",e.Feature="Feature",e.Session="Session",e}({})},97565:(e,t,n)=>{n.d(t,{L:()=>r});var r=function(e){return e.Main="Main",e.SearchResult="SearchResult",e.Open="Open",e.OpenError="OpenError",e.Edit="Edit",e.EditError="EditError",e.SignIn="SignIn",e.SignUp="SignUp",e.SignOut="SignOut",e.AccessDenied="AccessDenied",e.Upload="Upload",e.CoverLetter="CoverLetter",e.Chat="Chat",e.NewDocument="NewDocument",e.GPTHandoff="GPTHandoff",e.MarketingHandoff="MarketingHandoff",e.Unknown="Unknown",e}({})},68948:(e,t,n)=>{n.d(t,{C:()=>o,N:()=>a});var r=n(62399),o=function(e){return e.UnauthAppHomePage="UnauthAppHomePage",e.WordMarketingPage="WordMarketingPage",e.PowerPointMarketingPage="PowerPointMarketingPage",e.ExcelMarketingPage="ExcelMarketingPage",e.UploadPage="UploadPage",e.CalendarIntentPage="CalendarIntentPage",e.CertificateIntentPage="CertificateIntentPage",e.CoverLetterIntentPage="CoverLetterIntentPage",e.LetterIntentPage="LetterIntentPage",e.BusinessPresentationIntentPage="BusinessPresentation",e.AccountSwitching="AccountSwitching",e.Unknown="Unknown",e}({});const a=e=>{switch(e){case r.z.Word:return"WordMarketingPage";case r.z.PowerPoint:return"PowerPointMarketingPage";case r.z.Excel:return"ExcelMarketingPage";default:return"Unknown"}}},6610:(e,t,n)=>{n.d(t,{$C:()=>h,A2:()=>b,AW:()=>g,B4:()=>r,CX:()=>l,EA:()=>F,Eo:()=>T,FK:()=>w,FP:()=>D,H3:()=>o,I4:()=>L,LF:()=>O,LM:()=>S,Mn:()=>N,Nq:()=>f,OG:()=>W,QA:()=>Q,QX:()=>M,Qg:()=>V,S4:()=>s,Sd:()=>$,Sg:()=>a,Sq:()=>y,TG:()=>B,TT:()=>z,TZ:()=>Y,W_:()=>p,Zk:()=>Z,_:()=>c,b8:()=>I,bI:()=>_,bQ:()=>A,bo:()=>q,br:()=>d,c3:()=>k,cG:()=>E,cH:()=>J,eW:()=>i,eo:()=>C,ff:()=>G,ft:()=>X,lg:()=>K,ms:()=>v,r$:()=>U,tK:()=>x,tU:()=>P,w5:()=>j,wl:()=>u,xt:()=>H,zK:()=>R,zz:()=>m});const r="OfficeAppName",o="RequestOrigin",a="EventSchemaVersion",i="BrowserSessionId",s="DataBoundary",l="DeploymentEnvironment",c="DeviceType",u="AppWorkload",d="AppWorkloadType",g="NetworkType",h="AppLanguage",m="WdOrigin",f="WdPreviousSession",p="WdPreviousSessionSrc",E="ServiceEnvironment",v="EventCategory",S="PageView",w="Component",T="Action",y="Performance",C="Error",A="Request",N="Feature",I="EventName",O="Area",R="SubArea",P="CorrelationId",b="RequestId",k="APIName",M="PageName",D="IsIntentional",F="ComponentName",L="ComponentLifeCycle",U="Target",_="TargetId",x="Result",W="Type",H="HttpCode",G="Error",z="Latency",B="RetryAttempt",$="ErrorType",q="ErrorCode",j="Message",K="DebugInfo",X="Duration",V="Value",Q="ResourceTimingsData",J="SummarizedResourceTimingsData",Y="FeatureName",Z="Message"},53150:(e,t,n)=>{n.d(t,{I:()=>r});const r=(0,n(71124).createContext)({sessionId:"",wdOrigin:"",wdPreviousSession:"",wdPreviousSessionSrc:"",setSessionId:void 0})},27061:(e,t,n)=>{n.d(t,{CX:()=>_,p:()=>x,ip:()=>W,HC:()=>U,T6:()=>B,BI:()=>z,fM:()=>H,mn:()=>G}),n(4589),n(39583);var r=n(62399),o=n(63280),a=n(46922),i=n(68421),s=n(20651),l=n(45119),c=n(33617),u=n(56030),d=n(92321),g=n(86523),h=n(56894),m=n(73100),f=n(71250),p=n(19689),E=n(37043),v=n(6610),S=n(93936);const w=e=>(0,S.Xu)(e)?"Consumer":"Commercial";var T=n(65613),y=n(12661);let C,A,N,I,O,R,P,b,k,M=!1,D=!1,F="",L="";function U(e){var t,n,E,y,L,U;if(!e.utelEnabled||!e.utelAriaTenant||(n=e.correlationId,E=e.sessionId,y=null===(t=e.identity)||void 0===t?void 0:t.tenantId,!(0,T.W)(n)||!(0,T.W)(E)||y&&!(0,T.W)(y)))return;M=!0,F=e.utelAriaNameSpace,C=e.officeAppName,P=function(e){const t=e.replace(/-/g,""),n=g.W.create(t,void 0,h.X.Sampled);return n?(0,c.i_)(n.serialize())??(0,c.FM)():(0,c.FM)()}(e.sessionId),A=new i.M(void 0,void 0,{enableQueue:!0}),A.setTenantToken(e.utelAriaNameSpace,e.utelAriaTenant,s.di),R=function(e,t,n,r,o,a,i,s,l,c,g,h,m,f,E,T,y,C,A){const N=null==h?void 0:h.puid,I=null==h?void 0:h.tenantId,O=I?function(e){return(0,S.Xu)(e)?"MsaPuid":"OrgIdPuid"}(I):"",R=I?w(I):"",P=[...u.qw.getFields({platform:n,name:e,version:a}),...u.Nn.getFields({id:s}),...u.KJ.getFields({primaryIdentityHash:N,primaryIdentitySpace:O,tenantId:null==h?void 0:h.tenantId,tenantGroup:R,isAnonymous:!N})],b=[(0,d.m9)(v.Sg,p.f$),(0,d.m9)(v.H3,E),(0,d.m9)(v.eW,m),(0,d.m9)(v.wl,r),(0,d.m9)(v.br,o),(0,d.m9)(v.$C,i),(0,d.m9)(v._,g),(0,d.m9)(v.B4,t),(0,d.m9)(v.CX,c),(0,d.m9)(v.S4,l),(0,d.m9)(v.cG,f)];return T&&b.push((0,d.m9)(v.AW,T)),y&&b.push((0,d.m9)(v.zz,y)),C&&b.push((0,d.m9)(v.Nq,C)),A&&b.push((0,d.m9)(v.W_,A)),[...P,...b]}(e.appName,e.officeAppName,e.appPlatform,e.appWorkload,e.appWorkloadType,e.appVersion,e.appLanguage,e.correlationId,e.dataBoundary,e.deploymentEnvironment,e.deviceType,e.identity,e.sessionId,e.serviceEnvironment,e.requestOrigin,e.networkType,e.wdOrigin,e.wdPreviousSession,e.wdPreviousSessionSrc),N=m.r,e.deploymentEnvironment,L=e.identity,U=e.dataBoundary,O=(null==L?void 0:L.isOrgId)&&U===o.n.EU?f.d.EUDB:f.d.PUBLIC;const _=function(e){switch(e){case r.D.Fastfood:case r.D.Dogfood:return!0;case r.D.Production:default:return!1}}(e.deploymentEnvironment),x={endpointUrl:O,autoFlushEventsLimit:20,plugins:_?[new a.j]:[],extensionConfig:_?{PrivacyGuardPlugin:{PrivacyGuardPlugin:j(e.utelAriaNameSpace,e.utelAriaTenant,e.officeAppName)}}:{}};return I=new N(R,x),A.addSink(I),D=!0,b=e.utelAriaNameSpace,k=e.utelAriaTenant,e.deploymentEnvironment===r.D.Fastfood&&(0,l.d$)().addListener((e=>{0!==e.level&&1!==e.level||console.log("UTel notification:",e.message())})),(0,l.d$)().addListener(K),A}function _(){return A}function x(){return b}function W(){return k}function H(){D=!1}function G(){D=!0,(0,E.xA)()}function z(e,t){M&&(D?function(e,t){var n;$([F,C,e].join("."),(n=t,Object.entries(n).map((e=>{let[t,n]=e;return function(e,t){return"number"==typeof t?function(e){return q.has(e)}(e)?(0,d.ip)(e,t):(0,d.Ug)(e,t):"boolean"==typeof t?(0,d.LK)(e,t):(0,d.m9)(e,t)}(t,n)}))),1,110)}(e,t):(0,E.G4)(e,t))}function B(e,t){M&&$([F,C,e].join("."),t,1,110)}function $(e,t,n,r){const o=P?{name:"",dataFields:c.LP.getFields(P)}:void 0;A.sendTelemetryEvent({eventName:e,dataFields:t,eventFlags:{dataCategories:n,diagnosticLevel:r},eventContract:o})}const q=new Set(["Performance.Value"]);function j(e,t,n){return{notificationEventName:`${e}.${n}.PrivacyConcern`,iKey:t,scanForUrls:!1}}const K=e=>{if(0===e.level||1===e.level){const t=e.message();L.length+t.length<=1e3?L+=t+", ":L+=t.substring(0,50)+"..., "}};document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&D&&((0,y.v)({eventName:"SendTelemetry_Errors",message:L,errorType:"Telemetry_Error"}),L="")})),window.addEventListener("pagehide",(()=>{D&&(0,E.bX)()}),{capture:!0})},48856:(e,t,n)=>{n.d(t,{b:()=>a,c:()=>o});var r=n(19689);function o(e,t,n){return n?[e,n,t].join(r.xd):[e,t].join(r.xd)}function a(e){return e.join(r.xd)}},71363:(e,t,n)=>{n.d(t,{W:()=>c}),n(39552),n(48419),n(72803),n(80111),n(83734),n(32909),n(57184);var r=n(43176),o=n(65337),a=n(44303),i=n(19689),s=n(12661),l=n(13029);function c(){if("logout"===sessionStorage.getItem(r.l.RequestOrigin))return o.O.Logout;const e=function(){const e=document.referrer;let t;if(e)try{t=new URL(e).hostname}catch(e){(0,s.v)({eventName:"ReferrerParsingError",errorType:"Telemetry_Error",debugInfo:null==e?void 0:e.toString()})}return t}();return e?e.endsWith(".bing.com")||"bing.com"===e?a.k.Bing:e.startsWith("www.google.")||e.startsWith("com.google.")||e.startsWith("cse.google.")?a.k.Google:e.endsWith(".yahoo.com")||"yahoo.com"===e?a.k.Yahoo:e.endsWith(".baidu.com")||"baidu.com"===e?a.k.Baidu:e.endsWith(".duckduckgo.com")||"duckduckgo.com"===e?a.k.DuckDuckGo:e.endsWith(".yandex.com")||e.endsWith(".yandex.ru")||"yandex.com"===e||"yandex.ru"===e?a.k.Yandex:e.endsWith(".ecosia.org")||"ecosia.org"===e?a.k.Ecosia:e.endsWith(".startpage.com")||"startpage.com"===e?a.k.StartPage:e.endsWith(".qwant.com")||"qwant.com"===e?a.k.Qwant:e.endsWith(".sogou.com")||"sogou.com"===e?a.k.Sogou:e.endsWith(".seznam.cz")||"seznam.cz"===e?a.k.Seznam:e.endsWith(".naver.com")||"naver.com"===e?a.k.Naver:"www.microsoft.com"===e?o.O.Marketing:e.endsWith(".msn.com")?o.O.Msn:i.rK.includes(e)?o.O.Direct:"login.microsoftonline.com"===e||"login.live.com"===e?o.O.Login:((0,l.t)({featureName:"UncategorizedRequestOrigin",message:e}),o.O.Other):o.O.Direct}},65613:(e,t,n)=>{function r(e){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)}n.d(t,{W:()=>r})},31317:(e,t,n)=>{n.d(t,{W:()=>o,x:()=>a});var r=n(74679);const o=e=>{null!=e&&e instanceof Function&&n.e(8193).then(n.bind(n,8193)).then((t=>{let{onCLS:n,onINP:r,onFCP:o,onLCP:a,onTTFB:i}=t;n(e),r(e),o(e),a(e),i(e)}))},a=e=>{e&&(0,r.N)({value:e.value,eventName:`WebVitals.${e.name}`},!0)}},27935:(e,t,n)=>{function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"scrubbed_email",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"scrubbed_url",r=e.toString().replace(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/gi,t);return r=r.replace(/\b(https?|ftp):\/\/[^\s/$.?#].[^\s]*\b/gi,n),r}n.d(t,{y:()=>r}),n(39583)},95266:(e,t,n)=>{n.d(t,{cN:()=>T,GY:()=>A,lA:()=>N});var r=function(e){return e.LandingSignin="MARKETING.LANDING.SIGNIN",e.LandingSignup="MARKETING.LANDING.SIGNUP",e.LandingStart="MARKETING.LANDING.START",e.LandingDirect="MARKETING.LANDING.DIRECT",e.WordSignin="MARKETING.WORD.SIGNIN",e.WordSigninControl="MARKETING.WORD.SIGNIN-C",e.WordSigninTreatment="MARKETING.WORD.SIGNIN-T",e.WordSignup="MARKETING.WORD.SIGNUP",e.WordSignupControl="MARKETING.WORD.SIGNUP-C",e.WordSignupTreatment="MARKETING.WORD.SIGNUP-T",e.WordUnauth="MARKETING.WORD.UNAUTH",e.WordOpen="MARKETING.WORD.OPEN",e.ExcelSignin="MARKETING.EXCEL.SIGNIN",e.ExcelSigninControl="MARKETING.EXCEL.SIGNIN-C",e.ExcelSigninTreatment="MARKETING.EXCEL.SIGNIN-T",e.ExcelSignup="MARKETING.EXCEL.SIGNUP",e.ExcelSignupControl="MARKETING.EXCEL.SIGNUP-C",e.ExcelSignupTreatment="MARKETING.EXCEL.SIGNUP-T",e.ExcelUnauth="MARKETING.EXCEL.UNAUTH",e.ExcelOpen="MARKETING.EXCEL.OPEN",e.PowerPointSignin="MARKETING.POWERPOINT.SIGNIN",e.PowerPointSigninControl="MARKETING.POWERPOINT.SIGNIN-C",e.PowerPointSigninTreatment="MARKETING.POWERPOINT.SIGNIN-T",e.PowerPointSignup="MARKETING.POWERPOINT.SIGNUP",e.PowerPointSignupControl="MARKETING.POWERPOINT.SIGNUP-C",e.PowerPointSignupTreatment="MARKETING.POWERPOINT.SIGNUP-T",e.PowerPointUnauth="MARKETING.POWERPOINT.UNAUTH",e.PowerPointOpen="MARKETING.POWERPOINT.OPEN",e.FreeGoToWord="MARKETING.FREE.GO-TO-WORD",e.FreeGoToExcel="MARKETING.FREE.GO-TO-EXCEL",e.FreeGoToPowerPoint="MARKETING.FREE.GO-TO-POWERPOINT",e.FreeToBeFreeWord="MARKETING.FREE-WXP.FREE-WORD-CAMPAIGN",e.FreeToBeFreeExcel="MARKETING.FREE-WXP.FREE-EXCEL-CAMPAIGN",e.FreeToBeFreePowerPoint="MARKETING.FREE-WXP.FREE-POWERPOINT-CAMPAIGN",e.TryCopilotWord="MARKETING.WORD.TRYCOPILOT",e.TryCopilotExcel="MARKETING.EXCEL.TRYCOPILOT",e.TryCopilotPowerPoint="MARKETING.POWERPOINT.TRYCOPILOT",e.TryCopilotCopilot="MARKETING.COPILOT.TRYCOPILOT",e.InfluencerDemo="MARKETING.INFLUENCERDEMO",e.CopilotContentHub="MARKETING.COPILOTCONTENTHUB",e.Test="MARKETING.TEST.TEST",e}({}),o=function(e){return e.WordHomeButton="WAC.WORD.HOME-BUTTON",e.WordEndOfWorkFlow="WAC.WORD.END-OF-WORKFLOW",e.ExcelHomeButton="WAC.EXCEL.HOME-BUTTON",e.ExcelEndOfWorkFlow="WAC.EXCEL.END-OF-WORKFLOW",e.PowerPointHomeButton="WAC.POWERPOINT.HOME-BUTTON",e.PowerPointEndOfWorkFlow="WAC.POWERPOINT.END-OF-WORKFLOW",e}({}),a=n(65337),i=n(44303),s=function(e){return e.WordNew="NEW.APPHOME.WORD",e.ExcelNew="NEW.APPHOME.EXCEL",e.PowerpointNew="NEW.APPHOME.POWERPOINT",e}({}),l=function(e){return e.HarmonyWeb="HarmonyWeb",e.HarmonyDesktop="HarmonyDesktop",e.HarmonyEmbed="HarmonyEmbed",e.WAC="WAC",e}({}),c=function(e){return e.WordRFM="DESKTOP.WORD.RFM",e.ExcelRFM="DESKTOP.EXCEL.RFM",e.PowerPointRFM="DESKTOP.POWERPOINT.RFM",e}({}),u=n(12661);const d=new Set(Object.values(r)),g=new Set(Object.values(o)),h=new Set(Object.values(a.O)),m=new Set(Object.values(i.k)),f=new Set(Object.values(s)),p=new Set(Object.values(l)),E=new Set(Object.values(c)),v=new RegExp("^OFFICECOM-(WEB|PWA|HWA|NTP)\\.(START|CONTENT|TEMPLATES|SEARCH|HOME|APPBAR|APPGALLERY|REDIRECT)(?:\\.(REC|RecommendedVideo\\.View|SEARCH|NEW|NEW-INSTANT|TEMPLATES|TEMPLATES-INSTANT|UPLOAD|EDGEWORTH|EDGEWORTH-FAVORITES|RecentVideo\\.View|MYCONTENT|OTHER))?$"),S=new RegExp("^COMMUNITY\\.(WORD|EXCEL|POWERPOINT)\\.(1PBLOG|3PFORUM|1PCREATOR|3PCREATOR|1PSOCIAL|COLLEGIATE|1PEVENT|3PEVENT|PARTNERS|MVP|MISC|EMAIL|WORDCAMPAIGN|COPILOTCAMPAIGN)$"),w=new RegExp("^(SEO-PLATFORM\\.(LANDING|BLOG)-(RESUMES|COVER-LETTER)\\.(USETEMPLATE|UPLOAD|TEMPLATES)|SEO-INTENT-RESUMES\\.LANDING-RESUMES\\.USETEMPLATE)$"),T=new RegExp("^(SEO-INTENT\\.(SEARCHENGINE|DIRECT|INTERNAL|SOCIALMEDIA|YOUTUBE|OTHER)-(BLOG|LANDING|BLOGINDEX|BLOGCATEGORYINDEX|AUTHOR)-(NOINTENT|INTENT([1-9][0-9]{0,3}|10000))\\.(USETEMPLATE|UPLOAD|SEARCHTEMPLATES|REFER|CREATE))$"),y=new RegExp("^MARKETING\\.OUTREACHEMAIL\\.[0-9a-zA-Z-_~]{1,40}$"),C=new RegExp("^[0-9A-Z-_~]{1,40}\\.SHELL$");function A(e){if(!e)return!1;if(e.length>518)return(0,u.v)({eventName:"InvalidWdOrigin",errorType:"URF_Error",message:`This wdOrigin exceeds the maximum length ${e}`}),!1;const t=(e=e.toUpperCase()).split(",").every((e=>function(e){return d.has(e)||g.has(e)||h.has(e)||m.has(e)||f.has(e)||E.has(e)||v.test(e)||S.test(e)||w.test(e)||T.test(e)||y.test(e)||C.test(e)}(e)));return t||(0,u.v)({eventName:"InvalidWdOrigin",errorType:"URF_Error",message:`This wdOrigin is invalid ${e}`}),t}function N(e){return!!e&&p.has(e)}},12661:(e,t,n)=>{n.d(t,{v:()=>c});var r=n(62516),o=n(37043),a=n(80366),i=n(6610),s=n(48856),l=n(27935);function c(e){(0,o.$s)(a.h.Error,function(e){const t={};return t[i.ms]=a.h.Error,t[i.QX]=e.pageName||(0,r.R)(),t[(0,s.b)([i.eo,i.b8])]=e.eventName,t[(0,s.b)([i.eo,i.Sd])]=e.errorType,t[(0,s.b)([i.eo,i.bo])]=e.errorCode?(0,l.y)(e.errorCode):"",t[(0,s.b)([i.eo,i.w5])]=e.message?(0,l.y)(e.message):"",t[(0,s.b)([i.eo,i.lg])]=e.debugInfo?(0,l.y)(e.debugInfo):"",t[(0,s.b)([i.eo,i.LF])]=e.area??"",t[(0,s.b)([i.eo,i.zK])]=e.subArea??"",t[(0,s.b)([i.eo,i.tU])]=e.correlationId??"",t[(0,s.b)([i.eo,i.c3])]=e.apiName??"",t[(0,s.b)([i.eo,i.A2])]=e.requestId??"",t}(e))}},13029:(e,t,n)=>{n.d(t,{t:()=>c});var r=n(62516),o=n(37043),a=n(80366),i=n(6610),s=n(48856),l=n(27935);function c(e,t){(0,o.$s)((0,s.c)(a.h.Feature,e.featureName),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};return n[i.ms]=a.h.Feature,n[i.QX]=e.pageName||(0,r.R)(),n[(0,s.b)([i.Mn,i.TZ])]=e.featureName||"General",n[(0,s.b)([i.Mn,i.Zk])]=e.message?(0,l.y)(e.message):"",Object.entries(t).forEach((e=>{let[t,r]=e;n[(0,s.b)([i.Mn,t])]=r})),n}(e,t))}},74679:(e,t,n)=>{n.d(t,{N:()=>l});var r=n(62516),o=n(37043),a=n(80366),i=n(6610),s=n(48856);function l(e,t){if((0,o.$s)(a.h.Performance,function(e){const t={};return t[i.ms]=a.h.Performance,t[i.QX]=e.pageName||(0,r.R)(),t[(0,s.b)([i.Sq,i.b8])]=e.eventName,t[(0,s.b)([i.Sq,i.ft])]=(null==e?void 0:e.duration)?Math.round(e.duration):0,t[(0,s.b)([i.Sq,i.Qg])]=e.value?Math.round(1e4*e.value)/1e4:0,t[(0,s.b)([i.Sq,i.LF])]=e.area??"",t[(0,s.b)([i.Sq,i.zK])]=e.subArea??"",t[(0,s.b)([i.Sq,i.QA])]=e.resourceTimingsData??"",t[(0,s.b)([i.Sq,i.cH])]=e.summarizedResourceTimingsData??"",t}(e)),t){const t=void 0!==(null==e?void 0:e.duration)?Math.round(e.duration):void 0!==(null==e?void 0:e.value)?Math.round(1e4*e.value)/1e4:void 0;void 0!==t&&((function(){const e=window;return e._pageTimings||(e._pageTimings={}),e._pageTimings}())[e.eventName]=t)}}},26406:(e,t,n)=>{n.d(t,{a:()=>c});var r=n(62516),o=n(37043),a=n(80366),i=n(6610),s=n(48856),l=n(27935);function c(e){(0,o.$s)(a.h.Request,function(e){const t={};return t[i.ms]=a.h.Request,t[i.QX]=e.pageName||(0,r.R)(),t[(0,s.b)([i.bQ,i.b8])]=e.eventName,t[(0,s.b)([i.bQ,i.xt])]=e.httpCode,t[(0,s.b)([i.bQ,i.ff])]=e.error?(0,l.y)(e.error):"",t[(0,s.b)([i.bQ,i.TT])]=(null==e?void 0:e.latency)?Math.round(e.latency):0,t[(0,s.b)([i.bQ,i.LF])]=e.area??"",t[(0,s.b)([i.bQ,i.zK])]=e.subArea??"",t[(0,s.b)([i.bQ,i.tU])]=e.correlationId??"",t[(0,s.b)([i.bQ,i.A2])]=e.requestId??"",t[(0,s.b)([i.bQ,i.TG])]=e.retryAttempt??-1,t}(e))}},28630:(e,t,n)=>{n.d(t,{Km:()=>l});var r=n(62516),o=n(37043),a=n(80366),i=n(6610),s=n(48856);function l(e,t){const n=c(e.result);(0,o.$s)((0,s.c)(n,e.eventName,e.area),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};return n[i.ms]=c(e.result),n[i.QX]=e.pageName||(0,r.R)(),n[(0,s.b)([i.Eo,i.OG])]=e.type??"Click",n[(0,s.b)([i.Eo,i.b8])]=e.eventName,n[(0,s.b)([i.Eo,i.LF])]=e.area,n[(0,s.b)([i.Eo,i.zK])]=e.subArea??"Other",n[(0,s.b)([i.Eo,i.tK])]=e.result,n[(0,s.b)([i.Eo,i.r$])]=e.target,n[(0,s.b)([i.Eo,i.bI])]=e.targetId??"",Object.entries(t).forEach((e=>{let[t,r]=e;n[(0,s.b)([i.Eo,t])]=r})),n}(e,t))}function c(e){return"Refer"===e?a.h.Refer:a.h.Action}},62516:(e,t,n)=>{n.d(t,{R:()=>a});var r=n(67274);const o=[{path:"/:locale?/",name:"Main"},{path:"/:locale?/search/:searchQuery",name:"SearchResult"},{path:"/:locale?/open/*",name:"Open"},{path:"/:locale?/signIn",name:"SignIn"},{path:"/:locale?/signUp",name:"SignUp"},{path:"/:locale?/signOut",name:"SignOut"},{path:"/:locale?/upload/:uploadType",name:"Upload"}],a=()=>{var e,t,n,a;const i=null===(t=window)||void 0===t||null===(e=t.location)||void 0===e?void 0:e.pathname;if(!i)return"Unknown";const s=(0,r.ue)(o,{pathname:i});return(null==s||null===(a=s[0])||void 0===a||null===(n=a.route)||void 0===n?void 0:n.name)??"Unknown"}},45714:(e,t,n)=>{n.d(t,{Io:()=>A,M:()=>m,Q4:()=>w,kr:()=>h,$Y:()=>g,i9:()=>E,HQ:()=>y,zH:()=>C,Jg:()=>S,fj:()=>l,T1:()=>v,oM:()=>c,WH:()=>p,nQ:()=>u,ll:()=>d,or:()=>f,mZ:()=>s}),n(80111),n(83734),n(32909),n(57184),n(48419),n(72803),n(39552);var r=n(41246),o=n(34544);let a=null,i=null;const s=()=>{i=null;const e=window.location.hash.substring(1);e&&(i=e);const t=(e=>{if(!e)return null;let t=e.split("&").find((e=>e.startsWith("state=")));if(!t)return null;t=decodeURIComponent(t);const n=t.indexOf("|");if(-1===n)return null;const o=(e=>{const t=e.split("|"),n=t.findIndex((e=>e.startsWith(r.cH)));return-1===n?e:(t.splice(n,1),t.join("|"))})(t.substring(n+1));return new URLSearchParams(o)})(e);a=new URLSearchParams;const n=new URLSearchParams(window.location.search),s={};for(const e of Object.values(o.z))s[e.toLowerCase()]=e;const l=e=>{if(a)for(const[t,n]of e.entries()){const e=s[t.toLowerCase()];e&&(delete s[t.toLowerCase()],a.set(e,n))}};if(l(n),t&&l(t),window.history.replaceState){let e=`${window.location.protocol}//${window.location.host}${window.location.pathname}`;const t=a.toString();t&&(e+=`?${t}`),i&&i.length>0&&(e+=`#${i}`),e=function(e){const t=e.pathname.split("."),n=t.length>1?t.pop():"",r=n&&["html","xml","txt","png","jpg","jpeg","gif","svg","webp","sass","scss","css","js","jsx","json","ts","tsx"].includes(n);return e.pathname.endsWith("/")||r||(e.pathname+="/"),e}(new URL(e)).toString(),window.history.replaceState({path:e},"",e)}},l=()=>(null==a?void 0:a.get(o.z.Theme))??null,c=()=>(null==a?void 0:a.get(o.z.WdOrigin))??void 0,u=()=>(null==a?void 0:a.get(o.z.WdPreviousSession))??void 0,d=()=>(null==a?void 0:a.get(o.z.WdPreviousSessionSrc))??void 0,g=()=>(null==a?void 0:a.get(o.z.From))??void 0,h=()=>(null==a?void 0:a.get(o.z.Flighting))??"",m=()=>(null==a?void 0:a.get(o.z.Access))??"",f=()=>(null==a?void 0:a.get(o.z.Wdpa))??"",p=()=>(null==a?void 0:a.get(o.z.WdOverrides))??"",E=()=>(null==a?void 0:a.get(o.z.LoginHint))??"",v=()=>(null==a?void 0:a.get(o.z.UseFileBrowserCustomConfig))??null,S=()=>"true"===(null==a?void 0:a.get(o.z.UseResCdnForTemplateImages)),w=()=>"true"===(null==a?void 0:a.get(o.z.DisableSplashscreen)),T=[o.z.WdOrigin,o.z.From,o.z.Access],y=()=>{if(!a)return null;const e=new URLSearchParams;return T.forEach((t=>{const n=null==a?void 0:a.get(t);n&&e.set(t,n)})),e.toString()},C=()=>{let e=y()??"";return e&&"?"!==e.charAt(0)&&(e=`?${e}`),e},A=(e,t,n)=>{const r=new URL(e),o=new URLSearchParams(r.search);if(o.has("wdOrigin")){var a;if(null===(a=o.get("wdOrigin"))||void 0===a?void 0:a.includes(t.toString()))return e;o.set("wdOrigin",`${o.get("wdOrigin")},${t}`)}else if(n){if(null==n?void 0:n.includes(t.toString()))return e;o.set("wdOrigin",`${n},${t}`)}else o.append("wdOrigin",t);return r.search=o.toString(),r.toString()}},34544:(e,t,n)=>{n.d(t,{z:()=>r});var r=function(e){return e.Theme="theme",e.WdOrigin="wdOrigin",e.WdPreviousSession="wdPreviousSession",e.WdPreviousSessionSrc="wdPreviousSessionSrc",e.From="from",e.DriveId="driveId",e.DocId="docId",e.Flighting="flighting",e.WdOverrides="wdoverrides",e.WdTf="wdtf",e.WdTpl="wdTpl",e.WdLcid="wdlcid",e.Wdpa="wdpa",e.WdJs="wdjs",e.WdUi="wdui",e.WdRs="wdrs",e.Ct="ct",e.Access="access",e.LoginHint="login_hint",e.UseFileBrowserCustomConfig="useFileBrowserCustomConfig",e.UnauthEditApplication="app",e.DisableSplashscreen="disableSplashscreen",e.UseResCdnForTemplateImages="useResCdnForTemplateImages",e.HandoffGPTTransfer="transfer",e}({})},65337:(e,t,n)=>{n.d(t,{O:()=>r});var r=function(e){return e.NewFile="APPHOME-WEB.BANNER.NEWBLANK",e.NewFileTreatment="APPHOME-WEB.BANNER.NEWBLANK-T",e.NewFileControl="APPHOME-WEB.BANNER.NEWBLANK-C",e.NewFileOCDI="APPHOME-WEB.BANNER.NEWBLANK-OCDI",e.NewFileOCDIControl="APPHOME-WEB.BANNER.NEWBLANK-OCDI-C",e.Upload="APPHOME-WEB.BANNER.UPLOAD",e.UploadOCDI="APPHOME-WEB.BANNER.UPLOAD-OCDI",e.JumpBackIn="APPHOME-WEB.JUMPBACKIN",e.JumpBackInOcdi="APPHOME-WEB.JUMPBACKIN-OCDI",e.Search="APPHOME-WEB.SHELL.SEARCH",e.ShellSignIn="APPHOME-WEB.SHELL.SIGNIN",e.Unauth="APPHOME-WEB.UNAUTH",e.UnauthControl="APPHOME-WEB.UNAUTH-C",e.Templates="APPHOME-WEB.CREATE.TEMPLATE",e.FileBrowser="APPHOME-WEB.FILEBROWSER.RECENT",e.FileBrowserOCDI="APPHOME-WEB.FILEBROWSER.RECENT-OCDI",e.FileBrowserFavorites="APPHOME-WEB.FILEBROWSER.FAVORITES",e.FileBrowserFavoritesOCDI="APPHOME-WEB.FILEBROWSER.FAVORITES-OCDI",e.FileBrowserShared="APPHOME-WEB.FILEBROWSER.SHARED",e.FileBrowserSharedOCDI="APPHOME-WEB.FILEBROWSER.SHARED-OCDI",e.CreateBlank="APPHOME-WEB.CREATE.NEWBLANK",e.CreateTemplateMain="APPHOME-WEB.CREATE.TEMPLATEMAIN",e.CreateTemplateSearch="APPHOME-WEB.CREATE.TEMPLATESEARCH",e.CreateTemplateMainOCDI="APPHOME-WEB.CREATE.TEMPLATEMAIN-OCDI",e.CreateTemplateSearchOCDI="APPHOME-WEB.CREATE.TEMPLATESEARCH-OCDI",e.CreateTemplateTreatment="APPHOME-WEB.CREATE.TEMPLATE-T",e.CreateTemplateControl="APPHOME-WEB.CREATE.TEMPLATE-C",e.OpenFromAddressBar="APPHOME-WEB.ADDRESSBAR",e.CreateTemplateOCDIControl="APPHOME-WEB.CREATE.TEMPLATE-OCDI-C",e.Direct="APPHOME-WEB.DIRECT",e.Login="APPHOME-WEB.LOGIN",e.Logout="APPHOME-WEB.LOGOUT",e.Msn="APPHOME-WEB.MSN",e.Marketing="APPHOME-WEB.MARKETING",e.Other="APPHOME-WEB.OTHER",e}({})},44303:(e,t,n)=>{n.d(t,{k:()=>r});var r=function(e){return e.Google="SEARCHENGINE.GOOGLE",e.Bing="SEARCHENGINE.BING",e.Yahoo="SEARCHENGINE.YAHOO",e.Baidu="SEARCHENGINE.BAIDU",e.DuckDuckGo="SEARCHENGINE.DUCKDUCKGO",e.Yandex="SEARCHENGINE.YANDEX",e.Ecosia="SEARCHENGINE.ECOSIA",e.StartPage="SEARCHENGINE.STARTPAGE",e.Qwant="SEARCHENGINE.QWANT",e.Sogou="SEARCHENGINE.SOGOU",e.Seznam="SEARCHENGINE.SEZNAM",e.Naver="SEARCHENGINE.NAVER",e}({})},79160:(e,t,n)=>{n.d(t,{FN:()=>i,JP:()=>o,ew:()=>a});var r=n(22268);const o=e=>{const t=window.ecsflights;return!!(null==t?void 0:t.AppHome)&&Object.keys(t.AppHome).length>0&&null==e},a=(e,t)=>{var n;const o=window.ecsflights;return void 0!==(null==o||null===(n=o.AppHome)||void 0===n?void 0:n[e])&&t!==r.k.LoggedIn},i=e=>{var t;const n=window.ecsflights;return null==n||null===(t=n.AppHome)||void 0===t?void 0:t[e]}},12091:(e,t,n)=>{n.d(t,{$:()=>a,O:()=>o});var r=n(35609);const o=(0,r.eU)(!1),a=(0,r.eU)(0)},61319:(e,t,n)=>{n.d(t,{D:()=>v,Y:()=>S});var r=n(33894),o=n(13029),a=n(40369),i=n(71124);const s={documentClickOpensInNewTab:!1,isDarkModeEnabled:!1,isDebounceCreateNewEnabled:!1,isPreviewTemplateHiddenEnable:!1,isUnauthEditControl:!1,isUnauthEditEnabled:!1,isLightweightHeaderEnabled:!1,promptListBoxIsHandoffDogfood:"undefined",showCopilotPPTHandoffButton:!1,showCreateWithCopilot:!1,showPromptBoxChatPane:!1,showPromptBoxExcel:!1,showPromptBoxTopOfDoc:!1,showSEOBelowFoldContent:!1,uhpHeaderNavigationMenuEnabled:!1,uhpHeaderShowUpsellButton:!1,uhpFeatureClipchampDataNavigationEnabled:!1,uhpFeatureNavigationEnabled:!1,useAccountSwitching:!1,isUnauthCreateProxyServiceEnabled:!1,isAuthCreateProxyServiceEnabled:!1,odspFileBrowserOverflowShowAboveMRU:!1,promptListBoxCompactBanner:!1,promptListBoxCraft:!1,promptListBoxAllowTopOfDoc:!1,brsCommandButtonsEnableCtrlClick:!1,brsCopilotLicenseCheck:!1,brsCreateClientCacheTimeInHours:1,brsCreateEnableCtrlClick:!1,brsCreateEndPointSetToDF:!1,brsEditPageConfirmationPromptEnabled:!1,brsEditPageEnabled:!1,brsEditPageOpenInNewTabDialogEnabled:!0,brsEditPageOpenInNewTabEnabled:!0,brsEnableAnimatedTile:!1,brsEnableBannerWdOriginCheck:!1,brsEnableODSPLoginHint:!1,brsEnablePreviewInfoAuthBanner:!1,brsEnableVroomToOneDrive:!1,brsEnterpriseCollection:!1,brsFileBrowserAllowSubstrateTokens:!0,brsFileBrowserAuthCleanResourceUrl:!0,brsFileBrowserCookieAuthEnabled:!0,brsFileBrowserCookieAuthInitTimeoutMs:2e4,brsFileBrowserEnableCtrlClick:!1,brsFileBrowserEnableFavoritesPivot:!1,brsFileBrowserEnableSharedPivot:!1,brsFileBrowserShowCommercialShimmer:!0,brsFileBrowserShowConsumerShimmer:!0,brsFileBrowserThrowOnTokenAuthAuthenticateError:!1,brsFileBrowserThrowOnTokenAuthPageLoadedError:!0,brsFileBrowserTokenAuthInitTimeoutMs:2e4,brsHandoffGPTPageEnabled:!1,brsHandoffMarketingCopilotCheckEnabled:!1,brsHandoffMarketingPageEnabled:!1,brsJumpBackInEnableCtrlClick:!0,brsJumpBackInEnabled:!0,brsLogInvalidURLPathEnabled:!1,brsOCVEnabledForCommercial:!1,brsOCVEnabledForConsumer:!1,brsOCVEnabledForUnauth:!1,brsOneNoteEnableAHPForMicrosoftUsers:!1,brsOneNoteEnableInAppsDropDown:!1,brsOneNoteRedirectAllAADUsersToOfficeOneNote:!0,brsOneNoteEnableCPNBMessageBar:!1,brsOneNoteAHPV2Experience:!1,brsOpenDocumentsInSameTab:!0,brsOpenPageEnableCtrlClick:!0,brsOpenPageEnabled:!0,brsOpenPageEnableFileEmbed:!0,brsPassShareDialogAccessTokenPostParamForMsa:!0,brsPromptListBoxCiq:!1,brsPromptListBoxPPS:!1,brsPromptListBoxSCC:!1,brsRedirectPageEnabled:!0,brsShowCopilotPage:!1,brsShowMorePPTTemplatesLink:!1,brsSignoutPageEnabled:!0,brsSxSChatPageEnabled:!1,brsUseCreateProxyServiceForUnauth:!1,brsUseCreateProxyServiceForAuth:!1,brsUseCreateProxyServiceForSearch:!1,brsHidePreviewTemplateForMasonry:!1,brsUseEditNewForCreateBlankFile:!0,brsUseMasonry:!0,brsUseTemplateCarousel:!0,brsDisableGccCheck:!1,brsPPSWorkflowRequestTimeoutms:500,testBoolean:!1,testString:"",testNumber:0};var l=n(46462),c=n(92321),u=n(74661),d=n(27435);const g={diagnosticLevel:l.o.DiagnosticLevel.RequiredServiceData},h=async(e,t)=>{var n;null===(n=e.flightingTelemetryLogger)||void 0===n||n.sendTelemetryEvent({eventName:e.loggerTenantName+".Flighting.FeatureQuery",eventFlags:g,dataFields:[(0,c.m9)("FeatureName",t.featureGateName),(0,c.m9)("TreatmentValue",t.featureGateValue),(0,c.m9)("TreatmentSource",t.featureGateSource),(0,c.m9)("TreatmentStatus",t.featureGateStatus)]})},m=(e,t)=>"boolean"==typeof t||"number"==typeof t||"string"==typeof t?((e,t)=>((e,t)=>{const n=u.E.getInstance(),r=n.getValue(e),o=typeof t,a=typeof r.featureGateValue===o?r.featureGateValue:t,i=r.featureGateSource;if(void 0!==r.featureGateValue&&typeof r.featureGateValue!==o){if(n.enableSendFeatureQueryMetadata&&!(r.featureGateFlag&d.jj.Evaluated)){const r={featureGateName:e,featureGateValue:t.toString(),featureGateSource:i.toString(),featureGateStatus:"TypeMismatch"};h(n,r)}return n.markFeatureGateEvaluated(e),t}if(void 0===r.featureGateValue){if(n.addFeatureGateToFlightingContext(e,a,i,d.jj.Evaluated),n.enableSendFeatureQueryMetadata&&!(r.featureGateFlag&d.jj.Evaluated)){const t={featureGateName:e,featureGateValue:a.toString(),featureGateSource:i.toString(),featureGateStatus:"Default"};h(n,t)}}else if(n.enableSendFeatureQueryMetadata&&!(r.featureGateFlag&d.jj.Evaluated)){const t={featureGateName:e,featureGateValue:a.toString(),featureGateSource:i.toString(),featureGateStatus:"Success"};h(n,t)}return n.markFeatureGateEvaluated(e),a})(e,t))(e,t):t;var f=n(79160),p=n(12091);function E(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const l=s[e],[c,u]=(0,i.useState)(n?null:l),d=(0,a.md)(p.O),g=(0,a.md)(r.t);return(0,i.useEffect)((()=>{d?(t=m(e,l),u(t),(0,o.t)({featureName:"useFlightValue",message:`${e} with ${l===t?"match":"mismatch"} (defaultValue ${l}, flightValue ${t})`})):(0,f.ew)(e,g)&&(t=(0,f.FN)(e),u(t),(0,o.t)({featureName:"useFlightValue",message:`COSMIC: ${e} with ${l===t?"match":"mismatch"} (defaultValue ${l}, flightValue ${t})`}))}),[e,l,d,g]),c}const v=e=>E(e,!1),S=e=>E(e,!0)},18680:(e,t,n)=>{n.d(t,{i:()=>a,s:()=>o});var r=n(21446);class o{async getAccessToken(){return await a()}}const a=async e=>{const t=await(0,r.i)({scopes:["https://graph.microsoft.com/.default"]},{overrideToOneDriveForMSA:!1},"GraphService",e);return(null==t?void 0:t.accessToken)??""}},22566:(e,t,n)=>{n.d(t,{K:()=>v});var r=n(68078),o=n(18680),a=(n(39552),n(61960),n(21446)),i=n(26406),s=n(13029),l=(n(4589),n(41932));const c=(e,t,n,r)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(n,r);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[n]:r});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(n,r);else if(t.headers instanceof Array){let e=0;const o=t.headers.length;for(;e<o;e++){const o=t.headers[e];if(o[0]===n){o[1]=r;break}}e===o&&t.headers.push([n,r])}else Object.assign(t.headers,{[n]:r})},u=(e,t,n)=>{let r=null;if("undefined"!=typeof Request&&e instanceof Request)r=e.headers.get(n);else if(null==t?void 0:t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)r=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,o=e.length;t<o;t++)if(e[t][0]===n){r=e[t][1];break}}else void 0!==t.headers[n]&&(r=t.headers[n]);return r},d=e=>{var t;let n="",r=0,o=0,a="",i="",s="";var c;if((null==e||null===(t=e.options)||void 0===t?void 0:t.headers)&&(null==e||null===(c=e.options)||void 0===c?void 0:c.headers)){const t=u(null==e?void 0:e.request,e.options,l.X.StartTime);t&&(r=parseInt(t)),a=u(null==e?void 0:e.request,e.options,l.X.CorrelationId);const c=u(null==e?void 0:e.request,e.options,l.X.RetryAttempt);c&&(o=parseInt(c)),n=u(null==e?void 0:e.request,e.options,l.X.APIName),i=u(null==e?void 0:e.request,e.options,l.X.Area),s=u(null==e?void 0:e.request,e.options,l.X.SubArea)}return{startTime:r,correlationId:a,apiName:n,area:i,subArea:s,retryAttempt:o}};class g{errorLogHandler(e,t){var n;const r=d(e);(0,i.a)({eventName:r.apiName+"Retry",httpCode:null==t?void 0:t.status,retryAttempt:r.retryAttempt,latency:performance.now()-r.startTime,area:r.area,subArea:r.subArea,correlationId:`${r.correlationId}-${r.retryAttempt}`,requestId:(null==t||null===(n=t.headers)||void 0===n?void 0:n.get("Request-Id"))??""})}async execute(e){let t=await fetch(e.request,e.options);if(!t.ok){var n;this.errorLogHandler(e,t);const r=(null===(n=t.headers)||void 0===n?void 0:n.get("WWW-Authenticate"))??"";if(401===t.status&&r&&r.includes("claims")){const n=(0,a.O)(r);if("insufficient_claims"===(null==n?void 0:n.error)&&(null==n?void 0:n.claims)){(0,s.t)({featureName:"GraphService",message:"Claims challenge detected and retrying with claims token"});const r=window.atob(n.claims),a=await(0,o.i)(r);a&&((0,s.t)({featureName:"GraphService",message:"Successfully fetched token with claims"}),c(e.request,e.options,"Authorization",`Bearer ${a}`),t=await fetch(e.request,e.options))}return void(e.response=t)}}e.response=t}setNext(e){this.nextMiddleware=e}}class h{async execute(e){var t,n,r,o,a;const s=performance.now();var c,u,g,h;c=null==e?void 0:e.request,u=null==e?void 0:e.options,g=l.X.StartTime,h=s.toString(),"undefined"!=typeof Request&&c instanceof Request?c.headers.append(g,h):void 0!==u&&(void 0===u.headers?u.headers=new Headers({[g]:h}):"undefined"!=typeof Headers&&u.headers instanceof Headers?u.headers.append(g,h):u.headers instanceof Array?u.headers.push([g,h]):void 0===u.headers?u.headers={[g]:h}:void 0===u.headers[g]?u.headers[g]=h:u.headers[g]+=`, ${h}`),await(null===(t=this.nextMiddleware)||void 0===t?void 0:t.execute(e));const m=d(e);let f="";const p=null==e||null===(n=e.response)||void 0===n?void 0:n.status;if(p<200||p>=300){var E,v;let t;try{var S;const n=null==e||null===(S=e.response)||void 0===S?void 0:S.clone();t=await(null==n?void 0:n.json())}catch(e){t={}}f=`${(null==t||null===(E=t.error)||void 0===E?void 0:E.code)??""}-${(null==t||null===(v=t.error)||void 0===v?void 0:v.message)??""}`}(0,i.a)({eventName:m.apiName,httpCode:null==e||null===(r=e.response)||void 0===r?void 0:r.status,latency:performance.now()-m.startTime,area:m.area,subArea:m.subArea,correlationId:`${m.correlationId}-${m.retryAttempt}`,requestId:null==e||null===(a=e.response)||void 0===a||null===(o=a.headers)||void 0===o?void 0:o.get("Request-Id"),error:f})}setNext(e){this.nextMiddleware=e}}var m=n(55082),f=n(38305);class p{isRetry(e){return-1!==l.J.indexOf(e.status)}getOptions(){return void 0===this.options?new r.Rz:this.options}getDelay(e,t,n){const r=void 0!==e.headers?e.headers.get(p.RETRY_AFTER_HEADER):null;let o;return o=null!==r?Number.isNaN(Number(r))?Math.round((new Date(r).getTime()-Date.now())/1e3):Number(r):(0,m.J)(t,n),Math.min(o,this.options.getMaxDelay())+(0,f.p)()}async sleep(e){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}async executeWithRetry(e,t,n){var r;if(e&&e.request&&e.options&&(await(null===(r=this.nextMiddleware)||void 0===r?void 0:r.execute(e)),t<n.maxRetries&&this.isRetry(e.response)&&n.shouldRetry(n.delay,t,e.request,e.options,e.response))){++t,c(e.request,e.options,p.RETRY_ATTEMPT_HEADER,t.toString());const r=this.getDelay(e.response,t,n.delay);return await this.sleep(r),await this.executeWithRetry(e,t,n)}}async execute(e){const t=this.getOptions();return await this.executeWithRetry(e,0,t)}setNext(e){this.nextMiddleware=e}constructor(e=new r.Rz){this.options=e}}let E;function v(){if(!E){const e=new r.zA(new o.s),t=new h,n=new p(new r.Rz(1,2)),a=new g,i=e;e.setNext(t),t.setNext(n),n.setNext(a),E=r.Kj.initWithMiddleware({middleware:i})}return E}p.RETRY_ATTEMPT_HEADER=l.X.RetryAttempt,p.RETRY_AFTER_HEADER=l.X.RetryAfter},58700:(e,t,n)=>{n.d(t,{R:()=>s});var r=n(74679),o=n(12661),a=n(17705),i=n(92861);const s=new class{addRequiredArea(e){this.requiredAreas.has(e)||this.requiredAreas.set(e,!1)}markAsReady(e){this.requiredAreas.set(e,!0),this.allReady=this.checkIfAllReady(),this.allReady&&((0,i.W)(),clearTimeout(this.timeoutId),(0,r.N)({duration:performance.now()-this.startTime,eventName:"Splashscreen.AllReady",area:"Splashscreen"}))}checkIfAllReady(){let e=!0;return this.requiredAreas.forEach((t=>{t||(e=!1)})),e}constructor(){this.allReady=!1,this.requiredAreas=new Map,this.requiredAreas.set(a.S.Flights,!1),this.requiredAreas.set(a.S.Main,!1),this.requiredAreas.set(a.S.Localization,!1),this.startTime=performance.now(),this.timeoutId=setTimeout((()=>{(0,o.v)({eventName:"SplashscreenTimeout",errorType:"Splashscreen_Error",message:"Splashscreen still not ready after 30s",area:"Splashscreen"})}),3e4)}}},17705:(e,t,n)=>{n.d(t,{S:()=>r});var r=function(e){return e[e.Main=0]="Main",e[e.Flights=1]="Flights",e[e.CreateServiceFrame=2]="CreateServiceFrame",e[e.JumpBackInApi=3]="JumpBackInApi",e[e.Localization=4]="Localization",e[e.CopilotDirectCompose=5]="CopilotDirectCompose",e[e.OneNoteTrafficController=6]="OneNoteTrafficController",e}({})},92861:(e,t,n)=>{function r(){const e=document.getElementById("splashscreen");e&&(e.style.display="none",e.style.opacity="0",document.body.style.overflow="auto")}n.d(t,{W:()=>r})}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/app-home_v1_47761_4851e8d8fd564e55d571.bundle.js.map/92c2860d94b28ce1d83ea25d528e5ca1/app-home_v1_47761_4851e8d8fd564e55d571.bundle.js.map